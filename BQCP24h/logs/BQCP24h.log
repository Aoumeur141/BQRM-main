2025-07-31 10:17:58,990 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-07-31 10:17:58,990 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-07-31 10:17:58,990 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-07-31 10:17:58,991 - INFO - Bulletin:68 - Current Month (MM): 07
2025-07-31 10:17:58,991 - INFO - Bulletin:69 - Current Day (DD): 31
2025-07-31 10:17:58,991 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:17:58,991 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-07-31 10:17:58,991 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-07-31 10:17:58,991 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-07-31 10:17:58,991 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:17:58,991 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-07-31.csv.
2025-07-31 10:17:58,991 - INFO - fetchdata:75 - Starting FTP file fetch process.
2025-07-31 10:17:58,991 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-07-31 10:17:58,995 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-07-31 10:17:58,996 - INFO - fetchdata:84 - Changed remote directory to: /
2025-07-31 10:17:58,997 - INFO - fetchdata:91 - Looking for files matching pattern: 'exported_data_2025-07-31.csv'
2025-07-31 10:17:58,997 - INFO - fetchdata:95 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:18:01,282 - INFO - fetchdata:104 - Found 1 files matching pattern on remote server.
2025-07-31 10:18:01,283 - INFO - fetchdata:117 - Downloading exported_data_2025-07-31.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-07-31.csv
2025-07-31 10:18:01,387 - INFO - fetchdata:120 - Successfully downloaded exported_data_2025-07-31.csv
2025-07-31 10:18:01,389 - INFO - fetchdata:128 - FTP file fetch process completed.
2025-07-31 10:18:01,390 - INFO - Bulletin:115 - FTP download of exported_data_2025-07-31.csv successful.
2025-07-31 10:18:01,390 - INFO - Bulletin:120 - Moved exported_data_2025-07-31.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-07-31 10:18:01,391 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/07/31/Synop_202507310600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-07-31 10:18:01,392 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-07-31 10:18:01,392 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-07-31 10:18:01,393 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-07-31 10:18:01,393 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-07-31 10:18:01,393 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:18:01,835 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:18:01,838 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-07-31.csv
2025-07-31 10:18:01,843 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-07-31 10:18:01,855 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx
2025-07-31 10:18:01,855 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-07-31 10:18:01,920 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:18:01,920 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-07-31 10:18:01,920 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-07-31 10:18:01,920 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:18:02,484 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:18:02,484 - INFO - Synop24h:75 - Constructed file paths:
2025-07-31 10:18:02,484 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:18:02,484 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-07-31 10:18:02,484 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-07-31 10:18:02,484 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:18:02,484 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:18:02,484 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-07-31 10:18:02,484 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table07310600.docx
2025-07-31 10:18:02,484 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-07-31 10:18:02,485 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250731-06.txt
2025-07-31 10:18:02,485 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-07-31 10:18:02,485 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-07-31 10:18:02,485 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-07-31 10:18:02,485 - INFO - Synop24h:113 - Today's date: 2025-07-31
2025-07-31 10:18:02,485 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-07-31 10:18:02,486 - INFO - data_utils:303 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-07-31 10:18:02,660 - INFO - data_utils:312 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr. DataFrame shape: (182, 3)
2025-07-31 10:18:02,660 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-07-31 10:18:02,661 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 91
2025-07-31 10:18:02,663 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (91, 2)
2025-07-31 10:18:02,663 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-07-31 10:18:02,663 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-07-31 10:18:02,685 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-07-31 10:18:02,685 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-07-31 10:18:02,687 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-07-31 10:18:02,695 - WARNING - Synop24h:206 - Row 11: Station 'Timimoun' (TIMIMOUN) not found in BUFR data. Marked as missing.
2025-07-31 10:18:02,695 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-07-31 10:18:02,722 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:18:02,722 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250731-06.txt. Total unique missing stations: 3
2025-07-31 10:18:02,722 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-07-31 10:18:02,743 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-07-31 10:18:02,743 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-07-31 10:18:02,745 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:18:02,753 - WARNING - Synop24h:295 - Row 11: Station 'Timimoun' (TIMIMOUN) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:18:02,753 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:18:02,780 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:18:02,780 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:18:02,801 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx, active sheet: 'Feuille1'
2025-07-31 10:18:02,801 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:18:02,822 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx, active sheet: 'Feuille1'
2025-07-31 10:18:02,823 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-07-31 10:18:02,832 - INFO - Synop24h:347 - Word template loaded successfully.
2025-07-31 10:18:02,832 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-07-31 10:18:02,832 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-07-31 10:18:02,832 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 30 Juillet 2025 à 06h au 31 Juillet 2025 à 06h.'
2025-07-31 10:18:02,833 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 31 Juillet 2025'
2025-07-31 10:18:02,834 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-07-31 10:18:02,834 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-07-31 10:18:02,835 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-07-31 10:18:03,020 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-07-31 10:18:03,034 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-07-31 10:18:03,034 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-07-31 10:18:03,218 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-07-31 10:18:03,232 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-07-31 10:18:03,246 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table07310600.docx
2025-07-31 10:18:03,246 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-07-31 10:18:03,341 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:18:03,341 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-07-31 10:18:03,341 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-07-31 10:18:03,342 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:18:03,904 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:18:03,904 - INFO - SynoClim:74 - Configured file paths:
2025-07-31 10:18:03,905 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:18:03,905 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:18:03,905 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:18:03,905 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-07-31 10:18:03,905 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:18:03,905 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:18:03,905 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-07-31 10:18:03,905 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx
2025-07-31 10:18:03,905 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-07-31 10:18:03,906 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:18:04,078 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (182, 3)
2025-07-31 10:18:04,083 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-07-31 10:18:04,083 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-07-31 10:18:04,084 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (91, 3)
2025-07-31 10:18:04,088 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-07-31 10:18:04,089 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (91, 3)
2025-07-31 10:18:04,090 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:18:04,090 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:18:04,177 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-07-31 10:18:04,177 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-07-31 10:18:04,177 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-07-31 10:18:04,177 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-07-31 10:18:04,178 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx. Attempting to load.
2025-07-31 10:18:04,190 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-07-31 10:18:04,194 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-07-31 10:18:04,195 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,196 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,197 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,207 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,210 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,211 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,213 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,218 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,220 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,222 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,224 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,227 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,227 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,233 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,234 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,245 - INFO - SynoClim:266 -   Station 'TIMIMOUN' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,246 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,247 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,249 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,250 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,251 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,252 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,254 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,258 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,259 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,262 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,263 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,265 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,266 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-07-31 10:18:04,267 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 29
2025-07-31 10:18:04,267 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:18:04,291 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:18:04,291 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:18:04,291 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:18:04,292 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-07-31 10:18:04,304 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-07-31 10:18:04,304 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-07-31 10:18:04,304 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-07-31 10:18:04,304 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 30 Juillet 2025 à 06h au 31 Juillet 2025 à 06h.'
2025-07-31 10:18:04,304 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-07-31 10:18:04,305 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-07-31 10:18:05,717 - INFO - SynoClim:397 - Finished populating Word document table.
2025-07-31 10:18:05,717 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:18:05,729 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:18:05,729 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-07-31 10:18:05,824 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:18:05,825 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-07-31 10:18:05,825 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-07-31 10:18:05,825 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/07.
2025-07-31 10:18:05,825 - INFO - file_operations:98 - Moved '20250731.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/07'.
2025-07-31 10:18:05,826 - INFO - file_operations:98 - Moved 'Synop20250731-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/07'.
2025-07-31 10:18:05,826 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:18:05,826 - INFO - file_operations:284 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h (Pattern: *.xlsx)
2025-07-31 10:18:05,826 - INFO - file_operations:301 - Finished cleanup. Successfully deleted 3 files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:18:05,826 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:18:05,827 - INFO - file_operations:284 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h (Pattern: *.docx)
2025-07-31 10:18:05,827 - INFO - file_operations:301 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:18:05,827 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-07-31 10:18:05,827 - INFO - file_operations:284 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-07-31 10:18:05,828 - INFO - file_operations:301 - Finished cleanup. Successfully deleted 1 files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-07-31 10:18:05,828 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/07 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31.
2025-07-31 10:18:05,828 - INFO - Bulletin:229 - Backup directories created successfully.
2025-07-31 10:18:05,828 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/07/31 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31.
2025-07-31 10:18:05,828 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/07/31' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31'.
2025-07-31 10:18:05,828 - INFO - file_operations:355 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31' exists. Removing it before copying.
2025-07-31 10:18:05,832 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/07/31' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31'.
2025-07-31 10:18:05,832 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-07-31 10:18:05,832 - INFO - Bulletin:251 - Script finished.
2025-07-31 10:19:20,551 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-07-31 10:19:20,551 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-07-31 10:19:20,551 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-07-31 10:19:20,551 - INFO - Bulletin:68 - Current Month (MM): 07
2025-07-31 10:19:20,551 - INFO - Bulletin:69 - Current Day (DD): 31
2025-07-31 10:19:20,551 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:20,551 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-07-31 10:19:20,552 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-07-31 10:19:20,552 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-07-31 10:19:20,552 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:20,552 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-07-31.csv.
2025-07-31 10:19:20,552 - INFO - fetchdata:75 - Starting FTP file fetch process.
2025-07-31 10:19:20,552 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-07-31 10:19:20,555 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-07-31 10:19:20,556 - INFO - fetchdata:84 - Changed remote directory to: /
2025-07-31 10:19:20,556 - INFO - fetchdata:91 - Looking for files matching pattern: 'exported_data_2025-07-31.csv'
2025-07-31 10:19:20,556 - INFO - fetchdata:95 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:20,561 - INFO - fetchdata:104 - Found 1 files matching pattern on remote server.
2025-07-31 10:19:20,561 - INFO - fetchdata:117 - Downloading exported_data_2025-07-31.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-07-31.csv
2025-07-31 10:19:20,564 - INFO - fetchdata:120 - Successfully downloaded exported_data_2025-07-31.csv
2025-07-31 10:19:20,565 - INFO - fetchdata:128 - FTP file fetch process completed.
2025-07-31 10:19:20,565 - INFO - Bulletin:115 - FTP download of exported_data_2025-07-31.csv successful.
2025-07-31 10:19:20,565 - INFO - Bulletin:120 - Moved exported_data_2025-07-31.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-07-31 10:19:20,565 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/07/31/Synop_202507310600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-07-31 10:19:20,566 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-07-31 10:19:20,566 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-07-31 10:19:20,566 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-07-31 10:19:20,566 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-07-31 10:19:20,566 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:19:20,988 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:20,991 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-07-31.csv
2025-07-31 10:19:20,996 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-07-31 10:19:21,007 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx
2025-07-31 10:19:21,008 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-07-31 10:19:21,075 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:19:21,075 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-07-31 10:19:21,075 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-07-31 10:19:21,075 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:19:21,654 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:21,654 - INFO - Synop24h:75 - Constructed file paths:
2025-07-31 10:19:21,654 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:19:21,655 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-07-31 10:19:21,655 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-07-31 10:19:21,655 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:19:21,655 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:19:21,655 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-07-31 10:19:21,655 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table07310600.docx
2025-07-31 10:19:21,655 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-07-31 10:19:21,655 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250731-06.txt
2025-07-31 10:19:21,655 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-07-31 10:19:21,655 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-07-31 10:19:21,655 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-07-31 10:19:21,655 - INFO - Synop24h:113 - Today's date: 2025-07-31
2025-07-31 10:19:21,655 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-07-31 10:19:21,656 - INFO - data_utils:303 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-07-31 10:19:21,829 - INFO - data_utils:312 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr. DataFrame shape: (182, 3)
2025-07-31 10:19:21,829 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-07-31 10:19:21,830 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 91
2025-07-31 10:19:21,832 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (91, 2)
2025-07-31 10:19:21,832 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-07-31 10:19:21,832 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-07-31 10:19:21,853 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-07-31 10:19:21,854 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-07-31 10:19:21,855 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-07-31 10:19:21,863 - WARNING - Synop24h:206 - Row 11: Station 'Timimoun' (TIMIMOUN) not found in BUFR data. Marked as missing.
2025-07-31 10:19:21,864 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-07-31 10:19:21,893 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:19:21,894 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250731-06.txt. Total unique missing stations: 3
2025-07-31 10:19:21,894 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-07-31 10:19:21,916 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-07-31 10:19:21,916 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-07-31 10:19:21,918 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:19:21,926 - WARNING - Synop24h:295 - Row 11: Station 'Timimoun' (TIMIMOUN) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:19:21,927 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-07-31 10:19:21,955 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:19:21,956 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx
2025-07-31 10:19:21,977 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_07310600.xlsx, active sheet: 'Feuille1'
2025-07-31 10:19:21,978 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx
2025-07-31 10:19:22,003 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_07310600.xlsx, active sheet: 'Feuille1'
2025-07-31 10:19:22,003 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-07-31 10:19:22,012 - INFO - Synop24h:347 - Word template loaded successfully.
2025-07-31 10:19:22,013 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-07-31 10:19:22,013 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-07-31 10:19:22,013 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 30 Juillet 2025 à 06h au 31 Juillet 2025 à 06h.'
2025-07-31 10:19:22,013 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 31 Juillet 2025'
2025-07-31 10:19:22,014 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-07-31 10:19:22,015 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-07-31 10:19:22,015 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-07-31 10:19:22,194 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-07-31 10:19:22,208 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-07-31 10:19:22,208 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-07-31 10:19:22,387 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-07-31 10:19:22,401 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-07-31 10:19:22,416 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table07310600.docx
2025-07-31 10:19:22,416 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-07-31 10:19:22,512 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:19:22,512 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-07-31 10:19:22,512 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-07-31 10:19:22,512 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 07 31 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-07-31 10:19:23,078 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=07, Day=31, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-07-31 10:19:23,078 - INFO - SynoClim:74 - Configured file paths:
2025-07-31 10:19:23,078 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:19:23,078 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:19:23,078 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:19:23,079 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-07-31 10:19:23,079 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:19:23,079 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:19:23,079 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-07-31 10:19:23,079 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx
2025-07-31 10:19:23,079 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-07-31 10:19:23,080 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202507310600.bufr
2025-07-31 10:19:23,252 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (182, 3)
2025-07-31 10:19:23,256 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-07-31 10:19:23,257 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-07-31 10:19:23,258 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (91, 3)
2025-07-31 10:19:23,262 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-07-31 10:19:23,263 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (91, 3)
2025-07-31 10:19:23,263 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:19:23,263 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-07-31 10:19:23,351 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-07-31 10:19:23,351 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-07-31 10:19:23,351 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-07-31 10:19:23,351 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-07-31 10:19:23,351 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-07-31.xlsx. Attempting to load.
2025-07-31 10:19:23,364 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-07-31 10:19:23,368 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-07-31 10:19:23,369 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,370 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,371 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,381 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,384 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,385 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,387 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,392 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,394 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,396 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,398 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,401 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,401 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,407 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,408 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,419 - INFO - SynoClim:266 -   Station 'TIMIMOUN' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,420 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,422 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,424 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,424 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,425 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,426 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,428 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,432 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,433 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,436 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,437 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,439 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,441 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-07-31 10:19:23,442 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 29
2025-07-31 10:19:23,442 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:19:23,466 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025310600.xlsx
2025-07-31 10:19:23,466 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:19:23,467 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250731.txt
2025-07-31 10:19:23,467 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-07-31 10:19:23,479 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-07-31 10:19:23,479 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-07-31 10:19:23,480 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-07-31 10:19:23,480 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 30 Juillet 2025 à 06h au 31 Juillet 2025 à 06h.'
2025-07-31 10:19:23,480 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-07-31 10:19:23,481 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-07-31 10:19:24,914 - INFO - SynoClim:397 - Finished populating Word document table.
2025-07-31 10:19:24,914 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:19:24,926 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table07310600.docx
2025-07-31 10:19:24,927 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-07-31 10:19:25,022 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-07-31 10:19:25,022 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-07-31 10:19:25,022 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-07-31 10:19:25,023 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/07.
2025-07-31 10:19:25,023 - INFO - file_operations:98 - Moved '20250731.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/07'.
2025-07-31 10:19:25,023 - INFO - file_operations:98 - Moved 'Synop20250731-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/07'.
2025-07-31 10:19:25,024 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:19:25,024 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-07-31 10:19:25,024 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-07-31 10:19:25,024 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/07 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31.
2025-07-31 10:19:25,024 - INFO - Bulletin:229 - Backup directories created successfully.
2025-07-31 10:19:25,024 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/07/31 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31.
2025-07-31 10:19:25,024 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/07/31' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31'.
2025-07-31 10:19:25,024 - INFO - file_operations:355 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31' exists. Removing it before copying.
2025-07-31 10:19:25,029 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/07/31' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/07/31'.
2025-07-31 10:19:25,029 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-07-31 10:19:25,029 - INFO - Bulletin:251 - Script finished.
2025-08-03 08:32:19,123 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-03 08:32:19,123 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-03 08:32:19,123 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-03 08:32:19,123 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-03 08:32:19,123 - INFO - Bulletin:69 - Current Day (DD): 03
2025-08-03 08:32:19,123 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-03 08:32:19,123 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-03 08:32:19,123 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-03 08:32:19,123 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-03 08:32:19,123 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-03 08:32:19,123 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-03.csv.
2025-08-03 08:32:19,123 - INFO - fetchdata:75 - Starting FTP file fetch process.
2025-08-03 08:32:19,124 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-03 08:32:49,154 - ERROR - fetchdata:21 - Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-03 08:32:49,154 - ERROR - fetchdata:123 - An error occurred during FTP transfer: Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-03 08:32:49,154 - ERROR - Bulletin:126 - An error occurred during FTP operations: Failed to connect to FTP server 10.16.80.222. Error: timed out
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
TimeoutError: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 78, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 22, in create_ftp_client
    raise ConnectionError(f"Failed to connect to FTP server {host}. Error: {e}")
ConnectionError: Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-03 08:32:49,157 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/03/Synop_202508030600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-03 08:32:49,158 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-03 08:32:49,159 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-03 08:32:49,159 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-03 08:32:49,159 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-03 08:32:49,159 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-03 08:32:49,159 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-03 08:32:49,159 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-03 08:32:49,159 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 08:32:49,160 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 08:32:49,160 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-03 08:32:49,160 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 08:32:49,160 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-03 08:32:49,160 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/03 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 08:32:49,160 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 08:32:49,160 - INFO - file_operations:355 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03' exists. Removing it before copying.
2025-08-03 08:32:49,163 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 08:32:49,163 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-03 08:32:49,163 - INFO - Bulletin:251 - Script finished.
2025-08-03 08:36:31,459 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-03 08:36:31,459 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-03 08:36:31,459 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-03 08:36:31,459 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-03 08:36:31,459 - INFO - Bulletin:69 - Current Day (DD): 03
2025-08-03 08:36:31,459 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-03 08:36:31,459 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-03 08:36:31,459 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-03 08:36:31,459 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-03 08:36:31,459 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-03 08:36:31,459 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-03.csv.
2025-08-03 08:36:31,459 - INFO - fetchdata:75 - Starting FTP file fetch process.
2025-08-03 08:36:31,460 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-03 08:36:43,551 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-03 08:36:43,551 - ERROR - fetchdata:123 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-03 08:36:43,552 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 78, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-03 08:36:43,556 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/03/Synop_202508030600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-03 08:36:43,557 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-03 08:36:43,558 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-03 08:36:43,558 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-03 08:36:43,558 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-03 08:36:43,558 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-03 08:36:43,560 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-03 08:36:43,560 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-03 08:36:43,561 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 08:36:43,561 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 08:36:43,561 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-03 08:36:43,562 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 08:36:43,562 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-03 08:36:43,562 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/03 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 08:36:43,563 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 08:36:43,564 - INFO - file_operations:355 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03' exists. Removing it before copying.
2025-08-03 08:36:43,579 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 08:36:43,579 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-03 08:36:43,579 - INFO - Bulletin:251 - Script finished.
2025-08-03 09:21:27,548 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-03 09:21:27,548 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-03 09:21:27,548 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-03 09:21:27,548 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-03 09:21:27,548 - INFO - Bulletin:69 - Current Day (DD): 03
2025-08-03 09:21:27,548 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:27,548 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-03 09:21:27,548 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-03 09:21:27,548 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-03 09:21:27,548 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:27,548 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-03.csv.
2025-08-03 09:21:27,548 - INFO - fetchdata:75 - Starting FTP file fetch process.
2025-08-03 09:21:27,548 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-03 09:21:27,638 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-03 09:21:27,639 - INFO - fetchdata:84 - Changed remote directory to: /
2025-08-03 09:21:27,640 - INFO - fetchdata:91 - Looking for files matching pattern: 'exported_data_2025-08-03.csv'
2025-08-03 09:21:27,640 - INFO - fetchdata:95 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:27,647 - INFO - fetchdata:104 - Found 1 files matching pattern on remote server.
2025-08-03 09:21:27,647 - INFO - fetchdata:117 - Downloading exported_data_2025-08-03.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-03.csv
2025-08-03 09:21:27,652 - INFO - fetchdata:120 - Successfully downloaded exported_data_2025-08-03.csv
2025-08-03 09:21:27,653 - INFO - fetchdata:128 - FTP file fetch process completed.
2025-08-03 09:21:27,653 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-03.csv successful.
2025-08-03 09:21:27,654 - INFO - Bulletin:120 - Moved exported_data_2025-08-03.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-03 09:21:27,654 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/03/Synop_202508030600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-03 09:21:27,655 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-03 09:21:27,655 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-03 09:21:27,656 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-03 09:21:27,656 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-03 09:21:27,656 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 03 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-03 09:21:28,096 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=03, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:28,102 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-03.csv
2025-08-03 09:21:28,106 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-03 09:21:28,116 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-03.xlsx
2025-08-03 09:21:28,116 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-03 09:21:28,180 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-03 09:21:28,180 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-03 09:21:28,180 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-03 09:21:28,180 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 03 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-03 09:21:28,743 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=03, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:28,743 - INFO - Synop24h:75 - Constructed file paths:
2025-08-03 09:21:28,744 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr
2025-08-03 09:21:28,744 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08030600.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08030600.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-03 09:21:28,744 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08030600.docx
2025-08-03 09:21:28,744 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-03 09:21:28,744 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250803-06.txt
2025-08-03 09:21:28,744 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-03 09:21:28,744 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-03 09:21:28,744 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-03 09:21:28,744 - INFO - Synop24h:113 - Today's date: 2025-08-03
2025-08-03 09:21:28,744 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-03 09:21:28,745 - INFO - data_utils:303 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-03 09:21:28,894 - INFO - data_utils:312 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr. DataFrame shape: (154, 3)
2025-08-03 09:21:28,895 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-03 09:21:28,896 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 77
2025-08-03 09:21:28,897 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (77, 2)
2025-08-03 09:21:28,898 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-03 09:21:28,898 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-03 09:21:28,920 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-03 09:21:28,920 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-03 09:21:28,922 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-03 09:21:28,930 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-03 09:21:28,962 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08030600.xlsx
2025-08-03 09:21:28,963 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250803-06.txt. Total unique missing stations: 2
2025-08-03 09:21:28,963 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-03 09:21:28,963 - CRITICAL - data_utils:271 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-03 09:21:28,963 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-03 09:21:29,053 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 03 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-03 09:21:29,053 - ERROR - system_utils:58 - STDOUT: 2025-08-03 09:21:28,743 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=03, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:28,743 - INFO - Synop24h:75 - Constructed file paths:
2025-08-03 09:21:28,744 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr
2025-08-03 09:21:28,744 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08030600.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08030600.xlsx
2025-08-03 09:21:28,744 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-03 09:21:28,744 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08030600.docx
2025-08-03 09:21:28,744 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-03 09:21:28,744 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250803-06.txt
2025-08-03 09:21:28,744 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-03 09:21:28,744 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-03 09:21:28,744 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-03 09:21:28,744 - INFO - Synop24h:113 - Today's date: 2025-08-03
2025-08-03 09:21:28,744 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-03 09:21:28,745 - INFO - data_utils:303 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-03 09:21:28,894 - INFO - data_utils:312 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr. DataFrame shape: (154, 3)
2025-08-03 09:21:28,895 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-03 09:21:28,896 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 77
2025-08-03 09:21:28,897 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (77, 2)
2025-08-03 09:21:28,898 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-03 09:21:28,898 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-03 09:21:28,920 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-03 09:21:28,920 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-03 09:21:28,922 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-03 09:21:28,930 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-03 09:21:28,962 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08030600.xlsx
2025-08-03 09:21:28,963 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250803-06.txt. Total unique missing stations: 2
2025-08-03 09:21:28,963 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-03 09:21:28,963 - CRITICAL - data_utils:271 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-03 09:21:28,963 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-03 09:21:29,053 - ERROR - system_utils:59 - STDERR: 
2025-08-03 09:21:29,053 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '03', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '03', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-03 09:21:29,054 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-03 09:21:29,054 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 03 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-03 09:21:29,618 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=03, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-03 09:21:29,619 - INFO - SynoClim:74 - Configured file paths:
2025-08-03 09:21:29,619 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr
2025-08-03 09:21:29,619 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-03 09:21:29,619 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025030600.xlsx
2025-08-03 09:21:29,619 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-03 09:21:29,619 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08030600.docx
2025-08-03 09:21:29,619 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250803.txt
2025-08-03 09:21:29,619 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-03 09:21:29,619 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-03.xlsx
2025-08-03 09:21:29,619 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-03 09:21:29,620 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508030600.bufr
2025-08-03 09:21:29,771 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (154, 3)
2025-08-03 09:21:29,777 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-03 09:21:29,777 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-03 09:21:29,778 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (77, 3)
2025-08-03 09:21:29,782 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-03 09:21:29,783 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (77, 3)
2025-08-03 09:21:29,783 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-03 09:21:29,784 - INFO - data_utils:265 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-03 09:21:29,871 - INFO - data_utils:268 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-03 09:21:29,871 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-03 09:21:29,871 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-03 09:21:29,871 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-03 09:21:29,872 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-03.xlsx. Attempting to load.
2025-08-03 09:21:29,883 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-03 09:21:29,883 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-03 09:21:29,885 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,886 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,887 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,889 - INFO - SynoClim:266 -   Station 'AIN-DHEB' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,890 - INFO - SynoClim:237 -   Station 'TADJMOUT' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,891 - INFO - SynoClim:266 -   Station 'SIDI-EL-ABED' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,891 - INFO - SynoClim:266 -   Station 'ZMALET' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,893 - INFO - SynoClim:237 -   Station 'AIN-MLILA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,893 - INFO - SynoClim:266 -   Station 'YAKOUREN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,895 - INFO - SynoClim:237 -   Station 'BATNA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,896 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,897 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,897 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,898 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,899 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,900 - INFO - SynoClim:237 -   Station 'FOUGHALA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,900 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,901 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,902 - INFO - SynoClim:237 -   Station 'ABADLA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,902 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,903 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,904 - INFO - SynoClim:237 -   Station 'MOUGHEL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,905 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,905 - INFO - SynoClim:237 -   Station 'CHREA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,906 - INFO - SynoClim:237 -   Station 'ENSH' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,907 - INFO - SynoClim:266 -   Station 'AIN-EL-BELL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,908 - INFO - SynoClim:266 -   Station 'AIN-OUSSARA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,909 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,911 - INFO - SynoClim:266 -   Station 'AIN-OULMAN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,911 - INFO - SynoClim:237 -   Station 'ASSEKREM' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,912 - INFO - SynoClim:266 -   Station 'MEGRES' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,912 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,913 - INFO - SynoClim:266 -   Station 'BENI-AZIZ' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,914 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,914 - INFO - SynoClim:266 -   Station 'OUM-LADJOUL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,915 - INFO - SynoClim:237 -   Station 'TINTARABINE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,916 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,917 - INFO - SynoClim:266 -   Station 'AIN-SKOUNA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,917 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,918 - INFO - SynoClim:266 -   Station 'SAIDA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,919 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,920 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,920 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,921 - INFO - SynoClim:237 -   Station 'ABALESSA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,921 - INFO - SynoClim:266 -   Station 'COLO' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,922 - INFO - SynoClim:237 -   Station 'IN-AMGUEL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,923 - INFO - SynoClim:237 -   Station 'IDELES' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,924 - INFO - SynoClim:266 -   Station 'TESSALA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,924 - INFO - SynoClim:237 -   Station 'SILET' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,925 - INFO - SynoClim:237 -   Station 'TAZROUK' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,926 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,927 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,928 - INFO - SynoClim:237 -   Station 'AIN-ABID' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,929 - INFO - SynoClim:266 -   Station 'FERDJIOUA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,930 - INFO - SynoClim:237 -   Station 'ETAC' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,930 - INFO - SynoClim:266 -   Station 'BENI-HAROUN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,932 - INFO - SynoClim:237 -   Station 'MOSTAGANEM-CLIM' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,935 - INFO - SynoClim:266 -   Station 'AIN-TEMOUCHENT' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,935 - INFO - SynoClim:237 -   Station 'MASCARA-MATEMORE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,937 - INFO - SynoClim:266 -   Station 'EL-MATMAR' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,938 - INFO - SynoClim:237 -   Station 'HASSI-ABDELLAH' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,939 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,941 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,942 - INFO - SynoClim:266 -   Station 'TIMIAOUINE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,943 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,943 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,944 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,946 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,947 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,948 - INFO - SynoClim:266 -   Station 'IN-GHAR' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,949 - INFO - SynoClim:237 -   Station 'RAS-EL-OUED' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,950 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,951 - INFO - SynoClim:266 -   Station 'TINZAOUATENE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,952 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,952 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,953 - INFO - SynoClim:237 -   Station 'EL-KALA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,955 - INFO - SynoClim:237 -   Station 'TISSEMSILT' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,955 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,956 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,957 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,958 - INFO - SynoClim:266 -   Station 'IHERIR' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,959 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,960 - INFO - SynoClim:237 -   Station 'GOURAYA' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,961 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,962 - INFO - SynoClim:266 -   Station 'HASSI-EL-FHAL' not found in any data source. Marked as missing ('/').
2025-08-03 09:21:29,962 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 85
2025-08-03 09:21:29,962 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025030600.xlsx
2025-08-03 09:21:29,985 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025030600.xlsx
2025-08-03 09:21:29,985 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250803.txt
2025-08-03 09:21:29,985 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250803.txt
2025-08-03 09:21:29,985 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-03 09:21:29,998 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-03 09:21:29,998 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-03 09:21:29,998 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-03 09:21:29,999 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 02 Août 2025 à 06h au 03 Août 2025 à 06h.'
2025-08-03 09:21:29,999 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-03 09:21:30,000 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-03 09:21:31,373 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-03 09:21:31,373 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08030600.docx
2025-08-03 09:21:31,385 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08030600.docx
2025-08-03 09:21:31,385 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-03 09:21:31,483 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-03 09:21:31,483 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-03 09:21:31,483 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-03 09:21:31,483 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-03 09:21:31,484 - INFO - file_operations:98 - Moved 'Synop20250803-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-03 09:21:31,484 - INFO - file_operations:98 - Moved '20250803.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-03 09:21:31,484 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 09:21:31,484 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-03 09:21:31,484 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-03 09:21:31,484 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 09:21:31,484 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-03 09:21:31,484 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/03 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03.
2025-08-03 09:21:31,485 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 09:21:31,485 - INFO - file_operations:355 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03' exists. Removing it before copying.
2025-08-03 09:21:31,489 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/03' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/03'.
2025-08-03 09:21:31,489 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-03 09:21:31,490 - INFO - Bulletin:251 - Script finished.
2025-08-14 08:50:35,359 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-14 08:50:35,367 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-14 08:50:35,367 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-14 08:50:35,367 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-14 08:50:35,367 - INFO - Bulletin:69 - Current Day (DD): 14
2025-08-14 08:50:35,367 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:35,367 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-14 08:50:35,367 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-14 08:50:35,367 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-14 08:50:35,367 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:35,367 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-14.csv.
2025-08-14 08:50:35,367 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-14 08:50:35,367 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-14 08:50:35,380 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-14 08:50:35,381 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-14 08:50:35,381 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-14.csv'
2025-08-14 08:50:35,381 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:36,579 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-14 08:50:36,579 - INFO - fetchdata:118 - Downloading exported_data_2025-08-14.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-14.csv
2025-08-14 08:50:36,583 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-14.csv
2025-08-14 08:50:36,584 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-14 08:50:36,584 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-14.csv successful.
2025-08-14 08:50:36,585 - INFO - Bulletin:120 - Moved exported_data_2025-08-14.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-14 08:50:36,585 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508140600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-14 08:50:36,586 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-14 08:50:36,587 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-14 08:50:36,587 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-14 08:50:36,587 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-14 08:50:36,587 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 08:50:37,026 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:37,029 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-14.csv
2025-08-14 08:50:37,034 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-14 08:50:37,046 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx
2025-08-14 08:50:37,046 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-14 08:50:37,112 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-14 08:50:37,112 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-14 08:50:37,112 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-14 08:50:37,112 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 08:50:37,704 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:37,704 - INFO - Synop24h:75 - Constructed file paths:
2025-08-14 08:50:37,704 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 08:50:37,704 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08140600.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-14 08:50:37,704 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08140600.docx
2025-08-14 08:50:37,704 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-14 08:50:37,704 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt
2025-08-14 08:50:37,704 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 08:50:37,705 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-14 08:50:37,705 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-14 08:50:37,705 - INFO - Synop24h:113 - Today's date: 2025-08-14
2025-08-14 08:50:37,705 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-14 08:50:37,706 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-14 08:50:37,893 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr. DataFrame shape: (186, 3)
2025-08-14 08:50:37,893 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-14 08:50:37,894 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 93
2025-08-14 08:50:37,896 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (93, 2)
2025-08-14 08:50:37,896 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-14 08:50:37,896 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 08:50:37,921 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-14 08:50:37,921 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-14 08:50:37,923 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,926 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,931 - WARNING - Synop24h:206 - Row 10: Station 'El-Bayadh' (EL-BAYADH) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,932 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,963 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 08:50:37,963 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt. Total unique missing stations: 4
2025-08-14 08:50:37,963 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 08:50:37,963 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-14 08:50:37,964 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-14 08:50:38,056 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-14 08:50:38,056 - ERROR - system_utils:58 - STDOUT: 2025-08-14 08:50:37,704 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:37,704 - INFO - Synop24h:75 - Constructed file paths:
2025-08-14 08:50:37,704 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 08:50:37,704 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08140600.xlsx
2025-08-14 08:50:37,704 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-14 08:50:37,704 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08140600.docx
2025-08-14 08:50:37,704 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-14 08:50:37,704 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt
2025-08-14 08:50:37,704 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 08:50:37,705 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-14 08:50:37,705 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-14 08:50:37,705 - INFO - Synop24h:113 - Today's date: 2025-08-14
2025-08-14 08:50:37,705 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-14 08:50:37,706 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-14 08:50:37,893 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr. DataFrame shape: (186, 3)
2025-08-14 08:50:37,893 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-14 08:50:37,894 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 93
2025-08-14 08:50:37,896 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (93, 2)
2025-08-14 08:50:37,896 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-14 08:50:37,896 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 08:50:37,921 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-14 08:50:37,921 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-14 08:50:37,923 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,926 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,931 - WARNING - Synop24h:206 - Row 10: Station 'El-Bayadh' (EL-BAYADH) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,932 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-14 08:50:37,963 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 08:50:37,963 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt. Total unique missing stations: 4
2025-08-14 08:50:37,963 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 08:50:37,963 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-14 08:50:37,964 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-14 08:50:38,056 - ERROR - system_utils:59 - STDERR: 
2025-08-14 08:50:38,056 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '14', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '14', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-14 08:50:38,057 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-14 08:50:38,057 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 08:50:38,653 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 08:50:38,653 - INFO - SynoClim:74 - Configured file paths:
2025-08-14 08:50:38,653 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 08:50:38,653 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 08:50:38,653 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 08:50:38,653 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-14 08:50:38,653 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 08:50:38,653 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 08:50:38,653 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-14 08:50:38,653 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx
2025-08-14 08:50:38,653 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 08:50:38,654 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 08:50:38,840 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (186, 3)
2025-08-14 08:50:38,846 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-14 08:50:38,846 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-14 08:50:38,847 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (93, 3)
2025-08-14 08:50:38,851 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-14 08:50:38,852 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (93, 3)
2025-08-14 08:50:38,853 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 08:50:38,853 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 08:50:38,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-14 08:50:38,953 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-14 08:50:38,953 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-14 08:50:38,953 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-14 08:50:38,953 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx. Attempting to load.
2025-08-14 08:50:38,967 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-14 08:50:38,970 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-14 08:50:38,972 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,973 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,974 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,985 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,988 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,990 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,992 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,996 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:38,999 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,001 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,003 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,006 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,007 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,013 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,014 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,027 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,028 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,029 - INFO - SynoClim:237 -   Station 'ORAN-TAFARAOUI' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,030 - INFO - SynoClim:237 -   Station 'EL-BAYADH' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,031 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,032 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,032 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,034 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,036 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,040 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,041 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,045 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,046 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,048 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,050 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-14 08:50:39,051 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 30
2025-08-14 08:50:39,051 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 08:50:39,079 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 08:50:39,079 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 08:50:39,079 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 08:50:39,080 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-14 08:50:39,093 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-14 08:50:39,094 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-14 08:50:39,094 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-14 08:50:39,094 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 13 Août 2025 à 06h au 14 Août 2025 à 06h.'
2025-08-14 08:50:39,094 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-14 08:50:39,095 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-14 08:50:40,767 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-14 08:50:40,767 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 08:50:40,782 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 08:50:40,782 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-14 08:50:40,881 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-14 08:50:40,881 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-14 08:50:40,881 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-14 08:50:40,881 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-14 08:50:40,882 - INFO - file_operations:98 - Moved '20250814.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-14 08:50:40,882 - INFO - file_operations:98 - Moved 'Synop20250814-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-14 08:50:40,882 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-14 08:50:40,882 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-14 08:50:40,882 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-14 08:50:40,882 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14.
2025-08-14 08:50:40,882 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-14 08:50:40,883 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/14 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14.
2025-08-14 08:50:40,883 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/14' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14'.
2025-08-14 08:50:40,883 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14' exists. Removing it before copying.
2025-08-14 08:50:40,886 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/14' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14'.
2025-08-14 08:50:40,886 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-14 08:50:40,886 - INFO - Bulletin:251 - Script finished.
2025-08-14 09:20:01,070 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-14 09:20:01,083 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-14 09:20:01,084 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-14 09:20:01,084 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-14 09:20:01,084 - INFO - Bulletin:69 - Current Day (DD): 14
2025-08-14 09:20:01,084 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:01,084 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-14 09:20:01,084 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-14 09:20:01,084 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-14 09:20:01,084 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:01,084 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-14.csv.
2025-08-14 09:20:01,084 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-14 09:20:01,084 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-14 09:20:01,097 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-14 09:20:01,099 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-14 09:20:01,099 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-14.csv'
2025-08-14 09:20:01,099 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:01,165 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-14 09:20:01,165 - INFO - fetchdata:118 - Downloading exported_data_2025-08-14.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-14.csv
2025-08-14 09:20:01,181 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-14.csv
2025-08-14 09:20:01,182 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-14 09:20:01,183 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-14.csv successful.
2025-08-14 09:20:01,183 - INFO - Bulletin:120 - Moved exported_data_2025-08-14.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-14 09:20:01,183 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508140600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-14 09:20:01,184 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-14 09:20:01,184 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-14 09:20:01,184 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-14 09:20:01,184 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-14 09:20:01,184 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 09:20:01,635 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:01,638 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-14.csv
2025-08-14 09:20:01,644 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-14 09:20:01,656 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx
2025-08-14 09:20:01,657 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-14 09:20:01,729 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-14 09:20:01,730 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-14 09:20:01,730 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-14 09:20:01,730 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 09:20:02,384 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:02,384 - INFO - Synop24h:75 - Constructed file paths:
2025-08-14 09:20:02,384 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 09:20:02,385 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08140600.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-14 09:20:02,385 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08140600.docx
2025-08-14 09:20:02,385 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-14 09:20:02,385 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt
2025-08-14 09:20:02,385 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 09:20:02,385 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-14 09:20:02,385 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-14 09:20:02,385 - INFO - Synop24h:113 - Today's date: 2025-08-14
2025-08-14 09:20:02,385 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-14 09:20:02,386 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-14 09:20:02,574 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr. DataFrame shape: (186, 3)
2025-08-14 09:20:02,574 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-14 09:20:02,576 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 93
2025-08-14 09:20:02,578 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (93, 2)
2025-08-14 09:20:02,578 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-14 09:20:02,578 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 09:20:02,600 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-14 09:20:02,600 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-14 09:20:02,602 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,605 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,610 - WARNING - Synop24h:206 - Row 10: Station 'El-Bayadh' (EL-BAYADH) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,611 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,640 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 09:20:02,640 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt. Total unique missing stations: 4
2025-08-14 09:20:02,640 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 09:20:02,640 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-14 09:20:02,640 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-14 09:20:02,746 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-14 09:20:02,746 - ERROR - system_utils:58 - STDOUT: 2025-08-14 09:20:02,384 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:02,384 - INFO - Synop24h:75 - Constructed file paths:
2025-08-14 09:20:02,384 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 09:20:02,385 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08140600.xlsx
2025-08-14 09:20:02,385 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-14 09:20:02,385 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08140600.docx
2025-08-14 09:20:02,385 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-14 09:20:02,385 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt
2025-08-14 09:20:02,385 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 09:20:02,385 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-14 09:20:02,385 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-14 09:20:02,385 - INFO - Synop24h:113 - Today's date: 2025-08-14
2025-08-14 09:20:02,385 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-14 09:20:02,386 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-14 09:20:02,574 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr. DataFrame shape: (186, 3)
2025-08-14 09:20:02,574 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-14 09:20:02,576 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 93
2025-08-14 09:20:02,578 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (93, 2)
2025-08-14 09:20:02,578 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-14 09:20:02,578 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-14 09:20:02,600 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-14 09:20:02,600 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-14 09:20:02,602 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,605 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,610 - WARNING - Synop24h:206 - Row 10: Station 'El-Bayadh' (EL-BAYADH) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,611 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-14 09:20:02,640 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08140600.xlsx
2025-08-14 09:20:02,640 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250814-06.txt. Total unique missing stations: 4
2025-08-14 09:20:02,640 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-14 09:20:02,640 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-14 09:20:02,640 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-14 09:20:02,746 - ERROR - system_utils:59 - STDERR: 
2025-08-14 09:20:02,746 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '14', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '14', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-14 09:20:02,747 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-14 09:20:02,747 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 14 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-14 09:20:03,385 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=14, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-14 09:20:03,386 - INFO - SynoClim:74 - Configured file paths:
2025-08-14 09:20:03,386 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 09:20:03,386 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 09:20:03,386 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 09:20:03,386 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-14 09:20:03,386 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 09:20:03,386 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 09:20:03,386 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-14 09:20:03,386 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx
2025-08-14 09:20:03,386 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-14 09:20:03,387 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508140600.bufr
2025-08-14 09:20:03,569 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (186, 3)
2025-08-14 09:20:03,574 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-14 09:20:03,574 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-14 09:20:03,575 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (93, 3)
2025-08-14 09:20:03,580 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-14 09:20:03,581 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (93, 3)
2025-08-14 09:20:03,582 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 09:20:03,582 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-14 09:20:03,671 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-14 09:20:03,671 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-14 09:20:03,672 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-14 09:20:03,672 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-14 09:20:03,672 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-14.xlsx. Attempting to load.
2025-08-14 09:20:03,684 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-14 09:20:03,688 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-14 09:20:03,690 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,691 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,692 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,701 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,704 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,706 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,707 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,712 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,715 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,716 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,718 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,721 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,722 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,728 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,729 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,741 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,743 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,743 - INFO - SynoClim:237 -   Station 'ORAN-TAFARAOUI' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,745 - INFO - SynoClim:237 -   Station 'EL-BAYADH' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,745 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,746 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,746 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,748 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,750 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,754 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,755 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,758 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,759 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,762 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,763 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-14 09:20:03,764 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 30
2025-08-14 09:20:03,764 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 09:20:03,788 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025140600.xlsx
2025-08-14 09:20:03,788 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 09:20:03,788 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250814.txt
2025-08-14 09:20:03,788 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-14 09:20:03,801 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-14 09:20:03,801 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-14 09:20:03,801 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-14 09:20:03,801 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 13 Août 2025 à 06h au 14 Août 2025 à 06h.'
2025-08-14 09:20:03,801 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-14 09:20:03,803 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-14 09:20:05,354 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-14 09:20:05,354 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 09:20:05,366 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08140600.docx
2025-08-14 09:20:05,366 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-14 09:20:05,472 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-14 09:20:05,472 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-14 09:20:05,472 - INFO - Bulletin:195 - Restored CWD after script execution to /home/aoumeur.
2025-08-14 09:20:05,472 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-14 09:20:05,472 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-14 09:20:05,473 - INFO - file_operations:98 - Moved '20250814.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-14 09:20:05,473 - INFO - file_operations:98 - Moved 'Synop20250814-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-14 09:20:05,473 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-14 09:20:05,473 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-14 09:20:05,473 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-14 09:20:05,473 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14.
2025-08-14 09:20:05,473 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-14 09:20:05,473 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/14 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14.
2025-08-14 09:20:05,474 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/14' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14'.
2025-08-14 09:20:05,474 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14' exists. Removing it before copying.
2025-08-14 09:20:05,478 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/14' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/14'.
2025-08-14 09:20:05,478 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-14 09:20:05,478 - INFO - Bulletin:251 - Script finished.
2025-08-15 09:20:01,208 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-15 09:20:01,234 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-15 09:20:01,234 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-15 09:20:01,234 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-15 09:20:01,235 - INFO - Bulletin:69 - Current Day (DD): 15
2025-08-15 09:20:01,235 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:01,235 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-15 09:20:01,235 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-15 09:20:01,235 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-15 09:20:01,235 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:01,235 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-15.csv.
2025-08-15 09:20:01,235 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-15 09:20:01,235 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-15 09:20:01,248 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-15 09:20:01,249 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-15 09:20:01,249 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-15.csv'
2025-08-15 09:20:01,249 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:07,018 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-15 09:20:07,018 - INFO - fetchdata:118 - Downloading exported_data_2025-08-15.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-15.csv
2025-08-15 09:20:07,055 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-15.csv
2025-08-15 09:20:07,056 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-15 09:20:07,056 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-15.csv successful.
2025-08-15 09:20:07,057 - INFO - Bulletin:120 - Moved exported_data_2025-08-15.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-15 09:20:07,057 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508150600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-15 09:20:07,058 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-15 09:20:07,059 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-15 09:20:07,059 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-15 09:20:07,059 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-15 09:20:07,059 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 15 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-15 09:20:07,475 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=15, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:07,478 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-15.csv
2025-08-15 09:20:07,483 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-15 09:20:07,495 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-15.xlsx
2025-08-15 09:20:07,495 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-15 09:20:07,559 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-15 09:20:07,559 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-15 09:20:07,559 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-15 09:20:07,559 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 15 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-15 09:20:08,149 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=15, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:08,149 - INFO - Synop24h:75 - Constructed file paths:
2025-08-15 09:20:08,149 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr
2025-08-15 09:20:08,150 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08150600.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08150600.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-15 09:20:08,150 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08150600.docx
2025-08-15 09:20:08,150 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-15 09:20:08,150 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250815-06.txt
2025-08-15 09:20:08,150 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-15 09:20:08,150 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-15 09:20:08,150 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-15 09:20:08,150 - INFO - Synop24h:113 - Today's date: 2025-08-15
2025-08-15 09:20:08,150 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-15 09:20:08,151 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-15 09:20:08,347 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr. DataFrame shape: (192, 3)
2025-08-15 09:20:08,348 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-15 09:20:08,349 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 96
2025-08-15 09:20:08,350 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (96, 2)
2025-08-15 09:20:08,351 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-15 09:20:08,351 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-15 09:20:08,375 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-15 09:20:08,375 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-15 09:20:08,377 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-15 09:20:08,386 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-15 09:20:08,426 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08150600.xlsx
2025-08-15 09:20:08,426 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250815-06.txt. Total unique missing stations: 2
2025-08-15 09:20:08,426 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-15 09:20:08,426 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-15 09:20:08,427 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-15 09:20:08,516 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 15 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-15 09:20:08,517 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:20:08,149 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=15, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:08,149 - INFO - Synop24h:75 - Constructed file paths:
2025-08-15 09:20:08,149 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr
2025-08-15 09:20:08,150 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08150600.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08150600.xlsx
2025-08-15 09:20:08,150 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-15 09:20:08,150 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08150600.docx
2025-08-15 09:20:08,150 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-15 09:20:08,150 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250815-06.txt
2025-08-15 09:20:08,150 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-15 09:20:08,150 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-15 09:20:08,150 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-15 09:20:08,150 - INFO - Synop24h:113 - Today's date: 2025-08-15
2025-08-15 09:20:08,150 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-15 09:20:08,151 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-15 09:20:08,347 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr. DataFrame shape: (192, 3)
2025-08-15 09:20:08,348 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-15 09:20:08,349 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 96
2025-08-15 09:20:08,350 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (96, 2)
2025-08-15 09:20:08,351 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-15 09:20:08,351 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-15 09:20:08,375 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-15 09:20:08,375 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-15 09:20:08,377 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-15 09:20:08,386 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-15 09:20:08,426 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08150600.xlsx
2025-08-15 09:20:08,426 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250815-06.txt. Total unique missing stations: 2
2025-08-15 09:20:08,426 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-15 09:20:08,426 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-15 09:20:08,427 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-15 09:20:08,517 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:20:08,517 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '15', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '15', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-15 09:20:08,517 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-15 09:20:08,517 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 15 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-15 09:20:09,076 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=15, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-15 09:20:09,076 - INFO - SynoClim:74 - Configured file paths:
2025-08-15 09:20:09,077 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr
2025-08-15 09:20:09,077 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-15 09:20:09,077 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025150600.xlsx
2025-08-15 09:20:09,077 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-15 09:20:09,077 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08150600.docx
2025-08-15 09:20:09,077 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250815.txt
2025-08-15 09:20:09,077 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-15 09:20:09,077 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-15.xlsx
2025-08-15 09:20:09,077 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-15 09:20:09,078 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508150600.bufr
2025-08-15 09:20:09,258 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (192, 3)
2025-08-15 09:20:09,263 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-15 09:20:09,263 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-15 09:20:09,264 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (96, 3)
2025-08-15 09:20:09,268 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-15 09:20:09,269 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (96, 3)
2025-08-15 09:20:09,269 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-15 09:20:09,270 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-15 09:20:09,357 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-15 09:20:09,358 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-15 09:20:09,358 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-15 09:20:09,358 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-15 09:20:09,358 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-15.xlsx. Attempting to load.
2025-08-15 09:20:09,371 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-15 09:20:09,374 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-15 09:20:09,376 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,377 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,378 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,388 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,391 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,392 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,398 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,401 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,402 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,404 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,407 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,408 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,414 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,414 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,426 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,428 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,430 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,430 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,431 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,433 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,434 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,438 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,439 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,442 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,443 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,445 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,447 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-15 09:20:09,448 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 27
2025-08-15 09:20:09,448 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025150600.xlsx
2025-08-15 09:20:09,472 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025150600.xlsx
2025-08-15 09:20:09,472 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250815.txt
2025-08-15 09:20:09,472 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250815.txt
2025-08-15 09:20:09,472 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-15 09:20:09,485 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-15 09:20:09,485 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-15 09:20:09,485 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-15 09:20:09,485 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 14 Août 2025 à 06h au 15 Août 2025 à 06h.'
2025-08-15 09:20:09,485 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-15 09:20:09,486 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-15 09:20:10,885 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-15 09:20:10,886 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08150600.docx
2025-08-15 09:20:10,897 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08150600.docx
2025-08-15 09:20:10,897 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-15 09:20:10,993 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-15 09:20:10,993 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-15 09:20:10,993 - INFO - Bulletin:195 - Restored CWD after script execution to /home/aoumeur.
2025-08-15 09:20:10,993 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-15 09:20:10,993 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-15 09:20:10,993 - INFO - file_operations:98 - Moved 'Synop20250815-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-15 09:20:10,994 - INFO - file_operations:98 - Moved '20250815.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-15 09:20:10,994 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-15 09:20:10,994 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-15 09:20:10,994 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-15 09:20:10,994 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/15.
2025-08-15 09:20:10,994 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-15 09:20:10,994 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/15 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/15.
2025-08-15 09:20:10,994 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/15' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/15'.
2025-08-15 09:20:10,994 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/15' exists. Removing it before copying.
2025-08-15 09:20:10,997 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/15' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/15'.
2025-08-15 09:20:10,998 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-15 09:20:10,998 - INFO - Bulletin:251 - Script finished.
2025-08-16 09:20:01,738 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-16 09:20:01,738 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-16 09:20:01,738 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-16 09:20:01,738 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-16 09:20:01,738 - INFO - Bulletin:69 - Current Day (DD): 16
2025-08-16 09:20:01,738 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:01,739 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-16 09:20:01,739 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-16 09:20:01,739 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-16 09:20:01,739 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:01,739 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-16.csv.
2025-08-16 09:20:01,739 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-16 09:20:01,739 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-16 09:20:01,752 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-16 09:20:01,752 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-16 09:20:01,753 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-16.csv'
2025-08-16 09:20:01,753 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:02,528 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-16 09:20:02,528 - INFO - fetchdata:118 - Downloading exported_data_2025-08-16.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-16.csv
2025-08-16 09:20:02,533 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-16.csv
2025-08-16 09:20:02,534 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-16 09:20:02,534 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-16.csv successful.
2025-08-16 09:20:02,535 - INFO - Bulletin:120 - Moved exported_data_2025-08-16.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-16 09:20:02,535 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508160600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-16 09:20:02,536 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-16 09:20:02,536 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-16 09:20:02,537 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-16 09:20:02,537 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-16 09:20:02,537 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 16 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-16 09:20:02,953 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=16, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:02,958 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-16.csv
2025-08-16 09:20:02,963 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-16 09:20:02,973 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-16.xlsx
2025-08-16 09:20:02,973 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-16 09:20:03,038 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-16 09:20:03,038 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-16 09:20:03,038 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-16 09:20:03,038 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 16 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-16 09:20:03,596 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=16, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:03,596 - INFO - Synop24h:75 - Constructed file paths:
2025-08-16 09:20:03,596 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr
2025-08-16 09:20:03,596 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08160600.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08160600.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-16 09:20:03,597 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08160600.docx
2025-08-16 09:20:03,597 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-16 09:20:03,597 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250816-06.txt
2025-08-16 09:20:03,597 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-16 09:20:03,597 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-16 09:20:03,597 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-16 09:20:03,597 - INFO - Synop24h:113 - Today's date: 2025-08-16
2025-08-16 09:20:03,597 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-16 09:20:03,598 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-16 09:20:03,768 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr. DataFrame shape: (184, 3)
2025-08-16 09:20:03,769 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-16 09:20:03,770 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 92
2025-08-16 09:20:03,771 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (92, 2)
2025-08-16 09:20:03,772 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-16 09:20:03,772 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-16 09:20:03,793 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-16 09:20:03,793 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-16 09:20:03,795 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,798 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,803 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,805 - WARNING - Synop24h:206 - Row 13: Station 'Rhoud-Nouss' (RHOURD NOUSS) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,810 - WARNING - Synop24h:206 - Row 18: Station 'Béjaia' (BEJAIA-AEROPORT) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,830 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08160600.xlsx
2025-08-16 09:20:03,830 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250816-06.txt. Total unique missing stations: 5
2025-08-16 09:20:03,831 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-16 09:20:03,831 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-16 09:20:03,831 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-16 09:20:03,921 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 16 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-16 09:20:03,921 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:20:03,596 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=16, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:03,596 - INFO - Synop24h:75 - Constructed file paths:
2025-08-16 09:20:03,596 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr
2025-08-16 09:20:03,596 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08160600.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08160600.xlsx
2025-08-16 09:20:03,596 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-16 09:20:03,597 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08160600.docx
2025-08-16 09:20:03,597 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-16 09:20:03,597 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250816-06.txt
2025-08-16 09:20:03,597 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-16 09:20:03,597 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-16 09:20:03,597 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-16 09:20:03,597 - INFO - Synop24h:113 - Today's date: 2025-08-16
2025-08-16 09:20:03,597 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-16 09:20:03,598 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-16 09:20:03,768 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr. DataFrame shape: (184, 3)
2025-08-16 09:20:03,769 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-16 09:20:03,770 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 92
2025-08-16 09:20:03,771 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (92, 2)
2025-08-16 09:20:03,772 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-16 09:20:03,772 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-16 09:20:03,793 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-16 09:20:03,793 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-16 09:20:03,795 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,798 - WARNING - Synop24h:206 - Row 6: Station 'Oran-Tafraoui' (ORAN-TAFARAOUI) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,803 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,805 - WARNING - Synop24h:206 - Row 13: Station 'Rhoud-Nouss' (RHOURD NOUSS) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,810 - WARNING - Synop24h:206 - Row 18: Station 'Béjaia' (BEJAIA-AEROPORT) not found in BUFR data. Marked as missing.
2025-08-16 09:20:03,830 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08160600.xlsx
2025-08-16 09:20:03,830 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250816-06.txt. Total unique missing stations: 5
2025-08-16 09:20:03,831 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-16 09:20:03,831 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-16 09:20:03,831 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-16 09:20:03,921 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:20:03,921 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '16', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '16', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-16 09:20:03,922 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-16 09:20:03,922 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 16 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-16 09:20:04,477 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=16, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-16 09:20:04,477 - INFO - SynoClim:74 - Configured file paths:
2025-08-16 09:20:04,477 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr
2025-08-16 09:20:04,477 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-16 09:20:04,477 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025160600.xlsx
2025-08-16 09:20:04,477 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-16 09:20:04,477 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08160600.docx
2025-08-16 09:20:04,478 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250816.txt
2025-08-16 09:20:04,478 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-16 09:20:04,478 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-16.xlsx
2025-08-16 09:20:04,478 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-16 09:20:04,478 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508160600.bufr
2025-08-16 09:20:04,651 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (184, 3)
2025-08-16 09:20:04,655 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-16 09:20:04,656 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-16 09:20:04,656 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (92, 3)
2025-08-16 09:20:04,660 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-16 09:20:04,662 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (92, 3)
2025-08-16 09:20:04,662 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-16 09:20:04,662 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-16 09:20:04,750 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-16 09:20:04,750 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-16 09:20:04,750 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-16 09:20:04,751 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-16 09:20:04,751 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-16.xlsx. Attempting to load.
2025-08-16 09:20:04,761 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-16 09:20:04,762 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-16 09:20:04,763 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,764 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,765 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,767 - INFO - SynoClim:266 -   Station 'AIN-DHEB' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,768 - INFO - SynoClim:237 -   Station 'TADJMOUT' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,769 - INFO - SynoClim:266 -   Station 'SIDI-EL-ABED' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,770 - INFO - SynoClim:266 -   Station 'ZMALET' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,771 - INFO - SynoClim:237 -   Station 'AIN-MLILA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,772 - INFO - SynoClim:266 -   Station 'YAKOUREN' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,773 - INFO - SynoClim:237 -   Station 'BATNA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,775 - INFO - SynoClim:237 -   Station 'BEJAIA-AEROPORT' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,776 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,777 - INFO - SynoClim:237 -   Station 'FOUGHALA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,779 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,779 - INFO - SynoClim:237 -   Station 'ABADLA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,780 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,781 - INFO - SynoClim:237 -   Station 'MOUGHEL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,782 - INFO - SynoClim:237 -   Station 'CHREA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,783 - INFO - SynoClim:237 -   Station 'ENSH' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,784 - INFO - SynoClim:266 -   Station 'AIN-EL-BELL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,785 - INFO - SynoClim:266 -   Station 'AIN-OUSSARA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,786 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,787 - INFO - SynoClim:266 -   Station 'AIN-OULMAN' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,788 - INFO - SynoClim:266 -   Station 'MEGRES' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,789 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,789 - INFO - SynoClim:266 -   Station 'BENI-AZIZ' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,790 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,791 - INFO - SynoClim:266 -   Station 'OUM-LADJOUL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,791 - INFO - SynoClim:237 -   Station 'TINTARABINE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,792 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,793 - INFO - SynoClim:266 -   Station 'AIN-SKOUNA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,794 - INFO - SynoClim:266 -   Station 'SAIDA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,795 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,796 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,796 - INFO - SynoClim:237 -   Station 'ABALESSA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,797 - INFO - SynoClim:266 -   Station 'COLO' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,797 - INFO - SynoClim:237 -   Station 'IN-AMGUEL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,798 - INFO - SynoClim:237 -   Station 'IDELES' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,799 - INFO - SynoClim:266 -   Station 'TESSALA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,800 - INFO - SynoClim:237 -   Station 'SILET' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,801 - INFO - SynoClim:237 -   Station 'TAZROUK' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,802 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,802 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,803 - INFO - SynoClim:237 -   Station 'AIN-ABID' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,804 - INFO - SynoClim:266 -   Station 'FERDJIOUA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,805 - INFO - SynoClim:237 -   Station 'ETAC' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,805 - INFO - SynoClim:266 -   Station 'BENI-HAROUN' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,807 - INFO - SynoClim:237 -   Station 'MOSTAGANEM-CLIM' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,810 - INFO - SynoClim:266 -   Station 'AIN-TEMOUCHENT' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,811 - INFO - SynoClim:237 -   Station 'MASCARA-MATEMORE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,812 - INFO - SynoClim:266 -   Station 'EL-MATMAR' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,813 - INFO - SynoClim:237 -   Station 'HASSI-ABDELLAH' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,814 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,816 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,817 - INFO - SynoClim:237 -   Station 'ORAN-TAFARAOUI' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,817 - INFO - SynoClim:266 -   Station 'TIMIAOUINE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,818 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,819 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,819 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,821 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,822 - INFO - SynoClim:237 -   Station 'RHOURD NOUSS' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,823 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,824 - INFO - SynoClim:266 -   Station 'IN-GHAR' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,825 - INFO - SynoClim:237 -   Station 'RAS-EL-OUED' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,827 - INFO - SynoClim:266 -   Station 'TINZAOUATENE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,827 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,828 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,828 - INFO - SynoClim:237 -   Station 'EL-KALA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,830 - INFO - SynoClim:237 -   Station 'TISSEMSILT' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,831 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,832 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,833 - INFO - SynoClim:266 -   Station 'IHERIR' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,834 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,835 - INFO - SynoClim:237 -   Station 'GOURAYA' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,836 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,837 - INFO - SynoClim:266 -   Station 'HASSI-EL-FHAL' not found in any data source. Marked as missing ('/').
2025-08-16 09:20:04,837 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 76
2025-08-16 09:20:04,837 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025160600.xlsx
2025-08-16 09:20:04,860 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025160600.xlsx
2025-08-16 09:20:04,860 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250816.txt
2025-08-16 09:20:04,860 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250816.txt
2025-08-16 09:20:04,860 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-16 09:20:04,873 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-16 09:20:04,873 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-16 09:20:04,873 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-16 09:20:04,873 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 15 Août 2025 à 06h au 16 Août 2025 à 06h.'
2025-08-16 09:20:04,873 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-16 09:20:04,874 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-16 09:20:06,330 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-16 09:20:06,330 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08160600.docx
2025-08-16 09:20:06,342 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08160600.docx
2025-08-16 09:20:06,342 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-16 09:20:06,437 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-16 09:20:06,437 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-16 09:20:06,437 - INFO - Bulletin:195 - Restored CWD after script execution to /home/aoumeur.
2025-08-16 09:20:06,437 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-16 09:20:06,437 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-16 09:20:06,438 - INFO - file_operations:98 - Moved '20250816.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-16 09:20:06,438 - INFO - file_operations:98 - Moved 'Synop20250816-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-16 09:20:06,438 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-16 09:20:06,438 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-16 09:20:06,438 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-16 09:20:06,438 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/16.
2025-08-16 09:20:06,438 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-16 09:20:06,438 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/16 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/16.
2025-08-16 09:20:06,439 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/16' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/16'.
2025-08-16 09:20:06,439 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/16' exists. Removing it before copying.
2025-08-16 09:20:06,442 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/16' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/16'.
2025-08-16 09:20:06,442 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-16 09:20:06,442 - INFO - Bulletin:251 - Script finished.
2025-08-17 09:20:01,783 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-17 09:20:01,783 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-17 09:20:01,783 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-17 09:20:01,783 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-17 09:20:01,783 - INFO - Bulletin:69 - Current Day (DD): 17
2025-08-17 09:20:01,783 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:01,783 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-17 09:20:01,783 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-17 09:20:01,783 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-17 09:20:01,783 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:01,783 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-17.csv.
2025-08-17 09:20:01,783 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-17 09:20:01,783 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-17 09:20:01,796 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-17 09:20:01,797 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-17 09:20:01,797 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-17.csv'
2025-08-17 09:20:01,797 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:03,272 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-17 09:20:03,272 - INFO - fetchdata:118 - Downloading exported_data_2025-08-17.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-17.csv
2025-08-17 09:20:03,277 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-17.csv
2025-08-17 09:20:03,278 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-17 09:20:03,279 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-17.csv successful.
2025-08-17 09:20:03,279 - INFO - Bulletin:120 - Moved exported_data_2025-08-17.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-17 09:20:03,280 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508170600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-17 09:20:03,281 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-17 09:20:03,281 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-17 09:20:03,281 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-17 09:20:03,281 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-17 09:20:03,281 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 17 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-17 09:20:03,814 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=17, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:03,820 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-17.csv
2025-08-17 09:20:03,826 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-17 09:20:03,837 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-17.xlsx
2025-08-17 09:20:03,837 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-17 09:20:03,919 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-17 09:20:03,920 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-17 09:20:03,920 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-17 09:20:03,920 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 17 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-17 09:20:04,516 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=17, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:04,516 - INFO - Synop24h:75 - Constructed file paths:
2025-08-17 09:20:04,516 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr
2025-08-17 09:20:04,516 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-17 09:20:04,516 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-17 09:20:04,516 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08170600.xlsx
2025-08-17 09:20:04,517 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08170600.xlsx
2025-08-17 09:20:04,517 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-17 09:20:04,517 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08170600.docx
2025-08-17 09:20:04,517 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-17 09:20:04,517 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250817-06.txt
2025-08-17 09:20:04,517 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-17 09:20:04,517 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-17 09:20:04,517 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-17 09:20:04,517 - INFO - Synop24h:113 - Today's date: 2025-08-17
2025-08-17 09:20:04,517 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-17 09:20:04,518 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-17 09:20:04,712 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr. DataFrame shape: (188, 3)
2025-08-17 09:20:04,712 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-17 09:20:04,713 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 94
2025-08-17 09:20:04,715 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (94, 2)
2025-08-17 09:20:04,715 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-17 09:20:04,715 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-17 09:20:04,737 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-17 09:20:04,737 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-17 09:20:04,739 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,749 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,750 - WARNING - Synop24h:206 - Row 13: Station 'Rhoud-Nouss' (RHOURD NOUSS) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,752 - WARNING - Synop24h:206 - Row 15: Station 'Tiaret' (TIARET) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,778 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08170600.xlsx
2025-08-17 09:20:04,778 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250817-06.txt. Total unique missing stations: 4
2025-08-17 09:20:04,778 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-17 09:20:04,778 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-17 09:20:04,778 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-17 09:20:04,911 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 17 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-17 09:20:04,911 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:20:04,516 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=17, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:04,516 - INFO - Synop24h:75 - Constructed file paths:
2025-08-17 09:20:04,516 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr
2025-08-17 09:20:04,516 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-17 09:20:04,516 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-17 09:20:04,516 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08170600.xlsx
2025-08-17 09:20:04,517 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08170600.xlsx
2025-08-17 09:20:04,517 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-17 09:20:04,517 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08170600.docx
2025-08-17 09:20:04,517 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-17 09:20:04,517 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250817-06.txt
2025-08-17 09:20:04,517 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-17 09:20:04,517 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-17 09:20:04,517 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-17 09:20:04,517 - INFO - Synop24h:113 - Today's date: 2025-08-17
2025-08-17 09:20:04,517 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-17 09:20:04,518 - INFO - data_utils:320 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-17 09:20:04,712 - INFO - data_utils:329 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr. DataFrame shape: (188, 3)
2025-08-17 09:20:04,712 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-17 09:20:04,713 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 94
2025-08-17 09:20:04,715 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (94, 2)
2025-08-17 09:20:04,715 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-17 09:20:04,715 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-17 09:20:04,737 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-17 09:20:04,737 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-17 09:20:04,739 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,749 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,750 - WARNING - Synop24h:206 - Row 13: Station 'Rhoud-Nouss' (RHOURD NOUSS) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,752 - WARNING - Synop24h:206 - Row 15: Station 'Tiaret' (TIARET) not found in BUFR data. Marked as missing.
2025-08-17 09:20:04,778 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08170600.xlsx
2025-08-17 09:20:04,778 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250817-06.txt. Total unique missing stations: 4
2025-08-17 09:20:04,778 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-17 09:20:04,778 - CRITICAL - data_utils:288 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-17 09:20:04,778 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-17 09:20:04,911 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:20:04,911 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '17', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '17', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-17 09:20:04,912 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-17 09:20:04,912 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 17 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-17 09:20:05,619 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=17, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-17 09:20:05,619 - INFO - SynoClim:74 - Configured file paths:
2025-08-17 09:20:05,619 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr
2025-08-17 09:20:05,619 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-17 09:20:05,619 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025170600.xlsx
2025-08-17 09:20:05,619 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-17 09:20:05,619 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08170600.docx
2025-08-17 09:20:05,619 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250817.txt
2025-08-17 09:20:05,619 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-17 09:20:05,619 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-17.xlsx
2025-08-17 09:20:05,619 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-17 09:20:05,620 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508170600.bufr
2025-08-17 09:20:05,816 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (188, 3)
2025-08-17 09:20:05,821 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-17 09:20:05,821 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-17 09:20:05,822 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (94, 3)
2025-08-17 09:20:05,826 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-17 09:20:05,827 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (94, 3)
2025-08-17 09:20:05,828 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-17 09:20:05,828 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-17 09:20:05,917 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-17 09:20:05,917 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-17 09:20:05,917 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-17 09:20:05,918 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-17 09:20:05,918 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-17.xlsx. Attempting to load.
2025-08-17 09:20:05,928 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-17 09:20:05,929 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-17 09:20:05,931 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,932 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,933 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,934 - INFO - SynoClim:266 -   Station 'TIARET' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,935 - INFO - SynoClim:266 -   Station 'AIN-DHEB' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,936 - INFO - SynoClim:237 -   Station 'TADJMOUT' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,937 - INFO - SynoClim:266 -   Station 'SIDI-EL-ABED' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,938 - INFO - SynoClim:266 -   Station 'ZMALET' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,939 - INFO - SynoClim:237 -   Station 'AIN-MLILA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,940 - INFO - SynoClim:266 -   Station 'YAKOUREN' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,941 - INFO - SynoClim:237 -   Station 'BATNA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,943 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,945 - INFO - SynoClim:237 -   Station 'FOUGHALA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,946 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,947 - INFO - SynoClim:237 -   Station 'ABADLA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,947 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,949 - INFO - SynoClim:237 -   Station 'MOUGHEL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,949 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,950 - INFO - SynoClim:237 -   Station 'CHREA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,951 - INFO - SynoClim:237 -   Station 'ENSH' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,952 - INFO - SynoClim:266 -   Station 'AIN-EL-BELL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,952 - INFO - SynoClim:266 -   Station 'AIN-OUSSARA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,954 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,955 - INFO - SynoClim:266 -   Station 'AIN-OULMAN' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,956 - INFO - SynoClim:266 -   Station 'MEGRES' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,957 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,957 - INFO - SynoClim:266 -   Station 'BENI-AZIZ' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,958 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,959 - INFO - SynoClim:266 -   Station 'OUM-LADJOUL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,959 - INFO - SynoClim:237 -   Station 'TINTARABINE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,960 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,961 - INFO - SynoClim:266 -   Station 'AIN-SKOUNA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,962 - INFO - SynoClim:266 -   Station 'SAIDA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,963 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,964 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,964 - INFO - SynoClim:237 -   Station 'ABALESSA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,965 - INFO - SynoClim:266 -   Station 'COLO' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,965 - INFO - SynoClim:237 -   Station 'IN-AMGUEL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,966 - INFO - SynoClim:237 -   Station 'IDELES' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,967 - INFO - SynoClim:266 -   Station 'TESSALA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,968 - INFO - SynoClim:237 -   Station 'SILET' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,968 - INFO - SynoClim:237 -   Station 'TAZROUK' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,969 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,970 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,971 - INFO - SynoClim:237 -   Station 'AIN-ABID' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,972 - INFO - SynoClim:266 -   Station 'FERDJIOUA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,973 - INFO - SynoClim:237 -   Station 'ETAC' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,973 - INFO - SynoClim:266 -   Station 'BENI-HAROUN' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,975 - INFO - SynoClim:237 -   Station 'MOSTAGANEM-CLIM' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,978 - INFO - SynoClim:266 -   Station 'AIN-TEMOUCHENT' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,979 - INFO - SynoClim:237 -   Station 'MASCARA-MATEMORE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,981 - INFO - SynoClim:266 -   Station 'EL-MATMAR' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,981 - INFO - SynoClim:237 -   Station 'HASSI-ABDELLAH' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,982 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,984 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,985 - INFO - SynoClim:266 -   Station 'TIMIAOUINE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,986 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,987 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,987 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,989 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,990 - INFO - SynoClim:237 -   Station 'RHOURD NOUSS' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,991 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,991 - INFO - SynoClim:266 -   Station 'IN-GHAR' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,992 - INFO - SynoClim:237 -   Station 'RAS-EL-OUED' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,994 - INFO - SynoClim:266 -   Station 'TINZAOUATENE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,995 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,995 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,996 - INFO - SynoClim:237 -   Station 'EL-KALA-CLIM' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,997 - INFO - SynoClim:237 -   Station 'TISSEMSILT' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:05,999 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,000 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,001 - INFO - SynoClim:266 -   Station 'IHERIR' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,002 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,002 - INFO - SynoClim:237 -   Station 'GOURAYA' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,003 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,004 - INFO - SynoClim:266 -   Station 'HASSI-EL-FHAL' not found in any data source. Marked as missing ('/').
2025-08-17 09:20:06,004 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 76
2025-08-17 09:20:06,004 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025170600.xlsx
2025-08-17 09:20:06,028 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025170600.xlsx
2025-08-17 09:20:06,028 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250817.txt
2025-08-17 09:20:06,028 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250817.txt
2025-08-17 09:20:06,029 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-17 09:20:06,041 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-17 09:20:06,041 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-17 09:20:06,041 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-17 09:20:06,041 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 16 Août 2025 à 06h au 17 Août 2025 à 06h.'
2025-08-17 09:20:06,042 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-17 09:20:06,043 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-17 09:20:07,607 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-17 09:20:07,607 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08170600.docx
2025-08-17 09:20:07,619 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08170600.docx
2025-08-17 09:20:07,619 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-17 09:20:07,719 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-17 09:20:07,719 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-17 09:20:07,720 - INFO - Bulletin:195 - Restored CWD after script execution to /home/aoumeur.
2025-08-17 09:20:07,720 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-17 09:20:07,720 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-17 09:20:07,720 - INFO - file_operations:98 - Moved 'Synop20250817-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-17 09:20:07,720 - INFO - file_operations:98 - Moved '20250817.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-17 09:20:07,720 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-17 09:20:07,720 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-17 09:20:07,720 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-17 09:20:07,720 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/17.
2025-08-17 09:20:07,720 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-17 09:20:07,721 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/17 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/17.
2025-08-17 09:20:07,721 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/17' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/17'.
2025-08-17 09:20:07,721 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/17' exists. Removing it before copying.
2025-08-17 09:20:07,724 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/17' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/17'.
2025-08-17 09:20:07,724 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-17 09:20:07,724 - INFO - Bulletin:251 - Script finished.
2025-08-18 09:17:20,320 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 09:17:20,335 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 09:17:20,335 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 09:17:20,335 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 09:17:20,335 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 09:17:20,335 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:17:20,336 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 09:17:20,336 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 09:17:20,336 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 09:17:20,336 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:17:20,336 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 09:17:20,336 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 09:17:20,336 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 09:17:32,449 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:17:32,449 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:17:32,449 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:17:32,474 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 09:17:32,475 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 09:17:32,475 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 09:17:32,476 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 09:17:32,476 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 09:17:32,476 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 09:17:32,477 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 09:17:32,477 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 09:17:32,477 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:17:32,477 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:17:32,478 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 09:17:32,478 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:17:32,478 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 09:17:32,478 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:17:32,478 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:17:32,478 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 09:17:32,512 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:17:32,512 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 09:17:32,513 - INFO - Bulletin:251 - Script finished.
2025-08-18 09:20:01,284 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 09:20:01,296 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 09:20:01,296 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 09:20:01,296 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 09:20:01,296 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 09:20:01,296 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:20:01,296 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 09:20:01,296 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 09:20:01,296 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 09:20:01,296 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:20:01,297 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 09:20:01,297 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 09:20:01,297 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 09:20:13,409 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:20:13,410 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:20:13,410 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:20:13,413 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 09:20:13,414 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 09:20:13,414 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 09:20:13,414 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 09:20:13,414 - INFO - Bulletin:195 - Restored CWD after script execution to /home/aoumeur.
2025-08-18 09:20:13,414 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 09:20:13,414 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 09:20:13,415 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 09:20:13,415 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 09:20:13,415 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:20:13,415 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:20:13,415 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 09:20:13,415 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:20:13,415 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 09:20:13,415 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:20:13,416 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:20:13,416 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 09:20:13,419 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:20:13,419 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 09:20:13,419 - INFO - Bulletin:251 - Script finished.
2025-08-18 09:21:21,508 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 09:21:21,508 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 09:21:21,508 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 09:21:21,508 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 09:21:21,508 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 09:21:21,508 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:21:21,508 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 09:21:21,508 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 09:21:21,508 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 09:21:21,508 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 09:21:21,509 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 09:21:21,509 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 09:21:21,509 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 09:21:33,603 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:21:33,603 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:21:33,604 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 09:21:33,607 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 09:21:33,608 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 09:21:33,608 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 09:21:33,608 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 09:21:33,608 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 09:21:33,608 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 09:21:33,609 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 09:21:33,609 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 09:21:33,609 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:21:33,609 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 09:21:33,609 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 09:21:33,609 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:21:33,609 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 09:21:33,609 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 09:21:33,609 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:21:33,610 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 09:21:33,613 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 09:21:33,613 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 09:21:33,613 - INFO - Bulletin:251 - Script finished.
2025-08-18 11:32:58,768 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 11:32:58,768 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 11:32:58,768 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 11:32:58,768 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 11:32:58,768 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 11:32:58,768 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:32:58,768 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 11:32:58,768 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 11:32:58,768 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 11:32:58,768 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:32:58,768 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 11:32:58,768 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 11:32:58,768 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 11:32:58,899 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 11:32:58,900 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 11:32:58,901 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 11:32:58,901 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:33:00,039 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 11:33:00,039 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 11:33:00,057 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 11:33:00,058 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 11:33:00,059 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 11:33:00,059 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 11:33:00,060 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 11:33:00,061 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 11:33:00,062 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 11:33:00,062 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 11:33:00,062 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 11:33:00,062 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:33:00,528 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:33:00,532 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 11:33:00,537 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 11:33:00,549 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:33:00,549 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 11:33:00,614 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:33:00,614 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 11:33:00,614 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 11:33:00,614 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:33:01,208 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:33:01,208 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 11:33:01,209 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:33:01,209 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 11:33:01,209 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:33:01,209 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 11:33:01,209 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 11:33:01,209 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:33:01,209 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 11:33:01,209 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 11:33:01,210 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 11:33:01,210 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 11:33:01,211 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 11:33:01,369 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 11:33:01,370 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 11:33:01,370 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 11:33:01,372 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 11:33:01,372 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 11:33:01,373 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:33:01,398 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 11:33:01,398 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 11:33:01,399 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 11:33:01,409 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 11:33:01,439 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:33:01,439 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 11:33:01,439 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:33:01,439 - CRITICAL - data_utils:287 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-18 11:33:01,439 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-18 11:33:01,528 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-18 11:33:01,528 - ERROR - system_utils:58 - STDOUT: 2025-08-18 11:33:01,208 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:33:01,208 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 11:33:01,209 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:33:01,209 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:33:01,209 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 11:33:01,209 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:33:01,209 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 11:33:01,209 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 11:33:01,209 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:33:01,209 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 11:33:01,209 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 11:33:01,210 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 11:33:01,210 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 11:33:01,211 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 11:33:01,369 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 11:33:01,370 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 11:33:01,370 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 11:33:01,372 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 11:33:01,372 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 11:33:01,373 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:33:01,398 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 11:33:01,398 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 11:33:01,399 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 11:33:01,409 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 11:33:01,439 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:33:01,439 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 11:33:01,439 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:33:01,439 - CRITICAL - data_utils:287 - Error: Excel file not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Please ensure the file exists.
2025-08-18 11:33:01,439 - CRITICAL - Synop24h:248 - Cumulative precipitation Excel template not found at /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx. Exiting script.
2025-08-18 11:33:01,529 - ERROR - system_utils:59 - STDERR: 
2025-08-18 11:33:01,529 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-18 11:33:01,529 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 11:33:01,529 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:33:02,139 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:33:02,139 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 11:33:02,139 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:33:02,139 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:33:02,139 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:33:02,139 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:33:02,139 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:33:02,139 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:33:02,139 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:33:02,139 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:33:02,140 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:33:02,140 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:33:02,301 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 11:33:02,306 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 11:33:02,307 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 11:33:02,307 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 11:33:02,312 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 11:33:02,314 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 11:33:02,314 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:33:02,314 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:33:02,414 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 11:33:02,414 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 11:33:02,414 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:33:02,414 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 11:33:02,414 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 11:33:02,428 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 11:33:02,431 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 11:33:02,433 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,434 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,435 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,445 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,446 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,447 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,447 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,448 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,450 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,451 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,452 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,453 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,455 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,459 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,463 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,464 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,466 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,468 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,469 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,470 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,471 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,477 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,478 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,491 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,492 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,494 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,495 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,496 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,497 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,499 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,502 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,504 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,505 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,508 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,509 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,510 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,512 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,514 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 11:33:02,515 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 11:33:02,515 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:33:02,542 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:33:02,542 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:33:02,542 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:33:02,543 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:33:02,556 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 11:33:02,557 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 11:33:02,557 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 11:33:02,557 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 11:33:02,557 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 11:33:02,558 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 11:33:04,184 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 11:33:04,185 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:33:04,198 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:33:04,198 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 11:33:04,293 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:33:04,294 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 11:33:04,294 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 11:33:04,294 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 11:33:04,294 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:33:04,294 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:33:04,295 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:33:04,295 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:33:04,295 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 11:33:04,295 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:33:04,295 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 11:33:04,295 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:33:04,295 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:33:04,295 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 11:33:04,299 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:33:04,299 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 11:33:04,299 - INFO - Bulletin:251 - Script finished.
2025-08-18 11:46:05,196 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 11:46:05,196 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 11:46:05,196 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 11:46:05,196 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 11:46:05,196 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 11:46:05,196 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:05,196 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 11:46:05,196 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 11:46:05,196 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 11:46:05,196 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:05,196 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 11:46:05,196 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 11:46:05,196 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 11:46:05,200 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 11:46:05,201 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 11:46:05,201 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 11:46:05,201 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:05,245 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 11:46:05,245 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 11:46:05,263 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 11:46:05,265 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 11:46:05,265 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 11:46:05,266 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 11:46:05,267 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 11:46:05,268 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 11:46:05,268 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 11:46:05,268 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 11:46:05,268 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 11:46:05,268 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:46:05,750 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:05,753 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 11:46:05,759 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 11:46:05,771 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:46:05,771 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 11:46:05,838 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:46:05,838 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 11:46:05,838 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 11:46:05,838 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:46:06,413 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:06,413 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 11:46:06,413 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:46:06,413 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:46:06,414 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:46:06,414 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:46:06,414 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:46:06,414 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 11:46:06,414 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:46:06,414 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 11:46:06,414 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 11:46:06,414 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:46:06,414 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 11:46:06,414 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 11:46:06,414 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 11:46:06,414 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 11:46:06,415 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 11:46:06,569 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 11:46:06,570 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 11:46:06,570 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 11:46:06,572 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 11:46:06,572 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 11:46:06,572 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:46:06,595 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 11:46:06,595 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 11:46:06,597 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 11:46:06,605 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 11:46:06,633 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:46:06,633 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 11:46:06,634 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:46:06,654 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-18 11:46:06,654 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-08-18 11:46:06,656 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 11:46:06,664 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 11:46:06,691 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:46:06,691 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:46:06,712 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 11:46:06,712 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:46:06,733 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 11:46:06,733 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-18 11:46:06,743 - INFO - Synop24h:347 - Word template loaded successfully.
2025-08-18 11:46:06,743 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-18 11:46:06,743 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 11:46:06,743 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 11:46:06,743 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 18 Août 2025'
2025-08-18 11:46:06,744 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-08-18 11:46:06,745 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-08-18 11:46:06,745 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-18 11:46:06,931 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 11:46:06,945 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-08-18 11:46:06,945 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-18 11:46:07,140 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 11:46:07,155 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-08-18 11:46:07,170 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:46:07,170 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-08-18 11:46:07,283 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:46:07,284 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-08-18 11:46:07,284 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 11:46:07,284 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:46:07,902 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:46:07,902 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 11:46:07,902 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:46:07,902 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:46:07,902 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:46:07,902 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:46:07,902 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:46:07,902 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:46:07,903 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:46:07,903 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:46:07,903 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:46:07,903 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:46:08,053 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 11:46:08,058 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 11:46:08,058 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 11:46:08,059 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 11:46:08,063 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 11:46:08,064 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 11:46:08,064 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:46:08,064 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:46:08,152 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 11:46:08,152 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 11:46:08,152 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:46:08,152 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 11:46:08,152 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 11:46:08,165 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 11:46:08,169 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 11:46:08,170 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,171 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,172 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,181 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,182 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,183 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,184 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,185 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,186 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,187 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,188 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,189 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,191 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,195 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,198 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,199 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,202 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,203 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,204 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,205 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,206 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,212 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,212 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,224 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,226 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,228 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,228 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,229 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,231 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,232 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,235 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,237 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,237 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,240 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,241 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,242 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,244 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,246 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 11:46:08,247 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 11:46:08,247 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:46:08,271 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:46:08,271 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:46:08,271 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:46:08,271 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:46:08,284 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 11:46:08,284 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 11:46:08,284 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 11:46:08,284 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 11:46:08,284 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 11:46:08,286 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 11:46:09,693 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 11:46:09,693 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:46:09,705 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:46:09,705 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 11:46:09,800 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:46:09,800 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 11:46:09,801 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 11:46:09,801 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 11:46:09,801 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:46:09,801 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:46:09,801 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:46:09,802 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:46:09,802 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 11:46:09,802 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:46:09,802 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 11:46:09,802 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:46:09,802 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:46:09,802 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 11:46:09,806 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:46:09,806 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 11:46:09,806 - INFO - Bulletin:251 - Script finished.
2025-08-18 11:49:52,171 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 11:49:52,171 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 11:49:52,171 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 11:49:52,171 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 11:49:52,171 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 11:49:52,171 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:52,171 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 11:49:52,171 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 11:49:52,171 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 11:49:52,171 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:52,171 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 11:49:52,171 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 11:49:52,171 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 11:49:52,175 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 11:49:52,176 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 11:49:52,176 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 11:49:52,176 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:52,180 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 11:49:52,180 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 11:49:52,183 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 11:49:52,184 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 11:49:52,184 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 11:49:52,184 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 11:49:52,185 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 11:49:52,185 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 11:49:52,185 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 11:49:52,185 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 11:49:52,185 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 11:49:52,185 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:49:52,601 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:52,604 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 11:49:52,609 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 11:49:52,621 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:49:52,621 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 11:49:52,686 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:49:52,687 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 11:49:52,687 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 11:49:52,687 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:49:53,250 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:53,251 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 11:49:53,251 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:49:53,251 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:49:53,251 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:49:53,251 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:49:53,252 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:49:53,252 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 11:49:53,252 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:49:53,252 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 11:49:53,252 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 11:49:53,252 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:49:53,252 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 11:49:53,252 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 11:49:53,252 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 11:49:53,252 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 11:49:53,253 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 11:49:53,403 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 11:49:53,404 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 11:49:53,405 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 11:49:53,406 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 11:49:53,407 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 11:49:53,407 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 11:49:53,429 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 11:49:53,429 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 11:49:53,431 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 11:49:53,439 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 11:49:53,466 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:49:53,467 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 11:49:53,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 11:49:53,487 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-18 11:49:53,487 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-08-18 11:49:53,489 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 11:49:53,497 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 11:49:53,524 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:49:53,524 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 11:49:53,545 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 11:49:53,545 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 11:49:53,566 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 11:49:53,567 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-18 11:49:53,576 - INFO - Synop24h:347 - Word template loaded successfully.
2025-08-18 11:49:53,576 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-18 11:49:53,577 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 11:49:53,577 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 11:49:53,577 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 18 Août 2025'
2025-08-18 11:49:53,578 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-08-18 11:49:53,579 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-08-18 11:49:53,579 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-18 11:49:53,755 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 11:49:53,769 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-08-18 11:49:53,769 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-18 11:49:53,947 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 11:49:53,961 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-08-18 11:49:53,975 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 11:49:53,975 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-08-18 11:49:54,070 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:49:54,071 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-08-18 11:49:54,071 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 11:49:54,071 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:49:54,674 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:54,674 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 11:49:54,674 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:49:54,674 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:49:54,674 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:49:54,674 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:49:54,674 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:49:54,675 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:49:54,675 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:49:54,675 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 11:49:54,675 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 11:49:54,676 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 11:49:54,834 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 11:49:54,839 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 11:49:54,840 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 11:49:54,840 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 11:49:54,845 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 11:49:54,846 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 11:49:54,846 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:49:54,847 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 11:49:54,946 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 11:49:54,946 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 11:49:54,947 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 11:49:54,947 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 11:49:54,947 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 11:49:54,960 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 11:49:54,964 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 11:49:54,966 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,967 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,968 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,977 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,978 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,979 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,980 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,981 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,982 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,983 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,985 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,986 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,987 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,992 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,995 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,996 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:54,999 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,000 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,001 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,002 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,003 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,009 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,010 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,023 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,025 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,027 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,027 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,028 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,030 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,032 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,035 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,036 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,037 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,040 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,041 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,042 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,044 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,046 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 11:49:55,047 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 11:49:55,047 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:49:55,074 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 11:49:55,074 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:49:55,075 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 11:49:55,075 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 11:49:55,088 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 11:49:55,089 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 11:49:55,089 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 11:49:55,089 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 11:49:55,089 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 11:49:55,090 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 11:49:56,520 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 11:49:56,521 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:49:56,532 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 11:49:56,532 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 11:49:56,628 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 11:49:56,628 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 11:49:56,628 - INFO - Bulletin:171 - Executing python3 send_MSG.py...
2025-08-18 11:49:56,629 - INFO - system_utils:36 - Executing command: python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 11:49:56,708 - ERROR - system_utils:57 - Command 'python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h' failed with exit code 2.
2025-08-18 11:49:56,708 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 11:49:56,708 - ERROR - system_utils:59 - STDERR: usage: send_MSG.py [-h] [--shared-log-file SHARED_LOG_FILE]
send_MSG.py: error: unrecognized arguments: 2025 08 18 /home/aoumeur/bqrm/BQCP24h
2025-08-18 11:49:56,708 - ERROR - Bulletin:187 - Error executing send_MSG.py: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
2025-08-18 11:49:56,709 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 11:49:56,709 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 11:49:56,709 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:49:56,710 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 11:49:56,710 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:49:56,710 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 11:49:56,710 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 11:49:56,710 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:49:56,710 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 11:49:56,710 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 11:49:56,710 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:49:56,710 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 11:49:56,714 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 11:49:56,714 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 11:49:56,714 - INFO - Bulletin:251 - Script finished.
2025-08-18 13:38:38,979 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 13:38:38,979 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 13:38:38,979 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 13:38:38,980 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 13:38:38,980 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 13:38:38,980 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:38:38,980 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 13:38:38,980 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 13:38:38,980 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 13:38:38,980 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:38:38,980 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 13:38:38,980 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 13:38:38,980 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 13:39:09,010 - ERROR - fetchdata:21 - Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-18 13:39:09,010 - ERROR - fetchdata:124 - An error occurred during FTP transfer: Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-18 13:39:09,010 - ERROR - Bulletin:126 - An error occurred during FTP operations: Failed to connect to FTP server 10.16.80.222. Error: timed out
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
TimeoutError: timed out

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 22, in create_ftp_client
    raise ConnectionError(f"Failed to connect to FTP server {host}. Error: {e}")
ConnectionError: Failed to connect to FTP server 10.16.80.222. Error: timed out
2025-08-18 13:39:09,013 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 13:39:09,014 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 13:39:09,014 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 13:39:09,014 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 13:39:09,015 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 13:39:09,015 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 13:39:09,015 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 13:39:09,015 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 13:39:09,015 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:39:09,015 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:39:09,015 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 13:39:09,015 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:39:09,016 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 13:39:09,016 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:39:09,016 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:39:09,016 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 13:39:09,019 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:39:09,019 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 13:39:09,019 - INFO - Bulletin:251 - Script finished.
2025-08-18 13:52:23,812 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 13:52:23,812 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 13:52:23,812 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 13:52:23,812 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 13:52:23,812 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 13:52:23,812 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:52:23,812 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 13:52:23,812 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 13:52:23,812 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 13:52:23,812 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:52:23,812 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 13:52:23,812 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 13:52:23,812 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 13:52:35,905 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:52:35,906 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:52:35,906 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:52:35,909 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 13:52:35,910 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 13:52:35,910 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 13:52:35,910 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 13:52:35,910 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 13:52:35,910 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 13:52:35,911 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 13:52:35,911 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 13:52:35,911 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:52:35,911 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:52:35,911 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 13:52:35,911 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:52:35,911 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 13:52:35,911 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:52:35,911 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:52:35,911 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 13:52:35,915 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:52:35,915 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 13:52:35,915 - INFO - Bulletin:251 - Script finished.
2025-08-18 13:53:18,216 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 13:53:18,216 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 13:53:18,216 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 13:53:18,216 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 13:53:18,216 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 13:53:18,216 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:53:18,216 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 13:53:18,217 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 13:53:18,217 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 13:53:18,217 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 13:53:18,217 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 13:53:18,217 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 13:53:18,217 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 13:53:30,306 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:53:30,306 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:53:30,306 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 13:53:30,309 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 13:53:30,310 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 13:53:30,310 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 13:53:30,311 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 13:53:30,311 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 13:53:30,311 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 13:53:30,311 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 13:53:30,311 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 13:53:30,311 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:53:30,311 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 13:53:30,311 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 13:53:30,311 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:53:30,311 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 13:53:30,311 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 13:53:30,312 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:53:30,312 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 13:53:30,315 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 13:53:30,315 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 13:53:30,315 - INFO - Bulletin:251 - Script finished.
2025-08-18 14:01:35,788 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 14:01:35,788 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 14:01:35,788 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 14:01:35,788 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 14:01:35,788 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 14:01:35,788 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:01:35,789 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 14:01:35,789 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 14:01:35,789 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 14:01:35,789 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:01:35,789 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 14:01:35,789 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 14:01:35,789 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 14:01:47,876 - ERROR - fetchdata:24 - FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 14:01:47,876 - ERROR - fetchdata:124 - An error occurred during FTP transfer: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 14:01:47,876 - ERROR - Bulletin:126 - An error occurred during FTP operations: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
Traceback (most recent call last):
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 16, in create_ftp_client
    ftp.connect(host, port, timeout=30) # Add a timeout
  File "/usr/lib/python3.10/ftplib.py", line 158, in connect
    self.sock = socket.create_connection((self.host, self.port), self.timeout,
  File "/usr/lib/python3.10/socket.py", line 857, in create_connection
    raise err
  File "/usr/lib/python3.10/socket.py", line 845, in create_connection
    sock.connect(sa)
OSError: [Errno 113] No route to host

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 102, in main
    fetch_files(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 79, in fetch_files
    ftp = create_ftp_client(host=host, username=username, password=password)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/fetchdata.py", line 25, in create_ftp_client
    raise ConnectionError(f"FTP login failed for {username} on {host}. Error: {e}")
ConnectionError: FTP login failed for admin on 10.16.80.222. Error: [Errno 113] No route to host
2025-08-18 14:01:47,879 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 14:01:47,880 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 14:01:47,881 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 14:01:47,881 - ERROR - Bulletin:189 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-18 14:01:47,881 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 14:01:47,881 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 14:01:47,881 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 14:01:47,881 - INFO - Bulletin:207 - No *.txt files found to move or all failed.
2025-08-18 14:01:47,881 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:01:47,881 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:01:47,881 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 14:01:47,882 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:01:47,882 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 14:01:47,882 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:01:47,882 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:01:47,882 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 14:01:47,886 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:01:47,886 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 14:01:47,886 - INFO - Bulletin:251 - Script finished.
2025-08-18 14:47:08,902 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 14:47:08,903 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 14:47:08,903 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 14:47:08,903 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 14:47:08,903 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 14:47:08,903 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:08,903 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 14:47:08,903 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 14:47:08,903 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 14:47:08,903 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:08,903 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 14:47:08,903 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 14:47:08,903 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 14:47:09,227 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 14:47:09,228 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 14:47:09,228 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 14:47:09,228 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:10,663 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 14:47:10,664 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 14:47:10,707 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 14:47:10,709 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 14:47:10,709 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 14:47:10,710 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 14:47:10,711 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 14:47:10,712 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 14:47:10,712 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 14:47:10,712 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 14:47:10,712 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 14:47:10,712 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:47:11,246 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:11,249 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 14:47:11,253 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 14:47:11,267 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 14:47:11,267 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 14:47:11,336 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:47:11,336 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 14:47:11,336 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 14:47:11,336 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:47:11,947 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:11,947 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 14:47:11,947 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:47:11,947 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 14:47:11,948 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 14:47:11,948 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:47:11,948 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:47:11,948 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 14:47:11,948 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 14:47:11,948 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 14:47:11,948 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 14:47:11,948 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 14:47:11,948 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 14:47:11,948 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 14:47:11,948 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 14:47:11,948 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 14:47:11,949 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 14:47:12,109 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 14:47:12,110 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 14:47:12,111 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 14:47:12,112 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 14:47:12,113 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 14:47:12,113 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 14:47:12,135 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 14:47:12,135 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 14:47:12,137 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 14:47:12,145 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 14:47:12,172 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:47:12,172 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 14:47:12,172 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 14:47:12,192 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-18 14:47:12,193 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-08-18 14:47:12,194 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 14:47:12,203 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 14:47:12,230 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:47:12,230 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:47:12,251 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 14:47:12,251 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:47:12,272 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 14:47:12,272 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-18 14:47:12,281 - INFO - Synop24h:347 - Word template loaded successfully.
2025-08-18 14:47:12,282 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-18 14:47:12,282 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 14:47:12,282 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 14:47:12,282 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 18 Août 2025'
2025-08-18 14:47:12,283 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-08-18 14:47:12,284 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-08-18 14:47:12,284 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-18 14:47:12,471 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 14:47:12,485 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-08-18 14:47:12,485 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-18 14:47:12,677 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 14:47:12,693 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-08-18 14:47:12,708 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 14:47:12,708 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-08-18 14:47:12,835 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:47:12,835 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-08-18 14:47:12,835 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 14:47:12,835 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:47:13,447 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:13,448 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 14:47:13,448 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:47:13,448 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:47:13,448 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:47:13,448 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 14:47:13,448 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:47:13,448 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:47:13,448 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 14:47:13,448 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 14:47:13,448 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 14:47:13,450 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:47:13,615 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 14:47:13,620 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 14:47:13,620 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 14:47:13,621 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 14:47:13,625 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 14:47:13,627 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 14:47:13,627 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:47:13,627 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:47:13,716 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 14:47:13,716 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 14:47:13,716 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 14:47:13,716 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 14:47:13,716 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 14:47:13,730 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 14:47:13,735 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 14:47:13,736 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,737 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,738 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,748 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,749 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,750 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,751 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,752 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,753 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,754 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,756 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,757 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,758 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,762 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,766 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,767 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,770 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,771 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,772 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,773 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,774 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,780 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,781 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,794 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,795 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,798 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,798 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,799 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,802 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,803 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,806 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,808 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,809 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,811 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,812 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,814 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,816 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,818 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 14:47:13,819 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 14:47:13,819 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:47:13,844 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:47:13,844 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:47:13,844 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:47:13,844 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 14:47:13,858 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 14:47:13,858 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 14:47:13,858 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 14:47:13,858 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 14:47:13,858 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 14:47:13,859 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 14:47:15,597 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 14:47:15,597 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:47:15,610 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:47:15,610 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 14:47:15,710 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:47:15,710 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 14:47:15,710 - INFO - Bulletin:171 - Executing python3 send_MSG.py...
2025-08-18 14:47:15,710 - INFO - system_utils:36 - Executing command: python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:47:15,786 - ERROR - system_utils:57 - Command 'python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h' failed with exit code 2.
2025-08-18 14:47:15,786 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 14:47:15,786 - ERROR - system_utils:59 - STDERR: usage: send_MSG.py [-h] [--shared-log-file SHARED_LOG_FILE]
send_MSG.py: error: unrecognized arguments: 2025 08 18 /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:47:15,786 - ERROR - Bulletin:187 - Error executing send_MSG.py: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
2025-08-18 14:47:15,787 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 14:47:15,787 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 14:47:15,788 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 14:47:15,788 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 14:47:15,788 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:47:15,788 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:47:15,788 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 14:47:15,788 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:47:15,788 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 14:47:15,788 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:47:15,788 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:47:15,788 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 14:47:15,792 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:47:15,792 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 14:47:15,792 - INFO - Bulletin:251 - Script finished.
2025-08-18 14:53:52,846 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 14:53:52,846 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 14:53:52,846 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 14:53:52,846 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 14:53:52,846 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 14:53:52,846 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:52,846 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 14:53:52,846 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 14:53:52,846 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 14:53:52,846 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:52,846 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 14:53:52,846 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 14:53:52,847 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 14:53:52,851 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 14:53:52,852 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 14:53:52,852 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 14:53:52,852 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:52,857 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 14:53:52,857 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 14:53:52,888 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 14:53:52,889 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 14:53:52,889 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 14:53:52,889 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 14:53:52,890 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 14:53:52,890 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 14:53:52,890 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 14:53:52,890 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 14:53:52,890 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 14:53:52,890 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:53:53,335 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:53,338 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 14:53:53,343 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 14:53:53,356 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 14:53:53,356 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 14:53:53,423 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:53:53,423 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 14:53:53,423 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 14:53:53,423 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:53:54,020 - INFO - Synop24h:61 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:54,020 - INFO - Synop24h:75 - Constructed file paths:
2025-08-18 14:53:54,021 - INFO - Synop24h:76 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:53:54,021 - INFO - Synop24h:77 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 14:53:54,021 - INFO - Synop24h:78 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 14:53:54,021 - INFO - Synop24h:79 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:53:54,021 - INFO - Synop24h:80 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:53:54,021 - INFO - Synop24h:81 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 14:53:54,021 - INFO - Synop24h:82 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 14:53:54,021 - INFO - Synop24h:83 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 14:53:54,021 - INFO - Synop24h:84 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 14:53:54,021 - INFO - Synop24h:85 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 14:53:54,021 - INFO - Synop24h:100 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 14:53:54,021 - INFO - Synop24h:103 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 14:53:54,021 - INFO - Synop24h:113 - Today's date: 2025-08-18
2025-08-18 14:53:54,022 - INFO - Synop24h:120 - Cumulative precipitation will not be reset.
2025-08-18 14:53:54,022 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 14:53:54,174 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 14:53:54,175 - INFO - Synop24h:141 - Columns renamed in DataFrame.
2025-08-18 14:53:54,175 - INFO - Synop24h:145 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 14:53:54,177 - INFO - Synop24h:153 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 14:53:54,177 - INFO - Synop24h:157 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 14:53:54,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 14:53:54,201 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 14:53:54,201 - INFO - Synop24h:185 - Updating 24-hour precipitation Excel file with data.
2025-08-18 14:53:54,202 - WARNING - Synop24h:206 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 14:53:54,211 - WARNING - Synop24h:206 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 14:53:54,238 - INFO - Synop24h:222 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:53:54,238 - INFO - Synop24h:235 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 14:53:54,238 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 14:53:54,259 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-18 14:53:54,259 - INFO - Synop24h:269 - Updating cumulative precipitation Excel file with daily data.
2025-08-18 14:53:54,261 - WARNING - Synop24h:295 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 14:53:54,271 - WARNING - Synop24h:295 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 14:53:54,301 - INFO - Synop24h:310 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:53:54,301 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 14:53:54,325 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 14:53:54,325 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 14:53:54,351 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 14:53:54,351 - INFO - Synop24h:345 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-18 14:53:54,363 - INFO - Synop24h:347 - Word template loaded successfully.
2025-08-18 14:53:54,363 - INFO - Synop24h:371 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-18 14:53:54,363 - INFO - Synop24h:374 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 14:53:54,363 - INFO - Synop24h:394 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 14:53:54,363 - INFO - Synop24h:395 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 18 Août 2025'
2025-08-18 14:53:54,364 - INFO - Synop24h:418 - Updated 24h precipitation date line in Word document.
2025-08-18 14:53:54,365 - INFO - Synop24h:432 - Updated cumulative precipitation date line in Word document.
2025-08-18 14:53:54,365 - INFO - Synop24h:437 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-18 14:53:54,592 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 14:53:54,607 - INFO - Synop24h:460 - Set font size for 24h precipitation table in Word.
2025-08-18 14:53:54,607 - INFO - Synop24h:465 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-18 14:53:54,812 - WARNING - Synop24h:362 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 14:53:54,827 - INFO - Synop24h:488 - Set font size for cumulative precipitation table in Word.
2025-08-18 14:53:54,841 - INFO - Synop24h:495 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 14:53:54,841 - INFO - Synop24h:499 - Script Synop24h.py finished.
2025-08-18 14:53:54,946 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:53:54,946 - INFO - Bulletin:185 - Synop24h.py executed successfully.
2025-08-18 14:53:54,946 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 14:53:54,946 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:53:55,525 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 14:53:55,525 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 14:53:55,525 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:53:55,525 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:53:55,526 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:53:55,526 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 14:53:55,526 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:53:55,526 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:53:55,526 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 14:53:55,526 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 14:53:55,526 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 14:53:55,527 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 14:53:55,692 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 14:53:55,697 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 14:53:55,698 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 14:53:55,699 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 14:53:55,704 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 14:53:55,705 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 14:53:55,706 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:53:55,706 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 14:53:55,798 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 14:53:55,798 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 14:53:55,798 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 14:53:55,798 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 14:53:55,798 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 14:53:55,812 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 14:53:55,816 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 14:53:55,818 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,819 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,820 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,830 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,831 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,832 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,833 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,834 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,835 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,836 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,837 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,838 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,839 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,844 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,847 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,848 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,850 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,851 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,852 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,853 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,854 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,860 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,860 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,872 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,874 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,876 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,876 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,877 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,879 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,880 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,883 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,885 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,885 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,888 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,889 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,890 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,892 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,894 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 14:53:55,895 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 14:53:55,895 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:53:55,918 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 14:53:55,919 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:53:55,919 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 14:53:55,919 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 14:53:55,931 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 14:53:55,932 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 14:53:55,932 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 14:53:55,932 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 14:53:55,932 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 14:53:55,933 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 14:53:57,453 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 14:53:57,454 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:53:57,466 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:53:57,466 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 14:53:57,562 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:53:57,562 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 14:53:57,562 - INFO - Bulletin:171 - Executing python3 send_MSG.py...
2025-08-18 14:53:57,562 - INFO - system_utils:36 - Executing command: python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:53:57,639 - ERROR - system_utils:57 - Command 'python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h' failed with exit code 2.
2025-08-18 14:53:57,639 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 14:53:57,639 - ERROR - system_utils:59 - STDERR: usage: send_MSG.py [-h] [--shared-log-file SHARED_LOG_FILE]
send_MSG.py: error: unrecognized arguments: 2025 08 18 /home/aoumeur/bqrm/BQCP24h
ERROR (send_MSG.py): Argument parsing failed. Exit code: 2
2025-08-18 14:53:57,639 - ERROR - Bulletin:187 - Error executing send_MSG.py: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'send_MSG.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
2025-08-18 14:53:57,640 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 14:53:57,640 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 14:53:57,641 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 14:53:57,641 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 14:53:57,641 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:53:57,641 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:53:57,641 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 14:53:57,641 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:53:57,641 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 14:53:57,641 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:53:57,641 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:53:57,641 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 14:53:57,645 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:53:57,645 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 14:53:57,645 - INFO - Bulletin:251 - Script finished.
2025-08-18 14:57:02,852 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 14:57:02,852 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 14:57:02,852 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 14:57:02,852 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 14:57:02,852 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 14:57:02,852 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:57:02,853 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 14:57:02,853 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 14:57:02,853 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 14:57:02,853 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:57:02,853 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 14:57:02,853 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 14:57:02,853 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 14:57:02,857 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 14:57:02,858 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 14:57:02,858 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 14:57:02,858 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 14:57:02,862 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 14:57:02,863 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 14:57:02,865 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 14:57:02,866 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 14:57:02,866 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 14:57:02,866 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 14:57:02,867 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 14:57:02,867 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 14:57:02,867 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 14:57:02,867 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 14:57:02,867 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 14:57:02,867 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:57:03,361 - ERROR - system_utils:57 - Command 'python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log' failed with exit code 1.
2025-08-18 14:57:03,361 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 14:57:03,361 - ERROR - system_utils:59 - STDERR: Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/csvtoxlsx.py", line 44, in <module>
    AA = args.year
AttributeError: 'Namespace' object has no attribute 'year'
2025-08-18 14:57:03,361 - ERROR - Bulletin:186 - Error executing csvtoxlsx.py: Command '['python3', 'csvtoxlsx.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'csvtoxlsx.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 1.
2025-08-18 14:57:03,362 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 14:57:03,362 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:57:04,079 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log' failed with exit code 1.
2025-08-18 14:57:04,079 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 14:57:04,080 - ERROR - system_utils:59 - STDERR: Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Synop24h.py", line 50, in <module>
    AA = args.year
AttributeError: 'Namespace' object has no attribute 'year'
2025-08-18 14:57:04,080 - ERROR - Bulletin:186 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 1.
2025-08-18 14:57:04,080 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 14:57:04,080 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:57:04,729 - ERROR - system_utils:57 - Command 'python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log' failed with exit code 2.
2025-08-18 14:57:04,729 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 14:57:04,729 - ERROR - system_utils:59 - STDERR: usage: SynoClim.py [-h] [--shared-log-file SHARED_LOG_FILE]
                   year month day local_directory
SynoClim.py: error: the following arguments are required: year, month, day, local_directory
ERROR (SynoClim.py): Argument parsing failed. Exit code: 2
2025-08-18 14:57:04,729 - ERROR - Bulletin:186 - Error executing SynoClim.py: Command '['python3', 'SynoClim.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'SynoClim.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log']' returned non-zero exit status 2.
2025-08-18 14:57:04,729 - INFO - Bulletin:171 - Executing python3 send_MSG.py...
2025-08-18 14:57:04,730 - INFO - system_utils:36 - Executing command: python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 14:57:04,795 - INFO - send_MSG:91 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 14:57:04,795 - INFO - send_MSG:92 - Starting daily weather bulletin sending script.
2025-08-18 14:57:04,795 - INFO - send_MSG:119 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 14:57:04,795 - INFO - send_MSG:119 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 14:57:04,795 - INFO - send_MSG:136 - Attempting to send email with subject: 'Bulletin du 18/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-18 14:57:04,795 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 18/08/2025'
2025-08-18 14:57:04,997 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-18 14:57:04,999 - INFO - send_MSG:152 - Email process completed successfully.
2025-08-18 14:57:04,999 - INFO - send_MSG:156 - Script execution finished.
2025-08-18 14:57:05,028 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 14:57:05,029 - INFO - Bulletin:184 - send_MSG.py executed successfully.
2025-08-18 14:57:05,029 - INFO - Bulletin:199 - Starting post-processing and cleanup operations.
2025-08-18 14:57:05,029 - INFO - Bulletin:203 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 14:57:05,030 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 14:57:05,030 - INFO - Bulletin:206 - No *.txt files found to move or all failed.
2025-08-18 14:57:05,030 - INFO - Bulletin:209 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:57:05,030 - INFO - Bulletin:213 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 14:57:05,030 - INFO - Bulletin:218 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 14:57:05,030 - INFO - Bulletin:224 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:57:05,031 - INFO - Bulletin:228 - Backup directories created successfully.
2025-08-18 14:57:05,031 - INFO - Bulletin:236 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 14:57:05,031 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:57:05,031 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 14:57:05,036 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 14:57:05,036 - INFO - Bulletin:244 - TAC data copy to backup successful.
2025-08-18 14:57:05,036 - INFO - Bulletin:250 - Script finished.
2025-08-18 15:45:35,203 - INFO - Bulletin:54 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:45:35,203 - INFO - Bulletin:66 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 15:45:35,204 - INFO - Bulletin:68 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:45:35,204 - INFO - Bulletin:71 - Current Year (AA): 2025
2025-08-18 15:45:35,204 - INFO - Bulletin:72 - Current Month (MM): 08
2025-08-18 15:45:35,204 - INFO - Bulletin:73 - Current Day (DD): 18
2025-08-18 15:45:35,204 - INFO - Bulletin:74 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:35,204 - INFO - Bulletin:86 - BUFR Input Root: bufr_data/observations
2025-08-18 15:45:35,204 - INFO - Bulletin:87 - TAC Input Root: bqrm_data/observations
2025-08-18 15:45:35,204 - INFO - Bulletin:88 - FTP Server: 10.16.80.222
2025-08-18 15:45:35,204 - INFO - Bulletin:89 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:35,204 - INFO - Bulletin:101 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 15:45:35,204 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 15:45:35,204 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 15:45:35,219 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 15:45:35,219 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 15:45:35,219 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 15:45:35,219 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:35,609 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 15:45:35,610 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 15:45:35,654 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 15:45:35,654 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 15:45:35,654 - INFO - Bulletin:119 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 15:45:35,655 - INFO - Bulletin:124 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 15:45:35,655 - INFO - Bulletin:143 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 15:45:35,655 - INFO - Bulletin:150 - BUFR Synop file copy successful.
2025-08-18 15:45:35,655 - INFO - Bulletin:164 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 15:45:35,656 - INFO - Bulletin:170 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 15:45:35,656 - INFO - Bulletin:175 - Executing python3 csvtoxlsx.py...
2025-08-18 15:45:35,656 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:45:36,145 - INFO - csvtoxlsx:39 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:36,148 - INFO - csvtoxlsx:45 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 15:45:36,153 - INFO - csvtoxlsx:66 - Data reshaped successfully.
2025-08-18 15:45:36,164 - INFO - csvtoxlsx:90 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 15:45:36,165 - INFO - csvtoxlsx:95 - Script csvtoxlsx.py finished.
2025-08-18 15:45:36,231 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:45:36,231 - INFO - Bulletin:184 - csvtoxlsx.py executed successfully.
2025-08-18 15:45:36,231 - INFO - Bulletin:175 - Executing python3 Synop24h.py...
2025-08-18 15:45:36,231 - INFO - system_utils:36 - Executing command: python3 Synop24h.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:45:36,819 - INFO - Synop24h:45 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:36,819 - INFO - Synop24h:47 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:36,909 - ERROR - system_utils:57 - Command 'python3 Synop24h.py' failed with exit code 1.
2025-08-18 15:45:36,909 - ERROR - system_utils:58 - STDOUT: 2025-08-18 15:45:36,819 - INFO - Synop24h:45 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:36,819 - INFO - Synop24h:47 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:45:36,909 - ERROR - system_utils:59 - STDERR: DEBUG (Synop24h.py): Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Synop24h.py", line 50, in <module>
    bufr_file = LOCAL_DIR / "Synop" / f"Synop_{AA}{MM}{DD}0600.bufr"
TypeError: unsupported operand type(s) for /: 'str' and 'str'
2025-08-18 15:45:36,909 - ERROR - Bulletin:186 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py']' returned non-zero exit status 1.
2025-08-18 15:45:36,910 - INFO - Bulletin:175 - Executing python3 SynoClim.py...
2025-08-18 15:45:36,910 - INFO - system_utils:36 - Executing command: python3 SynoClim.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:45:37,576 - ERROR - system_utils:57 - Command 'python3 SynoClim.py' failed with exit code 2.
2025-08-18 15:45:37,576 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 15:45:37,577 - ERROR - system_utils:59 - STDERR: usage: SynoClim.py [-h] [--shared-log-file SHARED_LOG_FILE]
                   year month day local_directory
SynoClim.py: error: the following arguments are required: year, month, day, local_directory
ERROR (SynoClim.py): Argument parsing failed. Exit code: 2
2025-08-18 15:45:37,577 - ERROR - Bulletin:186 - Error executing SynoClim.py: Command '['python3', 'SynoClim.py']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'SynoClim.py']' returned non-zero exit status 2.
2025-08-18 15:45:37,577 - INFO - Bulletin:175 - Executing python3 send_MSG.py...
2025-08-18 15:45:37,577 - INFO - system_utils:36 - Executing command: python3 send_MSG.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:45:37,642 - INFO - send_MSG:81 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:45:37,643 - INFO - send_MSG:82 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:45:37,643 - INFO - send_MSG:83 - Starting daily weather bulletin sending script.
2025-08-18 15:45:37,643 - INFO - send_MSG:110 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 15:45:37,643 - INFO - send_MSG:110 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 15:45:37,643 - INFO - send_MSG:127 - Attempting to send email with subject: 'Bulletin du 18/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-18 15:45:37,643 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 18/08/2025'
2025-08-18 15:45:37,865 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-18 15:45:37,867 - INFO - send_MSG:143 - Email process completed successfully.
2025-08-18 15:45:37,867 - INFO - send_MSG:147 - Script execution finished.
2025-08-18 15:45:37,880 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:45:37,880 - INFO - Bulletin:184 - send_MSG.py executed successfully.
2025-08-18 15:45:37,880 - INFO - Bulletin:199 - Starting post-processing and cleanup operations.
2025-08-18 15:45:37,880 - INFO - Bulletin:203 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 15:45:37,881 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 15:45:37,881 - INFO - Bulletin:206 - No *.txt files found to move or all failed.
2025-08-18 15:45:37,881 - INFO - Bulletin:209 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:45:37,881 - INFO - Bulletin:213 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:45:37,881 - INFO - Bulletin:218 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 15:45:37,881 - INFO - Bulletin:224 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:45:37,881 - INFO - Bulletin:228 - Backup directories created successfully.
2025-08-18 15:45:37,881 - INFO - Bulletin:236 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:45:37,882 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:45:37,882 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 15:45:37,885 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:45:37,885 - INFO - Bulletin:244 - TAC data copy to backup successful.
2025-08-18 15:45:37,885 - INFO - Bulletin:250 - Script finished.
2025-08-18 15:50:09,458 - INFO - Bulletin:54 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:50:09,459 - INFO - Bulletin:66 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 15:50:09,459 - INFO - Bulletin:68 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:50:09,459 - INFO - Bulletin:71 - Current Year (AA): 2025
2025-08-18 15:50:09,459 - INFO - Bulletin:72 - Current Month (MM): 08
2025-08-18 15:50:09,459 - INFO - Bulletin:73 - Current Day (DD): 18
2025-08-18 15:50:09,459 - INFO - Bulletin:74 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:50:09,459 - INFO - Bulletin:86 - BUFR Input Root: bufr_data/observations
2025-08-18 15:50:09,459 - INFO - Bulletin:87 - TAC Input Root: bqrm_data/observations
2025-08-18 15:50:09,459 - INFO - Bulletin:88 - FTP Server: 10.16.80.222
2025-08-18 15:50:09,459 - INFO - Bulletin:89 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:50:09,459 - INFO - Bulletin:101 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 15:50:09,459 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 15:50:09,459 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 15:50:09,465 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 15:50:09,465 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 15:50:09,465 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 15:50:09,466 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:50:09,470 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 15:50:09,470 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 15:50:09,489 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 15:50:09,490 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 15:50:09,490 - INFO - Bulletin:119 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 15:50:09,490 - INFO - Bulletin:124 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 15:50:09,491 - INFO - Bulletin:143 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 15:50:09,491 - INFO - Bulletin:150 - BUFR Synop file copy successful.
2025-08-18 15:50:09,491 - INFO - Bulletin:164 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 15:50:09,491 - INFO - Bulletin:170 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 15:50:09,491 - INFO - Bulletin:175 - Executing python3 csvtoxlsx.py...
2025-08-18 15:50:09,492 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:50:09,911 - INFO - csvtoxlsx:39 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:50:09,914 - INFO - csvtoxlsx:45 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 15:50:09,918 - INFO - csvtoxlsx:66 - Data reshaped successfully.
2025-08-18 15:50:09,930 - INFO - csvtoxlsx:90 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 15:50:09,930 - INFO - csvtoxlsx:95 - Script csvtoxlsx.py finished.
2025-08-18 15:50:09,996 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:50:09,996 - INFO - Bulletin:184 - csvtoxlsx.py executed successfully.
2025-08-18 15:50:09,996 - INFO - Bulletin:175 - Executing python3 Synop24h.py...
2025-08-18 15:50:09,997 - INFO - system_utils:36 - Executing command: python3 Synop24h.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:50:10,653 - ERROR - system_utils:57 - Command 'python3 Synop24h.py' failed with exit code 1.
2025-08-18 15:50:10,654 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 15:50:10,654 - ERROR - system_utils:59 - STDERR: DEBUG (Synop24h.py): Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Synop24h.py", line 41, in <module>
    AA = sys.argv[1]
IndexError: list index out of range

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Synop24h.py", line 48, in <module>
    logger.critical(f"Missing required command-line arguments (Year, Month, Day, Local Directory) for {SCRIPT_NAME}.")
NameError: name 'SCRIPT_NAME' is not defined
2025-08-18 15:50:10,654 - ERROR - Bulletin:186 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py']' returned non-zero exit status 1.
2025-08-18 15:50:10,654 - INFO - Bulletin:175 - Executing python3 SynoClim.py...
2025-08-18 15:50:10,655 - INFO - system_utils:36 - Executing command: python3 SynoClim.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:50:11,334 - ERROR - system_utils:57 - Command 'python3 SynoClim.py' failed with exit code 2.
2025-08-18 15:50:11,334 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 15:50:11,335 - ERROR - system_utils:59 - STDERR: usage: SynoClim.py [-h] [--shared-log-file SHARED_LOG_FILE]
                   year month day local_directory
SynoClim.py: error: the following arguments are required: year, month, day, local_directory
ERROR (SynoClim.py): Argument parsing failed. Exit code: 2
2025-08-18 15:50:11,335 - ERROR - Bulletin:186 - Error executing SynoClim.py: Command '['python3', 'SynoClim.py']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 183, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'SynoClim.py']' returned non-zero exit status 2.
2025-08-18 15:50:11,335 - INFO - Bulletin:175 - Executing python3 send_MSG.py...
2025-08-18 15:50:11,335 - INFO - system_utils:36 - Executing command: python3 send_MSG.py in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:50:11,400 - INFO - send_MSG:81 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:50:11,400 - INFO - send_MSG:82 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:50:11,401 - INFO - send_MSG:83 - Starting daily weather bulletin sending script.
2025-08-18 15:50:11,401 - INFO - send_MSG:110 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 15:50:11,401 - INFO - send_MSG:110 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 15:50:11,401 - INFO - send_MSG:127 - Attempting to send email with subject: 'Bulletin du 18/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-18 15:50:11,401 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 18/08/2025'
2025-08-18 15:50:11,682 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-18 15:50:11,683 - INFO - send_MSG:143 - Email process completed successfully.
2025-08-18 15:50:11,684 - INFO - send_MSG:147 - Script execution finished.
2025-08-18 15:50:11,699 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:50:11,700 - INFO - Bulletin:184 - send_MSG.py executed successfully.
2025-08-18 15:50:11,700 - INFO - Bulletin:199 - Starting post-processing and cleanup operations.
2025-08-18 15:50:11,700 - INFO - Bulletin:203 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 15:50:11,700 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-18 15:50:11,701 - INFO - Bulletin:206 - No *.txt files found to move or all failed.
2025-08-18 15:50:11,701 - INFO - Bulletin:209 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:50:11,701 - INFO - Bulletin:213 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:50:11,701 - INFO - Bulletin:218 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 15:50:11,701 - INFO - Bulletin:224 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:50:11,701 - INFO - Bulletin:228 - Backup directories created successfully.
2025-08-18 15:50:11,701 - INFO - Bulletin:236 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:50:11,702 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:50:11,702 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 15:50:11,709 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:50:11,709 - INFO - Bulletin:244 - TAC data copy to backup successful.
2025-08-18 15:50:11,709 - INFO - Bulletin:250 - Script finished.
2025-08-18 15:51:33,176 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 15:51:33,176 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 15:51:33,177 - INFO - Bulletin:67 - Current Year (AA): 2025
2025-08-18 15:51:33,177 - INFO - Bulletin:68 - Current Month (MM): 08
2025-08-18 15:51:33,177 - INFO - Bulletin:69 - Current Day (DD): 18
2025-08-18 15:51:33,177 - INFO - Bulletin:70 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:51:33,177 - INFO - Bulletin:82 - BUFR Input Root: bufr_data/observations
2025-08-18 15:51:33,177 - INFO - Bulletin:83 - TAC Input Root: bqrm_data/observations
2025-08-18 15:51:33,177 - INFO - Bulletin:84 - FTP Server: 10.16.80.222
2025-08-18 15:51:33,177 - INFO - Bulletin:85 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:51:33,177 - INFO - Bulletin:97 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 15:51:33,177 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 15:51:33,177 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 15:51:33,182 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 15:51:33,183 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 15:51:33,183 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 15:51:33,183 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 15:51:33,188 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 15:51:33,188 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 15:51:33,191 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 15:51:33,192 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 15:51:33,192 - INFO - Bulletin:115 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 15:51:33,192 - INFO - Bulletin:120 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 15:51:33,192 - INFO - Bulletin:139 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 15:51:33,193 - INFO - Bulletin:146 - BUFR Synop file copy successful.
2025-08-18 15:51:33,193 - INFO - Bulletin:160 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 15:51:33,193 - INFO - Bulletin:166 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 15:51:33,193 - INFO - Bulletin:171 - Executing python3 csvtoxlsx.py...
2025-08-18 15:51:33,193 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:51:33,617 - INFO - csvtoxlsx:56 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:51:33,620 - INFO - csvtoxlsx:62 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 15:51:33,625 - INFO - csvtoxlsx:83 - Data reshaped successfully.
2025-08-18 15:51:33,636 - INFO - csvtoxlsx:107 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 15:51:33,636 - INFO - csvtoxlsx:112 - Script csvtoxlsx.py finished.
2025-08-18 15:51:33,702 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:51:33,702 - INFO - Bulletin:185 - csvtoxlsx.py executed successfully.
2025-08-18 15:51:33,702 - INFO - Bulletin:171 - Executing python3 Synop24h.py...
2025-08-18 15:51:33,702 - INFO - system_utils:36 - Executing command: python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:51:34,361 - ERROR - system_utils:57 - Command 'python3 Synop24h.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h' failed with exit code 2.
2025-08-18 15:51:34,361 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 15:51:34,361 - ERROR - system_utils:59 - STDERR: usage: Synop24h.py [-h] [--shared-log-file SHARED_LOG_FILE]
Synop24h.py: error: unrecognized arguments: 2025 08 18 /home/aoumeur/bqrm/BQCP24h
ERROR (Synop24h.py): Argument parsing failed. Exit code: 2
2025-08-18 15:51:34,361 - ERROR - Bulletin:187 - Error executing Synop24h.py: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 184, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'Synop24h.py', '--shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log', '2025', '08', '18', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 2.
2025-08-18 15:51:34,362 - INFO - Bulletin:171 - Executing python3 SynoClim.py...
2025-08-18 15:51:34,362 - INFO - system_utils:36 - Executing command: python3 SynoClim.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:51:34,935 - INFO - SynoClim:61 - Script SynoClim.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 15:51:34,935 - INFO - SynoClim:74 - Configured file paths:
2025-08-18 15:51:34,935 - INFO - SynoClim:75 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 15:51:34,936 - INFO - SynoClim:76 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 15:51:34,936 - INFO - SynoClim:77 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 15:51:34,936 - INFO - SynoClim:78 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 15:51:34,936 - INFO - SynoClim:79 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 15:51:34,936 - INFO - SynoClim:80 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 15:51:34,936 - INFO - SynoClim:81 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 15:51:34,936 - INFO - SynoClim:82 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 15:51:34,936 - INFO - SynoClim:83 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 15:51:34,937 - INFO - SynoClim:94 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 15:51:35,087 - INFO - SynoClim:99 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-18 15:51:35,091 - INFO - SynoClim:106 - Renaming DataFrame columns.
2025-08-18 15:51:35,092 - INFO - SynoClim:113 - Filtering for 24-hour precipitation (Time == -24).
2025-08-18 15:51:35,092 - INFO - SynoClim:115 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-18 15:51:35,097 - INFO - SynoClim:119 - Dropping rows with missing station names.
2025-08-18 15:51:35,098 - INFO - SynoClim:122 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-18 15:51:35,098 - INFO - SynoClim:129 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 15:51:35,099 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-18 15:51:35,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-18 15:51:35,187 - INFO - SynoClim:131 - Successfully loaded Excel template.
2025-08-18 15:51:35,187 - INFO - SynoClim:146 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-18 15:51:35,187 - INFO - SynoClim:149 - Successfully loaded JSON mapping. 49 entries found.
2025-08-18 15:51:35,187 - INFO - SynoClim:174 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx. Attempting to load.
2025-08-18 15:51:35,200 - INFO - SynoClim:179 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-18 15:51:35,204 - INFO - SynoClim:207 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-18 15:51:35,205 - INFO - SynoClim:237 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,206 - INFO - SynoClim:237 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,207 - INFO - SynoClim:237 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,217 - INFO - SynoClim:266 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,218 - INFO - SynoClim:266 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,219 - INFO - SynoClim:237 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,220 - INFO - SynoClim:266 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,221 - INFO - SynoClim:266 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,222 - INFO - SynoClim:266 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,223 - INFO - SynoClim:266 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,225 - INFO - SynoClim:266 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,226 - INFO - SynoClim:266 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,227 - INFO - SynoClim:266 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,232 - INFO - SynoClim:237 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,235 - INFO - SynoClim:237 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,236 - INFO - SynoClim:237 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,238 - INFO - SynoClim:237 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,240 - INFO - SynoClim:237 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,241 - INFO - SynoClim:237 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,242 - INFO - SynoClim:237 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,243 - INFO - SynoClim:266 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,249 - INFO - SynoClim:237 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,249 - INFO - SynoClim:266 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,261 - INFO - SynoClim:266 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,263 - INFO - SynoClim:266 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,265 - INFO - SynoClim:266 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,265 - INFO - SynoClim:237 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,266 - INFO - SynoClim:266 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,268 - INFO - SynoClim:266 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,269 - INFO - SynoClim:266 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,272 - INFO - SynoClim:266 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,274 - INFO - SynoClim:237 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,274 - INFO - SynoClim:266 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,277 - INFO - SynoClim:266 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,278 - INFO - SynoClim:266 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,279 - INFO - SynoClim:266 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,282 - INFO - SynoClim:266 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,283 - INFO - SynoClim:237 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-18 15:51:35,284 - INFO - SynoClim:274 - Finished populating Excel template. Total missing stations identified: 38
2025-08-18 15:51:35,284 - INFO - SynoClim:279 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 15:51:35,308 - INFO - SynoClim:281 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025180600.xlsx
2025-08-18 15:51:35,308 - INFO - SynoClim:287 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 15:51:35,308 - INFO - SynoClim:293 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250818.txt
2025-08-18 15:51:35,308 - INFO - SynoClim:303 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-18 15:51:35,320 - INFO - SynoClim:305 - Successfully loaded Word template.
2025-08-18 15:51:35,320 - INFO - SynoClim:316 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 15:51:35,321 - INFO - SynoClim:319 - Successfully loaded month translation JSON.
2025-08-18 15:51:35,321 - INFO - SynoClim:341 - Generated date line for Word document: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 15:51:35,321 - INFO - SynoClim:345 - Attempting to update the first table (date line) in the Word document.
2025-08-18 15:51:35,322 - INFO - SynoClim:367 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-18 15:51:36,834 - INFO - SynoClim:397 - Finished populating Word document table.
2025-08-18 15:51:36,834 - INFO - SynoClim:400 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 15:51:36,847 - INFO - SynoClim:402 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 15:51:36,847 - INFO - SynoClim:409 - Script SynoClim.py finished.
2025-08-18 15:51:36,961 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:51:36,961 - INFO - Bulletin:185 - SynoClim.py executed successfully.
2025-08-18 15:51:36,962 - INFO - Bulletin:171 - Executing python3 send_MSG.py...
2025-08-18 15:51:36,962 - INFO - system_utils:36 - Executing command: python3 send_MSG.py --shared-log-file=/home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 15:51:37,236 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 15:51:37,237 - INFO - Bulletin:185 - send_MSG.py executed successfully.
2025-08-18 15:51:37,237 - INFO - Bulletin:200 - Starting post-processing and cleanup operations.
2025-08-18 15:51:37,237 - INFO - Bulletin:204 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 15:51:37,237 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 15:51:37,238 - INFO - Bulletin:210 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:51:37,238 - INFO - Bulletin:214 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 15:51:37,238 - INFO - Bulletin:219 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 15:51:37,238 - INFO - Bulletin:225 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:51:37,238 - INFO - Bulletin:229 - Backup directories created successfully.
2025-08-18 15:51:37,238 - INFO - Bulletin:237 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 15:51:37,238 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:51:37,238 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 15:51:37,243 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 15:51:37,243 - INFO - Bulletin:245 - TAC data copy to backup successful.
2025-08-18 15:51:37,243 - INFO - Bulletin:251 - Script finished.
2025-08-18 16:11:03,297 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-18 16:11:03,297 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:03,297 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:03,297 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-18 16:11:03,298 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-18 16:11:03,298 - INFO - Bulletin:75 - Current Day (DD): 18
2025-08-18 16:11:03,298 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-18 16:11:03,298 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-18 16:11:03,298 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-18 16:11:03,298 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-18 16:11:03,298 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-18 16:11:03,298 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-18.csv.
2025-08-18 16:11:03,298 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 16:11:03,298 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-18 16:11:03,302 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-18 16:11:03,302 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-18 16:11:03,303 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-18.csv'
2025-08-18 16:11:03,303 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-18 16:11:03,800 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-18 16:11:03,800 - INFO - fetchdata:118 - Downloading exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-18.csv
2025-08-18 16:11:03,903 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-18.csv
2025-08-18 16:11:03,904 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 16:11:03,905 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-18.csv successful.
2025-08-18 16:11:03,906 - INFO - Bulletin:126 - Moved exported_data_2025-08-18.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-18 16:11:03,907 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-18 16:11:03,908 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-18 16:11:03,908 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-18 16:11:03,908 - INFO - Bulletin:172 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-18 16:11:03,909 - INFO - Bulletin:177 - Executing python3 csvtoxlsx.py...
2025-08-18 16:11:03,909 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 16:11:04,363 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:04,363 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 16:11:04,366 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-18.csv
2025-08-18 16:11:04,370 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-18 16:11:04,404 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-18.xlsx
2025-08-18 16:11:04,404 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-18 16:11:04,473 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 16:11:04,473 - INFO - Bulletin:189 - csvtoxlsx.py executed successfully.
2025-08-18 16:11:04,473 - INFO - Bulletin:177 - Executing python3 Synop24h.py...
2025-08-18 16:11:04,473 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 16:11:05,044 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:05,045 - INFO - Synop24h:69 - Script Synop24h.py started with args: Year=2025, Month=08, Day=18, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-18 16:11:05,045 - INFO - Synop24h:83 - Constructed file paths:
2025-08-18 16:11:05,045 - INFO - Synop24h:84 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr
2025-08-18 16:11:05,045 - INFO - Synop24h:85 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 16:11:05,045 - INFO - Synop24h:86 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 16:11:05,045 - INFO - Synop24h:87 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 16:11:05,045 - INFO - Synop24h:88 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 16:11:05,045 - INFO - Synop24h:89 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-18 16:11:05,045 - INFO - Synop24h:90 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 16:11:05,045 - INFO - Synop24h:91 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-18 16:11:05,045 - INFO - Synop24h:92 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt
2025-08-18 16:11:05,045 - INFO - Synop24h:93 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-18 16:11:05,045 - INFO - Synop24h:108 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-18 16:11:05,045 - INFO - Synop24h:111 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-18 16:11:05,046 - INFO - Synop24h:121 - Today's date: 2025-08-18
2025-08-18 16:11:05,046 - INFO - Synop24h:128 - Cumulative precipitation will not be reset.
2025-08-18 16:11:05,046 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-18 16:11:05,196 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508180600.bufr. DataFrame shape: (150, 3)
2025-08-18 16:11:05,196 - INFO - Synop24h:149 - Columns renamed in DataFrame.
2025-08-18 16:11:05,197 - INFO - Synop24h:153 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-18 16:11:05,199 - INFO - Synop24h:161 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-18 16:11:05,199 - INFO - Synop24h:165 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-18 16:11:05,199 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-18 16:11:05,221 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-18 16:11:05,221 - INFO - Synop24h:193 - Updating 24-hour precipitation Excel file with data.
2025-08-18 16:11:05,223 - WARNING - Synop24h:214 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-18 16:11:05,231 - WARNING - Synop24h:214 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-18 16:11:05,258 - INFO - Synop24h:230 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 16:11:05,258 - INFO - Synop24h:243 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250818-06.txt. Total unique missing stations: 2
2025-08-18 16:11:05,258 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-18 16:11:05,278 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-18 16:11:05,278 - INFO - Synop24h:277 - Updating cumulative precipitation Excel file with daily data.
2025-08-18 16:11:05,280 - WARNING - Synop24h:303 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 16:11:05,289 - WARNING - Synop24h:303 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-18 16:11:05,315 - INFO - Synop24h:318 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 16:11:05,315 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx
2025-08-18 16:11:05,336 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 16:11:05,336 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx
2025-08-18 16:11:05,357 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08180600.xlsx, active sheet: 'Feuille1'
2025-08-18 16:11:05,357 - INFO - Synop24h:353 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-18 16:11:05,367 - INFO - Synop24h:355 - Word template loaded successfully.
2025-08-18 16:11:05,367 - INFO - Synop24h:379 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-18 16:11:05,367 - INFO - Synop24h:382 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-18 16:11:05,367 - INFO - Synop24h:402 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 17 Août 2025 à 06h au 18 Août 2025 à 06h.'
2025-08-18 16:11:05,367 - INFO - Synop24h:403 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 18 Août 2025'
2025-08-18 16:11:05,368 - INFO - Synop24h:426 - Updated 24h precipitation date line in Word document.
2025-08-18 16:11:05,369 - INFO - Synop24h:440 - Updated cumulative precipitation date line in Word document.
2025-08-18 16:11:05,369 - INFO - Synop24h:445 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-18 16:11:05,551 - WARNING - Synop24h:370 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 16:11:05,566 - INFO - Synop24h:468 - Set font size for 24h precipitation table in Word.
2025-08-18 16:11:05,566 - INFO - Synop24h:473 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-18 16:11:05,748 - WARNING - Synop24h:370 - Could not format value for Word: 'None'. Returning '/'.
2025-08-18 16:11:05,762 - INFO - Synop24h:496 - Set font size for cumulative precipitation table in Word.
2025-08-18 16:11:05,776 - INFO - Synop24h:503 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 16:11:05,776 - INFO - Synop24h:507 - Script Synop24h.py finished.
2025-08-18 16:11:05,901 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 16:11:05,901 - INFO - Bulletin:189 - Synop24h.py executed successfully.
2025-08-18 16:11:05,901 - INFO - Bulletin:177 - Executing python3 SynoClim.py...
2025-08-18 16:11:05,901 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 16:11:08,610 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 16:11:08,610 - INFO - Bulletin:189 - SynoClim.py executed successfully.
2025-08-18 16:11:08,610 - INFO - Bulletin:177 - Executing python3 send_MSG.py...
2025-08-18 16:11:08,610 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 18 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-18 16:11:08,707 - INFO - send_MSG:83 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:08,707 - INFO - send_MSG:84 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-18 16:11:08,707 - INFO - send_MSG:85 - Starting daily weather bulletin sending script.
2025-08-18 16:11:08,707 - INFO - send_MSG:112 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08180600.docx
2025-08-18 16:11:08,707 - INFO - send_MSG:112 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08180600.docx
2025-08-18 16:11:08,707 - INFO - send_MSG:129 - Attempting to send email with subject: 'Bulletin du 18/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-18 16:11:08,707 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 18/08/2025'
2025-08-18 16:11:08,989 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-18 16:11:08,991 - INFO - send_MSG:145 - Email process completed successfully.
2025-08-18 16:11:08,992 - INFO - send_MSG:149 - Script execution finished.
2025-08-18 16:11:09,022 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-18 16:11:09,023 - INFO - Bulletin:189 - send_MSG.py executed successfully.
2025-08-18 16:11:09,023 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-18 16:11:09,023 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-18 16:11:09,025 - INFO - file_operations:98 - Moved '20250818.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 16:11:09,026 - INFO - file_operations:98 - Moved 'Synop20250818-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-18 16:11:09,026 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 16:11:09,026 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-18 16:11:09,026 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-18 16:11:09,027 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 16:11:09,027 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-18 16:11:09,027 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/18 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18.
2025-08-18 16:11:09,028 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 16:11:09,029 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18' exists. Removing it before copying.
2025-08-18 16:11:09,045 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/18' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/18'.
2025-08-18 16:11:09,045 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-18 16:11:09,046 - INFO - Bulletin:255 - Script finished.
2025-08-18 16:11:09,046 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-19 08:31:10,382 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-19 08:31:10,382 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:31:10,382 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:31:10,382 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-19 08:31:10,382 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-19 08:31:10,382 - INFO - Bulletin:75 - Current Day (DD): 19
2025-08-19 08:31:10,382 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:31:10,382 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-19 08:31:10,383 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-19 08:31:10,383 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-19 08:31:10,383 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:31:10,383 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-19.csv.
2025-08-19 08:31:10,383 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-19 08:31:10,383 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-19 08:31:10,396 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-19 08:31:10,397 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-19 08:31:10,397 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-19.csv'
2025-08-19 08:31:10,397 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:31:11,393 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-19 08:31:11,393 - INFO - fetchdata:118 - Downloading exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-19.csv
2025-08-19 08:31:11,420 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-19.csv
2025-08-19 08:31:11,421 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-19 08:31:11,422 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-19.csv successful.
2025-08-19 08:31:11,422 - INFO - Bulletin:126 - Moved exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-19 08:31:11,423 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-19 08:31:11,423 - WARNING - file_operations:245 - File not found: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr. Skipping this operation.
2025-08-19 08:31:11,423 - ERROR - Bulletin:155 - BUFR Synop file not found at source: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr. Skipping copy.
2025-08-19 08:31:11,423 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-19 08:31:11,424 - ERROR - Bulletin:193 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-19 08:31:11,424 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-19 08:31:11,424 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-19 08:31:11,425 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-19 08:31:11,425 - INFO - Bulletin:211 - No *.txt files found to move or all failed.
2025-08-19 08:31:11,425 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 08:31:11,426 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 08:31:11,426 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-19 08:31:11,426 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 08:31:11,426 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-19 08:31:11,426 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/19 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 08:31:11,427 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 08:31:11,427 - ERROR - file_operations:344 - Source directory not found: /bqrm_data/observations/2025/08/19
2025-08-19 08:31:11,428 - WARNING - Bulletin:251 - Skipping TAC data copy to backup: Source directory not found: /bqrm_data/observations/2025/08/19
2025-08-19 08:31:11,428 - INFO - Bulletin:255 - Script finished.
2025-08-19 08:31:11,428 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-19 08:32:10,767 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-19 08:32:10,767 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:10,767 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:10,767 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-19 08:32:10,767 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-19 08:32:10,767 - INFO - Bulletin:75 - Current Day (DD): 19
2025-08-19 08:32:10,767 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:32:10,767 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-19 08:32:10,767 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-19 08:32:10,768 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-19 08:32:10,768 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:32:10,768 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-19.csv.
2025-08-19 08:32:10,768 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-19 08:32:10,768 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-19 08:32:10,772 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-19 08:32:10,772 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-19 08:32:10,773 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-19.csv'
2025-08-19 08:32:10,773 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-19 08:32:10,777 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-19 08:32:10,777 - INFO - fetchdata:118 - Downloading exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-19.csv
2025-08-19 08:32:10,781 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-19.csv
2025-08-19 08:32:10,782 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-19 08:32:10,782 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-19.csv successful.
2025-08-19 08:32:10,783 - INFO - Bulletin:126 - Moved exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-19 08:32:10,783 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-19 08:32:10,783 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-19 08:32:10,784 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-19 08:32:10,784 - INFO - Bulletin:172 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-19 08:32:10,784 - INFO - Bulletin:177 - Executing python3 csvtoxlsx.py...
2025-08-19 08:32:10,784 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 08:32:11,247 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:11,247 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 08:32:11,250 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-19.csv
2025-08-19 08:32:11,255 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-19 08:32:11,269 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx
2025-08-19 08:32:11,269 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-19 08:32:11,339 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 08:32:11,339 - INFO - Bulletin:189 - csvtoxlsx.py executed successfully.
2025-08-19 08:32:11,339 - INFO - Bulletin:177 - Executing python3 Synop24h.py...
2025-08-19 08:32:11,339 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 08:32:11,957 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:11,957 - INFO - Synop24h:69 - Script Synop24h.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 08:32:11,957 - INFO - Synop24h:83 - Constructed file paths:
2025-08-19 08:32:11,957 - INFO - Synop24h:84 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 08:32:11,957 - INFO - Synop24h:85 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 08:32:11,958 - INFO - Synop24h:86 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 08:32:11,958 - INFO - Synop24h:87 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 08:32:11,958 - INFO - Synop24h:88 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 08:32:11,958 - INFO - Synop24h:89 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-19 08:32:11,958 - INFO - Synop24h:90 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 08:32:11,958 - INFO - Synop24h:91 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-19 08:32:11,958 - INFO - Synop24h:92 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt
2025-08-19 08:32:11,958 - INFO - Synop24h:93 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-19 08:32:11,958 - INFO - Synop24h:108 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-19 08:32:11,958 - INFO - Synop24h:111 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-19 08:32:11,958 - INFO - Synop24h:121 - Today's date: 2025-08-19
2025-08-19 08:32:11,958 - INFO - Synop24h:128 - Cumulative precipitation will not be reset.
2025-08-19 08:32:11,959 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-19 08:32:12,136 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr. DataFrame shape: (190, 3)
2025-08-19 08:32:12,137 - INFO - Synop24h:149 - Columns renamed in DataFrame.
2025-08-19 08:32:12,137 - INFO - Synop24h:153 - Filtered for 24-hour precipitation (Time == -24). Records found: 95
2025-08-19 08:32:12,139 - INFO - Synop24h:161 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (95, 2)
2025-08-19 08:32:12,139 - INFO - Synop24h:165 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-19 08:32:12,140 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 08:32:12,161 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-19 08:32:12,161 - INFO - Synop24h:193 - Updating 24-hour precipitation Excel file with data.
2025-08-19 08:32:12,163 - WARNING - Synop24h:214 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-19 08:32:12,171 - WARNING - Synop24h:214 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-19 08:32:12,179 - WARNING - Synop24h:214 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data. Marked as missing.
2025-08-19 08:32:12,197 - INFO - Synop24h:230 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 08:32:12,198 - INFO - Synop24h:243 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt. Total unique missing stations: 3
2025-08-19 08:32:12,198 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 08:32:12,219 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-19 08:32:12,219 - INFO - Synop24h:277 - Updating cumulative precipitation Excel file with daily data.
2025-08-19 08:32:12,220 - WARNING - Synop24h:303 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 08:32:12,228 - WARNING - Synop24h:303 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 08:32:12,237 - WARNING - Synop24h:303 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 08:32:12,255 - INFO - Synop24h:318 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 08:32:12,255 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 08:32:12,276 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 08:32:12,276 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 08:32:12,297 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 08:32:12,297 - INFO - Synop24h:353 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-19 08:32:12,307 - INFO - Synop24h:355 - Word template loaded successfully.
2025-08-19 08:32:12,307 - INFO - Synop24h:379 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-19 08:32:12,307 - INFO - Synop24h:382 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-19 08:32:12,307 - INFO - Synop24h:402 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 18 Août 2025 à 06h au 19 Août 2025 à 06h.'
2025-08-19 08:32:12,307 - INFO - Synop24h:403 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 19 Août 2025'
2025-08-19 08:32:12,308 - INFO - Synop24h:426 - Updated 24h precipitation date line in Word document.
2025-08-19 08:32:12,309 - INFO - Synop24h:440 - Updated cumulative precipitation date line in Word document.
2025-08-19 08:32:12,309 - INFO - Synop24h:445 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-19 08:32:12,490 - WARNING - Synop24h:370 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 08:32:12,504 - INFO - Synop24h:468 - Set font size for 24h precipitation table in Word.
2025-08-19 08:32:12,504 - INFO - Synop24h:473 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-19 08:32:12,684 - WARNING - Synop24h:370 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 08:32:12,697 - INFO - Synop24h:496 - Set font size for cumulative precipitation table in Word.
2025-08-19 08:32:12,711 - INFO - Synop24h:503 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 08:32:12,711 - INFO - Synop24h:507 - Script Synop24h.py finished.
2025-08-19 08:32:12,808 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 08:32:12,808 - INFO - Bulletin:189 - Synop24h.py executed successfully.
2025-08-19 08:32:12,808 - INFO - Bulletin:177 - Executing python3 SynoClim.py...
2025-08-19 08:32:12,808 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 08:32:15,346 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 08:32:15,347 - INFO - Bulletin:189 - SynoClim.py executed successfully.
2025-08-19 08:32:15,347 - INFO - Bulletin:177 - Executing python3 send_MSG.py...
2025-08-19 08:32:15,347 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 08:32:15,413 - INFO - send_MSG:83 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:15,413 - INFO - send_MSG:84 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 08:32:15,413 - INFO - send_MSG:85 - Starting daily weather bulletin sending script.
2025-08-19 08:32:15,413 - INFO - send_MSG:112 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 08:32:15,413 - INFO - send_MSG:112 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 08:32:15,413 - INFO - send_MSG:129 - Attempting to send email with subject: 'Bulletin du 19/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-19 08:32:15,413 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 19/08/2025'
2025-08-19 08:32:15,614 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-19 08:32:15,615 - INFO - send_MSG:145 - Email process completed successfully.
2025-08-19 08:32:15,616 - INFO - send_MSG:149 - Script execution finished.
2025-08-19 08:32:15,641 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 08:32:15,641 - INFO - Bulletin:189 - send_MSG.py executed successfully.
2025-08-19 08:32:15,642 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-19 08:32:15,642 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-19 08:32:15,643 - INFO - file_operations:98 - Moved 'Synop20250819-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 08:32:15,643 - INFO - file_operations:98 - Moved '20250819.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 08:32:15,643 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 08:32:15,643 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 08:32:15,643 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-19 08:32:15,643 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 08:32:15,644 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-19 08:32:15,644 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/19 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 08:32:15,644 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 08:32:15,644 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19' exists. Removing it before copying.
2025-08-19 08:32:15,648 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 08:32:15,648 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-19 08:32:15,648 - INFO - Bulletin:255 - Script finished.
2025-08-19 08:32:15,649 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-19 09:12:41,098 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-19 09:12:41,108 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:41,108 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:41,108 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-19 09:12:41,108 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-19 09:12:41,109 - INFO - Bulletin:75 - Current Day (DD): 19
2025-08-19 09:12:41,109 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:41,109 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-19 09:12:41,109 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-19 09:12:41,109 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-19 09:12:41,109 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:41,109 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-19.csv.
2025-08-19 09:12:41,109 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-19 09:12:41,110 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-19 09:12:41,125 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-19 09:12:41,125 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-19 09:12:41,125 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-19.csv'
2025-08-19 09:12:41,126 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:41,269 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-19 09:12:41,269 - INFO - fetchdata:118 - Downloading exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-19.csv
2025-08-19 09:12:41,317 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-19.csv
2025-08-19 09:12:41,318 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-19 09:12:41,319 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-19.csv successful.
2025-08-19 09:12:41,319 - INFO - Bulletin:126 - Moved exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-19 09:12:41,321 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-19 09:12:41,322 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-19 09:12:41,322 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-19 09:12:41,323 - INFO - Bulletin:172 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-19 09:12:41,323 - INFO - Bulletin:177 - Executing python3 csvtoxlsx.py...
2025-08-19 09:12:41,323 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:12:41,870 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:41,871 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:41,874 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-19.csv
2025-08-19 09:12:41,878 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-19 09:12:41,890 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx
2025-08-19 09:12:41,890 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-19 09:12:41,956 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:12:41,956 - INFO - Bulletin:189 - csvtoxlsx.py executed successfully.
2025-08-19 09:12:41,956 - INFO - Bulletin:177 - Executing python3 Synop24h.py...
2025-08-19 09:12:41,956 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:12:42,539 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:42,539 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:42,539 - INFO - Synop24h:77 - Constructed file paths:
2025-08-19 09:12:42,539 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:12:42,539 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 09:12:42,539 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 09:12:42,540 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:12:42,540 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:12:42,540 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-19 09:12:42,540 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:12:42,540 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-19 09:12:42,540 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt
2025-08-19 09:12:42,540 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-19 09:12:42,540 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-19 09:12:42,540 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-19 09:12:42,540 - INFO - Synop24h:115 - Today's date: 2025-08-19
2025-08-19 09:12:42,540 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-19 09:12:42,541 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-19 09:12:42,720 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr. DataFrame shape: (190, 3)
2025-08-19 09:12:42,720 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-19 09:12:42,721 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 95
2025-08-19 09:12:42,723 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (95, 2)
2025-08-19 09:12:42,723 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-19 09:12:42,723 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 09:12:42,762 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-19 09:12:42,762 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-19 09:12:42,764 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-19 09:12:42,773 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-19 09:12:42,781 - WARNING - Synop24h:208 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data. Marked as missing.
2025-08-19 09:12:42,800 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:12:42,800 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt. Total unique missing stations: 3
2025-08-19 09:12:42,800 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 09:12:42,822 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-19 09:12:42,822 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-19 09:12:42,824 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:12:42,832 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:12:42,841 - WARNING - Synop24h:297 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:12:42,860 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:12:42,860 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:12:42,880 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 09:12:42,880 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:12:42,901 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 09:12:42,901 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-19 09:12:42,911 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-19 09:12:42,911 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-19 09:12:42,911 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-19 09:12:42,911 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 18 Août 2025 à 06h au 19 Août 2025 à 06h.'
2025-08-19 09:12:42,911 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 19 Août 2025'
2025-08-19 09:12:42,912 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-19 09:12:42,913 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-19 09:12:42,913 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-19 09:12:43,101 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 09:12:43,115 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-19 09:12:43,115 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-19 09:12:43,296 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 09:12:43,310 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-19 09:12:43,324 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:12:43,324 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-19 09:12:43,420 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:12:43,420 - INFO - Bulletin:189 - Synop24h.py executed successfully.
2025-08-19 09:12:43,420 - INFO - Bulletin:177 - Executing python3 SynoClim.py...
2025-08-19 09:12:43,420 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:12:44,026 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:12:44,027 - INFO - SynoClim:66 - Configured file paths:
2025-08-19 09:12:44,027 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:12:44,027 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:12:44,027 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:12:44,027 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-19 09:12:44,027 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:12:44,027 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:12:44,027 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-19 09:12:44,027 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx
2025-08-19 09:12:44,027 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-19 09:12:44,028 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:12:44,205 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (190, 3)
2025-08-19 09:12:44,209 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-19 09:12:44,210 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-19 09:12:44,210 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (95, 3)
2025-08-19 09:12:44,214 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-19 09:12:44,215 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (95, 3)
2025-08-19 09:12:44,216 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:12:44,216 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:12:44,302 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-19 09:12:44,303 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-19 09:12:44,303 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-19 09:12:44,303 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-19 09:12:44,303 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx. Attempting to load.
2025-08-19 09:12:44,315 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-19 09:12:44,319 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-19 09:12:44,321 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,322 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,323 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,332 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,335 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,337 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,338 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,343 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,346 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,347 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,349 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,352 - INFO - SynoClim:258 -   Station 'SKIKDA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,352 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,353 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,359 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,359 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,371 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,372 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,374 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,375 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,375 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,377 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,379 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,383 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,383 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,387 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,388 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,390 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,391 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-19 09:12:44,392 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 29
2025-08-19 09:12:44,392 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:12:44,415 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:12:44,416 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:12:44,416 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:12:44,416 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-19 09:12:44,429 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-19 09:12:44,429 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-19 09:12:44,429 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-19 09:12:44,429 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 18 Août 2025 à 06h au 19 Août 2025 à 06h.'
2025-08-19 09:12:44,429 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-19 09:12:44,430 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-19 09:12:45,808 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-19 09:12:45,808 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:12:45,820 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:12:45,821 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-19 09:12:45,917 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:12:45,917 - INFO - Bulletin:189 - SynoClim.py executed successfully.
2025-08-19 09:12:45,917 - INFO - Bulletin:177 - Executing python3 send_MSG.py...
2025-08-19 09:12:45,917 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:12:45,983 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:45,983 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:12:45,983 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-19 09:12:45,983 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:12:45,983 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:12:45,983 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 19/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-19 09:12:45,983 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 19/08/2025'
2025-08-19 09:12:46,178 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-19 09:12:46,180 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-19 09:12:46,181 - INFO - send_MSG:151 - Script execution finished.
2025-08-19 09:12:46,212 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:12:46,213 - INFO - Bulletin:189 - send_MSG.py executed successfully.
2025-08-19 09:12:46,213 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-19 09:12:46,213 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-19 09:12:46,214 - INFO - file_operations:98 - Moved 'Synop20250819-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 09:12:46,214 - INFO - file_operations:98 - Moved '20250819.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 09:12:46,214 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 09:12:46,214 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 09:12:46,214 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-19 09:12:46,214 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 09:12:46,215 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-19 09:12:46,215 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/19 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 09:12:46,215 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 09:12:46,215 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19' exists. Removing it before copying.
2025-08-19 09:12:46,262 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 09:12:46,263 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-19 09:12:46,263 - INFO - Bulletin:255 - Script finished.
2025-08-19 09:12:46,263 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-19 09:20:01,777 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-19 09:20:01,787 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:01,788 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:01,788 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-19 09:20:01,788 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-19 09:20:01,788 - INFO - Bulletin:75 - Current Day (DD): 19
2025-08-19 09:20:01,788 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:01,788 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-19 09:20:01,788 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-19 09:20:01,788 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-19 09:20:01,788 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:01,788 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-19.csv.
2025-08-19 09:20:01,788 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-19 09:20:01,788 - INFO - fetchdata:15 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-19 09:20:01,793 - INFO - fetchdata:18 - Successfully connected and logged in to 10.16.80.222.
2025-08-19 09:20:01,794 - INFO - fetchdata:85 - Changed remote directory to: /
2025-08-19 09:20:01,794 - INFO - fetchdata:92 - Looking for files matching pattern: 'exported_data_2025-08-19.csv'
2025-08-19 09:20:01,794 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:01,798 - INFO - fetchdata:105 - Found 1 files matching pattern on remote server.
2025-08-19 09:20:01,799 - INFO - fetchdata:118 - Downloading exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-19.csv
2025-08-19 09:20:01,824 - INFO - fetchdata:121 - Successfully downloaded exported_data_2025-08-19.csv
2025-08-19 09:20:01,825 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-19 09:20:01,825 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-19.csv successful.
2025-08-19 09:20:01,825 - INFO - Bulletin:126 - Moved exported_data_2025-08-19.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-19 09:20:01,826 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-19 09:20:01,826 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-19 09:20:01,826 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-19 09:20:01,826 - INFO - Bulletin:172 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-19 09:20:01,826 - INFO - Bulletin:177 - Executing python3 csvtoxlsx.py...
2025-08-19 09:20:01,826 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:20:02,267 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:02,267 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:02,270 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-19.csv
2025-08-19 09:20:02,275 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-19 09:20:02,287 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx
2025-08-19 09:20:02,287 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-19 09:20:02,352 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:20:02,352 - INFO - Bulletin:189 - csvtoxlsx.py executed successfully.
2025-08-19 09:20:02,352 - INFO - Bulletin:177 - Executing python3 Synop24h.py...
2025-08-19 09:20:02,352 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:20:02,925 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:02,926 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:02,926 - INFO - Synop24h:77 - Constructed file paths:
2025-08-19 09:20:02,926 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:20:02,926 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 09:20:02,926 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 09:20:02,926 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:20:02,926 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:20:02,926 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-19 09:20:02,926 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:20:02,926 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-19 09:20:02,926 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt
2025-08-19 09:20:02,926 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-19 09:20:02,926 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-19 09:20:02,926 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-19 09:20:02,927 - INFO - Synop24h:115 - Today's date: 2025-08-19
2025-08-19 09:20:02,927 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-19 09:20:02,928 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-19 09:20:03,104 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr. DataFrame shape: (190, 3)
2025-08-19 09:20:03,104 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-19 09:20:03,105 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 95
2025-08-19 09:20:03,107 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (95, 2)
2025-08-19 09:20:03,107 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-19 09:20:03,107 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-19 09:20:03,129 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-19 09:20:03,129 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-19 09:20:03,131 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-19 09:20:03,139 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-19 09:20:03,148 - WARNING - Synop24h:208 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data. Marked as missing.
2025-08-19 09:20:03,167 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:20:03,167 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250819-06.txt. Total unique missing stations: 3
2025-08-19 09:20:03,167 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-19 09:20:03,188 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-19 09:20:03,188 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-19 09:20:03,189 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:20:03,198 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:20:03,206 - WARNING - Synop24h:297 - Row 20: Station 'Skikda' (SKIKDA) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-19 09:20:03,225 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:20:03,225 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx
2025-08-19 09:20:03,246 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 09:20:03,246 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx
2025-08-19 09:20:03,267 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08190600.xlsx, active sheet: 'Feuille1'
2025-08-19 09:20:03,267 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-19 09:20:03,277 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-19 09:20:03,277 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-19 09:20:03,277 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-19 09:20:03,277 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 18 Août 2025 à 06h au 19 Août 2025 à 06h.'
2025-08-19 09:20:03,277 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 19 Août 2025'
2025-08-19 09:20:03,278 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-19 09:20:03,279 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-19 09:20:03,279 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-19 09:20:03,457 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 09:20:03,470 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-19 09:20:03,471 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-19 09:20:03,648 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-19 09:20:03,662 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-19 09:20:03,676 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:20:03,676 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-19 09:20:03,772 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:20:03,772 - INFO - Bulletin:189 - Synop24h.py executed successfully.
2025-08-19 09:20:03,772 - INFO - Bulletin:177 - Executing python3 SynoClim.py...
2025-08-19 09:20:03,772 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:20:04,355 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=19, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-19 09:20:04,356 - INFO - SynoClim:66 - Configured file paths:
2025-08-19 09:20:04,356 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:20:04,356 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:20:04,356 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:20:04,356 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-19 09:20:04,356 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:20:04,356 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:20:04,356 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-19 09:20:04,356 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx
2025-08-19 09:20:04,356 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-19 09:20:04,357 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508190600.bufr
2025-08-19 09:20:04,537 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (190, 3)
2025-08-19 09:20:04,542 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-19 09:20:04,542 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-19 09:20:04,543 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (95, 3)
2025-08-19 09:20:04,547 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-19 09:20:04,548 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (95, 3)
2025-08-19 09:20:04,549 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:20:04,549 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-19 09:20:04,637 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-19 09:20:04,637 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-19 09:20:04,637 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-19 09:20:04,638 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-19 09:20:04,638 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-19.xlsx. Attempting to load.
2025-08-19 09:20:04,650 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-19 09:20:04,654 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-19 09:20:04,655 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,656 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,657 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,668 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,671 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,672 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,674 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,678 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,681 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,682 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,685 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,687 - INFO - SynoClim:258 -   Station 'SKIKDA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,688 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,688 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,694 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,695 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,707 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,708 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,710 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,711 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,711 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,713 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,715 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,719 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,720 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,723 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,724 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,726 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,727 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-19 09:20:04,729 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 29
2025-08-19 09:20:04,729 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:20:04,752 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025190600.xlsx
2025-08-19 09:20:04,752 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:20:04,752 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250819.txt
2025-08-19 09:20:04,752 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-19 09:20:04,765 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-19 09:20:04,765 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-19 09:20:04,765 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-19 09:20:04,765 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 18 Août 2025 à 06h au 19 Août 2025 à 06h.'
2025-08-19 09:20:04,765 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-19 09:20:04,766 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-19 09:20:06,186 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-19 09:20:06,186 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:20:06,198 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:20:06,198 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-19 09:20:06,298 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:20:06,298 - INFO - Bulletin:189 - SynoClim.py executed successfully.
2025-08-19 09:20:06,298 - INFO - Bulletin:177 - Executing python3 send_MSG.py...
2025-08-19 09:20:06,298 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 19 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-19 09:20:06,365 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:06,365 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-19 09:20:06,365 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-19 09:20:06,365 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08190600.docx
2025-08-19 09:20:06,365 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08190600.docx
2025-08-19 09:20:06,365 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 19/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-19 09:20:06,365 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 19/08/2025'
2025-08-19 09:20:06,557 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-19 09:20:06,558 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-19 09:20:06,559 - INFO - send_MSG:151 - Script execution finished.
2025-08-19 09:20:06,579 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-19 09:20:06,579 - INFO - Bulletin:189 - send_MSG.py executed successfully.
2025-08-19 09:20:06,579 - INFO - Bulletin:199 - Restored CWD after script execution to /home/aoumeur.
2025-08-19 09:20:06,580 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-19 09:20:06,580 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-19 09:20:06,581 - INFO - file_operations:98 - Moved 'Synop20250819-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 09:20:06,581 - INFO - file_operations:98 - Moved '20250819.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-19 09:20:06,581 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 09:20:06,581 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-19 09:20:06,581 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-19 09:20:06,582 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 09:20:06,582 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-19 09:20:06,582 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/19 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19.
2025-08-19 09:20:06,582 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 09:20:06,582 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19' exists. Removing it before copying.
2025-08-19 09:20:06,590 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/19' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/19'.
2025-08-19 09:20:06,590 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-19 09:20:06,591 - INFO - Bulletin:255 - Script finished.
2025-08-19 09:20:06,591 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-20 09:20:02,255 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-20 09:20:02,277 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 09:20:02,277 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 09:20:02,277 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-20 09:20:02,277 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-20 09:20:02,278 - INFO - Bulletin:75 - Current Day (DD): 20
2025-08-20 09:20:02,278 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:02,278 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-20 09:20:02,278 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-20 09:20:02,278 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-20 09:20:02,278 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:02,278 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-20.csv.
2025-08-20 09:20:02,278 - INFO - fetchdata:77 - Starting FTP file fetch process.
2025-08-20 09:20:02,278 - INFO - fetchdata:16 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-20 09:20:02,292 - INFO - fetchdata:19 - Successfully connected and logged in to 10.16.80.222.
2025-08-20 09:20:02,293 - INFO - fetchdata:86 - Changed remote directory to: /
2025-08-20 09:20:02,293 - INFO - fetchdata:93 - Looking for files matching pattern: 'exported_data_2025-08-20.csv'
2025-08-20 09:20:02,294 - INFO - fetchdata:97 - Local download directory: /home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:18,959 - INFO - fetchdata:106 - Found 1 files matching pattern on remote server.
2025-08-20 09:20:18,959 - INFO - fetchdata:119 - Downloading exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-20.csv
2025-08-20 09:20:19,265 - INFO - fetchdata:122 - Successfully downloaded exported_data_2025-08-20.csv
2025-08-20 09:20:19,266 - INFO - fetchdata:130 - FTP file fetch process completed.
2025-08-20 09:20:19,267 - INFO - Bulletin:121 - FTP download of exported_data_2025-08-20.csv successful.
2025-08-20 09:20:19,267 - INFO - Bulletin:126 - Moved exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-20 09:20:19,268 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-20 09:20:19,269 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-20 09:20:19,269 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-20 09:20:19,269 - INFO - Bulletin:172 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-20 09:20:19,270 - INFO - Bulletin:177 - Executing python3 csvtoxlsx.py...
2025-08-20 09:20:19,270 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 09:20:19,716 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 09:20:19,716 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:19,719 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-20.csv
2025-08-20 09:20:19,724 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-20 09:20:19,736 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 09:20:19,736 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-20 09:20:19,800 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 09:20:19,801 - INFO - Bulletin:189 - csvtoxlsx.py executed successfully.
2025-08-20 09:20:19,801 - INFO - Bulletin:177 - Executing python3 Synop24h.py...
2025-08-20 09:20:19,801 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 09:20:20,368 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 09:20:20,368 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:20,368 - INFO - Synop24h:77 - Constructed file paths:
2025-08-20 09:20:20,368 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 09:20:20,368 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 09:20:20,368 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 09:20:20,368 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 09:20:20,368 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 09:20:20,368 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-20 09:20:20,368 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 09:20:20,368 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-20 09:20:20,368 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt
2025-08-20 09:20:20,368 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 09:20:20,368 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-20 09:20:20,369 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-20 09:20:20,369 - INFO - Synop24h:115 - Today's date: 2025-08-20
2025-08-20 09:20:20,369 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-20 09:20:20,370 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-20 09:20:20,545 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr. DataFrame shape: (188, 3)
2025-08-20 09:20:20,545 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-20 09:20:20,546 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 94
2025-08-20 09:20:20,548 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (94, 2)
2025-08-20 09:20:20,548 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-20 09:20:20,548 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 09:20:20,581 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-20 09:20:20,581 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-20 09:20:20,583 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-20 09:20:20,591 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-20 09:20:20,618 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 09:20:20,618 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt. Total unique missing stations: 2
2025-08-20 09:20:20,618 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 09:20:20,682 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-20 09:20:20,682 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-20 09:20:20,684 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 09:20:20,692 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 09:20:20,719 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 09:20:20,719 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 09:20:20,740 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 09:20:20,740 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 09:20:20,761 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 09:20:20,761 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-20 09:20:20,798 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-20 09:20:20,798 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-20 09:20:20,799 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 09:20:20,799 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 09:20:20,799 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 20 Août 2025'
2025-08-20 09:20:20,800 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-20 09:20:20,800 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-20 09:20:20,801 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-20 09:20:20,980 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 09:20:20,994 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-20 09:20:20,994 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-20 09:20:21,174 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 09:20:21,188 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-20 09:20:21,202 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 09:20:21,202 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-20 09:20:21,297 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 09:20:21,297 - INFO - Bulletin:189 - Synop24h.py executed successfully.
2025-08-20 09:20:21,297 - INFO - Bulletin:177 - Executing python3 SynoClim.py...
2025-08-20 09:20:21,297 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 09:20:21,863 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 09:20:21,864 - INFO - SynoClim:66 - Configured file paths:
2025-08-20 09:20:21,864 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 09:20:21,864 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 09:20:21,864 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 09:20:21,864 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 09:20:21,864 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 09:20:21,864 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 09:20:21,864 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 09:20:21,864 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 09:20:21,864 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 09:20:21,865 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 09:20:22,039 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (188, 3)
2025-08-20 09:20:22,044 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-20 09:20:22,044 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-20 09:20:22,045 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (94, 3)
2025-08-20 09:20:22,049 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-20 09:20:22,050 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (94, 3)
2025-08-20 09:20:22,050 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 09:20:22,051 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 09:20:22,138 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-20 09:20:22,138 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-20 09:20:22,138 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 09:20:22,138 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-20 09:20:22,138 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx. Attempting to load.
2025-08-20 09:20:22,151 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-20 09:20:22,154 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-20 09:20:22,156 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,157 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,158 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,168 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,171 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,172 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,174 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,178 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,181 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,182 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,185 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,187 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,188 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,194 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,194 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,206 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,208 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,210 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,210 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,211 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,213 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,214 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,218 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,219 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,222 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,223 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,225 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,227 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-20 09:20:22,228 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 28
2025-08-20 09:20:22,228 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 09:20:22,251 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 09:20:22,251 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 09:20:22,251 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 09:20:22,251 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 09:20:22,264 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-20 09:20:22,264 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 09:20:22,264 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-20 09:20:22,264 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 09:20:22,264 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-20 09:20:22,265 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-20 09:20:23,665 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-20 09:20:23,665 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 09:20:23,677 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 09:20:23,677 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-20 09:20:23,772 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 09:20:23,772 - INFO - Bulletin:189 - SynoClim.py executed successfully.
2025-08-20 09:20:23,772 - INFO - Bulletin:177 - Executing python3 send_MSG.py...
2025-08-20 09:20:23,772 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 09:20:23,848 - ERROR - system_utils:57 - Command 'python3 send_MSG.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-20 09:20:23,848 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:20:23,848 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:20:23,848 - ERROR - Bulletin:191 - Error executing send_MSG.py: Command '['python3', 'send_MSG.py', '2025', '08', '20', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 188, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'send_MSG.py', '2025', '08', '20', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-20 09:20:23,849 - INFO - Bulletin:199 - Restored CWD after script execution to /home/aoumeur.
2025-08-20 09:20:23,849 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-20 09:20:23,849 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-20 09:20:23,850 - INFO - file_operations:98 - Moved '20250820.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 09:20:23,850 - INFO - file_operations:98 - Moved 'Synop20250820-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 09:20:23,850 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 09:20:23,850 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 09:20:23,850 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-20 09:20:23,850 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 09:20:23,850 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-20 09:20:23,850 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/20 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 09:20:23,850 - INFO - file_operations:341 - Attempting to copy directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 09:20:23,851 - INFO - file_operations:357 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20' exists. Removing it before copying.
2025-08-20 09:20:23,862 - INFO - file_operations:372 - Successfully copied directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 09:20:23,862 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-20 09:20:23,862 - INFO - Bulletin:255 - Script finished.
2025-08-20 09:20:23,862 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-20 15:20:26,015 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-20 15:20:26,015 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:20:26,015 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:20:26,016 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-20 15:20:26,016 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-20 15:20:26,016 - INFO - Bulletin:75 - Current Day (DD): 20
2025-08-20 15:20:26,016 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:20:26,016 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-20 15:20:26,016 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-20 15:20:26,016 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-20 15:20:26,016 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:20:26,016 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-20.csv.
2025-08-20 15:20:26,016 - ERROR - Bulletin:132 - An error occurred during FTP operations: fetch_remote_files() got an unexpected keyword argument 'remote_base_dir'
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 108, in main
    fetch_remote_files(
TypeError: fetch_remote_files() got an unexpected keyword argument 'remote_base_dir'
2025-08-20 15:20:26,016 - INFO - Bulletin:145 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-20 15:20:26,017 - INFO - Bulletin:152 - BUFR Synop file copy successful.
2025-08-20 15:20:26,017 - INFO - Bulletin:166 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-20 15:20:26,017 - ERROR - Bulletin:193 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-20 15:20:26,017 - INFO - Bulletin:204 - Starting post-processing and cleanup operations.
2025-08-20 15:20:26,017 - INFO - Bulletin:208 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-20 15:20:26,017 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/bqrm/BQCP24h'.
2025-08-20 15:20:26,017 - INFO - Bulletin:211 - No *.txt files found to move or all failed.
2025-08-20 15:20:26,018 - INFO - Bulletin:214 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:20:26,018 - INFO - Bulletin:218 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:20:26,018 - INFO - Bulletin:223 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-20 15:20:26,018 - INFO - Bulletin:229 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:20:26,018 - INFO - Bulletin:233 - Backup directories created successfully.
2025-08-20 15:20:26,018 - INFO - Bulletin:241 - Copying SMAL* data from /bqrm_data/observations/2025/08/20 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:20:26,018 - INFO - file_operations:342 - Attempting to copy directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:20:26,018 - INFO - file_operations:358 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20' exists. Removing it before copying.
2025-08-20 15:20:26,021 - INFO - file_operations:373 - Successfully copied directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:20:26,022 - INFO - Bulletin:249 - TAC data copy to backup successful.
2025-08-20 15:20:26,022 - INFO - Bulletin:255 - Script finished.
2025-08-20 15:20:26,022 - INFO - Bulletin:269 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-20 15:23:30,690 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-20 15:23:30,690 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:23:30,690 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:23:30,690 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-20 15:23:30,690 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-20 15:23:30,691 - INFO - Bulletin:75 - Current Day (DD): 20
2025-08-20 15:23:30,691 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:23:30,691 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-20 15:23:30,691 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-20 15:23:30,691 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-20 15:23:30,691 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:23:30,691 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-20.csv.
2025-08-20 15:23:30,691 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-20 15:23:30,691 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-20 15:23:30,794 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-20 15:23:30,794 - INFO - fetchdata:227 - Local file exported_data_2025-08-20.csv is missing. Downloading.
2025-08-20 15:23:30,795 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-20.csv
2025-08-20 15:23:31,223 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-20.csv
2025-08-20 15:23:31,224 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:23:31,224 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:23:31,225 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-20.csv successful.
2025-08-20 15:23:31,225 - INFO - Bulletin:133 - Moved exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-20 15:23:31,226 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-20 15:23:31,227 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-20 15:23:31,227 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-20 15:23:31,227 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-20 15:23:31,228 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-20 15:23:31,228 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:23:31,637 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:23:31,637 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:23:31,640 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-20.csv
2025-08-20 15:23:31,644 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-20 15:23:31,656 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 15:23:31,656 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-20 15:23:31,717 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:23:31,717 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-20 15:23:31,717 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-20 15:23:31,717 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:23:32,257 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:23:32,257 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:23:32,258 - INFO - Synop24h:77 - Constructed file paths:
2025-08-20 15:23:32,258 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:23:32,258 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 15:23:32,258 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 15:23:32,258 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:23:32,258 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:23:32,258 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-20 15:23:32,258 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 15:23:32,258 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-20 15:23:32,258 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt
2025-08-20 15:23:32,258 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 15:23:32,258 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-20 15:23:32,258 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-20 15:23:32,259 - INFO - Synop24h:115 - Today's date: 2025-08-20
2025-08-20 15:23:32,259 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-20 15:23:32,259 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-20 15:23:32,426 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr. DataFrame shape: (188, 3)
2025-08-20 15:23:32,426 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-20 15:23:32,427 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 94
2025-08-20 15:23:32,429 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (94, 2)
2025-08-20 15:23:32,429 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-20 15:23:32,429 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 15:23:32,449 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-20 15:23:32,450 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-20 15:23:32,451 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-20 15:23:32,459 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-20 15:23:32,485 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:23:32,485 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt. Total unique missing stations: 2
2025-08-20 15:23:32,485 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 15:23:32,505 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-20 15:23:32,505 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-20 15:23:32,506 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 15:23:32,514 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 15:23:32,540 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:23:32,540 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:23:32,560 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 15:23:32,560 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:23:32,580 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 15:23:32,580 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-20 15:23:32,589 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-20 15:23:32,589 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-20 15:23:32,589 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 15:23:32,589 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 15:23:32,589 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 20 Août 2025'
2025-08-20 15:23:32,591 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-20 15:23:32,591 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-20 15:23:32,591 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-20 15:23:32,757 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 15:23:32,770 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-20 15:23:32,770 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-20 15:23:32,936 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 15:23:32,949 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-20 15:23:32,962 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 15:23:32,962 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-20 15:23:33,052 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:23:33,053 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-20 15:23:33,053 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-20 15:23:33,053 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:23:33,593 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:23:33,593 - INFO - SynoClim:66 - Configured file paths:
2025-08-20 15:23:33,593 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:23:33,593 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:23:33,593 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:23:33,593 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 15:23:33,594 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:23:33,594 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:23:33,594 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 15:23:33,594 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 15:23:33,594 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 15:23:33,595 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:23:33,760 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (188, 3)
2025-08-20 15:23:33,765 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-20 15:23:33,765 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-20 15:23:33,766 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (94, 3)
2025-08-20 15:23:33,770 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-20 15:23:33,771 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (94, 3)
2025-08-20 15:23:33,771 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:23:33,771 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:23:33,853 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-20 15:23:33,854 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-20 15:23:33,854 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 15:23:33,854 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-20 15:23:33,854 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx. Attempting to load.
2025-08-20 15:23:33,866 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-20 15:23:33,869 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-20 15:23:33,871 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,872 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,873 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,882 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,885 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,886 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,888 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,892 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,895 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,896 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,898 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,901 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,901 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,907 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,907 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,919 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,920 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,922 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,923 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,923 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,925 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,926 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,930 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,931 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,934 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,935 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,937 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,938 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-20 15:23:33,939 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 28
2025-08-20 15:23:33,940 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:23:33,962 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:23:33,962 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:23:33,962 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:23:33,962 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 15:23:33,974 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-20 15:23:33,974 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 15:23:33,975 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-20 15:23:33,975 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 15:23:33,975 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-20 15:23:33,976 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-20 15:23:35,396 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-20 15:23:35,396 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:23:35,409 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:23:35,409 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-20 15:23:35,499 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:23:35,500 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-20 15:23:35,500 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-20 15:23:35,500 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:23:35,569 - ERROR - system_utils:57 - Command 'python3 send_MSG.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h' failed with exit code 1.
2025-08-20 15:23:35,569 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:23:35,569 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:23:35,570 - ERROR - Bulletin:198 - Error executing send_MSG.py: Command '['python3', 'send_MSG.py', '2025', '08', '20', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BQCP24h/Bulletin.py", line 195, in main
    execute_command(command_to_execute, cwd=LOCAL_DIRECTORY)
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['python3', 'send_MSG.py', '2025', '08', '20', '/home/aoumeur/bqrm/BQCP24h']' returned non-zero exit status 1.
2025-08-20 15:23:35,570 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-20 15:23:35,570 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-20 15:23:35,571 - INFO - file_operations:98 - Moved '20250820.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 15:23:35,571 - INFO - file_operations:98 - Moved 'Synop20250820-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 15:23:35,571 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:23:35,571 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:23:35,571 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-20 15:23:35,571 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:23:35,571 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-20 15:23:35,572 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/20 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:23:35,572 - INFO - file_operations:342 - Attempting to copy directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:23:35,572 - INFO - file_operations:358 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20' exists. Removing it before copying.
2025-08-20 15:23:35,575 - INFO - file_operations:373 - Successfully copied directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:23:35,575 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-20 15:23:35,575 - INFO - Bulletin:262 - Script finished.
2025-08-20 15:23:35,575 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-20 15:24:28,895 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-20 15:24:28,895 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:28,895 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:28,895 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-20 15:24:28,895 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-20 15:24:28,895 - INFO - Bulletin:75 - Current Day (DD): 20
2025-08-20 15:24:28,895 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:24:28,895 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-20 15:24:28,895 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-20 15:24:28,895 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-20 15:24:28,895 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-20 15:24:28,895 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-20.csv.
2025-08-20 15:24:28,896 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-20 15:24:28,896 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-20 15:24:28,900 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-20 15:24:28,900 - INFO - fetchdata:227 - Local file exported_data_2025-08-20.csv is missing. Downloading.
2025-08-20 15:24:28,900 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-20.csv
2025-08-20 15:24:28,904 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-20.csv
2025-08-20 15:24:28,905 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:24:28,905 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:24:28,905 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-20.csv successful.
2025-08-20 15:24:28,905 - INFO - Bulletin:133 - Moved exported_data_2025-08-20.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-20 15:24:28,906 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-20 15:24:28,906 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-20 15:24:28,906 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-20 15:24:28,906 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-20 15:24:28,906 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-20 15:24:28,906 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:24:29,311 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:29,311 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:24:29,314 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-20.csv
2025-08-20 15:24:29,319 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-20 15:24:29,330 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 15:24:29,330 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-20 15:24:29,391 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:24:29,391 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-20 15:24:29,391 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-20 15:24:29,391 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:24:29,934 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:29,934 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:24:29,934 - INFO - Synop24h:77 - Constructed file paths:
2025-08-20 15:24:29,934 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:24:29,934 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 15:24:29,934 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 15:24:29,934 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:24:29,934 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:24:29,934 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-20 15:24:29,934 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 15:24:29,934 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-20 15:24:29,934 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt
2025-08-20 15:24:29,934 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 15:24:29,935 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-20 15:24:29,935 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-20 15:24:29,935 - INFO - Synop24h:115 - Today's date: 2025-08-20
2025-08-20 15:24:29,935 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-20 15:24:29,936 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-20 15:24:30,103 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr. DataFrame shape: (188, 3)
2025-08-20 15:24:30,103 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-20 15:24:30,104 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 94
2025-08-20 15:24:30,105 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (94, 2)
2025-08-20 15:24:30,106 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-20 15:24:30,106 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-20 15:24:30,126 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-20 15:24:30,126 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-20 15:24:30,128 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-20 15:24:30,136 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-20 15:24:30,162 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:24:30,162 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250820-06.txt. Total unique missing stations: 2
2025-08-20 15:24:30,162 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-20 15:24:30,181 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-20 15:24:30,182 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-20 15:24:30,183 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 15:24:30,191 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-20 15:24:30,218 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:24:30,218 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx
2025-08-20 15:24:30,238 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 15:24:30,238 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx
2025-08-20 15:24:30,258 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08200600.xlsx, active sheet: 'Feuille1'
2025-08-20 15:24:30,258 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-20 15:24:30,267 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-20 15:24:30,267 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-20 15:24:30,267 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 15:24:30,267 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 15:24:30,268 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 20 Août 2025'
2025-08-20 15:24:30,269 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-20 15:24:30,269 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-20 15:24:30,269 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-20 15:24:30,442 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 15:24:30,455 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-20 15:24:30,456 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-20 15:24:30,624 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-20 15:24:30,637 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-20 15:24:30,650 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 15:24:30,650 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-20 15:24:30,741 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:24:30,741 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-20 15:24:30,741 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-20 15:24:30,741 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:24:31,284 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=20, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-20 15:24:31,284 - INFO - SynoClim:66 - Configured file paths:
2025-08-20 15:24:31,284 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:24:31,284 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:24:31,284 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:24:31,284 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 15:24:31,284 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:24:31,284 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:24:31,284 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 15:24:31,284 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx
2025-08-20 15:24:31,284 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-20 15:24:31,285 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508200600.bufr
2025-08-20 15:24:31,452 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (188, 3)
2025-08-20 15:24:31,457 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-20 15:24:31,457 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-20 15:24:31,458 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (94, 3)
2025-08-20 15:24:31,462 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-20 15:24:31,463 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (94, 3)
2025-08-20 15:24:31,463 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:24:31,463 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-20 15:24:31,546 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-20 15:24:31,546 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-20 15:24:31,546 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-20 15:24:31,547 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-20 15:24:31,547 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-20.xlsx. Attempting to load.
2025-08-20 15:24:31,559 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-20 15:24:31,562 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-20 15:24:31,563 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,564 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,565 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,575 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,578 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,579 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,581 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,585 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,588 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,589 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,591 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,594 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,595 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,600 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,601 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,612 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,614 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,616 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,616 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,617 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,618 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,620 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,625 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,625 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,629 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,630 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,632 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,633 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-20 15:24:31,634 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 28
2025-08-20 15:24:31,634 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:24:31,657 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025200600.xlsx
2025-08-20 15:24:31,657 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:24:31,657 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250820.txt
2025-08-20 15:24:31,657 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-20 15:24:31,669 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-20 15:24:31,669 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-20 15:24:31,670 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-20 15:24:31,670 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 19 Août 2025 à 06h au 20 Août 2025 à 06h.'
2025-08-20 15:24:31,670 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-20 15:24:31,671 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-20 15:24:33,066 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-20 15:24:33,066 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:24:33,078 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:24:33,078 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-20 15:24:33,168 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:24:33,168 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-20 15:24:33,168 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-20 15:24:33,169 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 20 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-20 15:24:33,232 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:33,232 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-20 15:24:33,232 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-20 15:24:33,232 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:24:33,232 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08200600.docx
2025-08-20 15:24:33,232 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08200600.docx
2025-08-20 15:24:33,233 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 20/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-20 15:24:33,233 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 20/08/2025'
2025-08-20 15:24:33,479 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-20 15:24:33,481 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-20 15:24:33,481 - INFO - send_MSG:151 - Script execution finished.
2025-08-20 15:24:33,507 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-20 15:24:33,508 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-20 15:24:33,508 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-20 15:24:33,508 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-20 15:24:33,509 - INFO - file_operations:98 - Moved '20250820.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 15:24:33,509 - INFO - file_operations:98 - Moved 'Synop20250820-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-20 15:24:33,510 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:24:33,510 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-20 15:24:33,510 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-20 15:24:33,510 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:24:33,510 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-20 15:24:33,510 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/20 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20.
2025-08-20 15:24:33,511 - INFO - file_operations:342 - Attempting to copy directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:24:33,511 - INFO - file_operations:358 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20' exists. Removing it before copying.
2025-08-20 15:24:33,515 - INFO - file_operations:373 - Successfully copied directory from '/bqrm_data/observations/2025/08/20' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/20'.
2025-08-20 15:24:33,515 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-20 15:24:33,515 - INFO - Bulletin:262 - Script finished.
2025-08-20 15:24:33,515 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-21 09:20:02,149 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-21 09:20:02,164 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:02,164 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:02,164 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-21 09:20:02,164 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-21 09:20:02,165 - INFO - Bulletin:75 - Current Day (DD): 21
2025-08-21 09:20:02,165 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/bqrm/BQCP24h
2025-08-21 09:20:02,165 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-21 09:20:02,165 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-21 09:20:02,165 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-21 09:20:02,165 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/bqrm/BQCP24h
2025-08-21 09:20:02,165 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-21.csv.
2025-08-21 09:20:02,165 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-21 09:20:02,165 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-21 09:20:03,203 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-21 09:20:03,204 - INFO - fetchdata:227 - Local file exported_data_2025-08-21.csv is missing. Downloading.
2025-08-21 09:20:03,204 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-21.csv to /home/aoumeur/bqrm/BQCP24h/exported_data_2025-08-21.csv
2025-08-21 09:20:03,433 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-21.csv
2025-08-21 09:20:03,435 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 09:20:03,435 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 09:20:03,435 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-21.csv successful.
2025-08-21 09:20:03,436 - INFO - Bulletin:133 - Moved exported_data_2025-08-21.csv to /home/aoumeur/bqrm/BQCP24h/Clim.
2025-08-21 09:20:03,436 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/bqrm/bufr_data/observations/2025/08/21/Synop_202508210600.bufr to /home/aoumeur/bqrm/BQCP24h/Synop.
2025-08-21 09:20:03,437 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-21 09:20:03,437 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/bqrm/BQCP24h for Python script execution.
2025-08-21 09:20:03,438 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-21 09:20:03,438 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-21 09:20:03,438 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 21 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-21 09:20:03,879 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:03,879 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-21 09:20:03,882 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/bqrm/BQCP24h/Clim/exported_data_2025-08-21.csv
2025-08-21 09:20:03,887 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-21 09:20:03,899 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-21.xlsx
2025-08-21 09:20:03,899 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-21 09:20:03,966 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 09:20:03,966 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-21 09:20:03,967 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-21 09:20:03,967 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 21 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-21 09:20:04,529 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:04,529 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-21 09:20:04,529 - INFO - Synop24h:77 - Constructed file paths:
2025-08-21 09:20:04,529 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 09:20:04,529 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-21 09:20:04,529 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-21 09:20:04,530 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/bqrm/BQCP24h/cumul24_08210600.xlsx
2025-08-21 09:20:04,530 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/bqrm/BQCP24h/agricole_08210600.xlsx
2025-08-21 09:20:04,530 - INFO - Synop24h:83 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx
2025-08-21 09:20:04,530 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/bqrm/BQCP24h/Cumul_table08210600.docx
2025-08-21 09:20:04,530 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/bqrm/BQCP24h/ListStation.json
2025-08-21 09:20:04,530 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/bqrm/BQCP24h/Synop20250821-06.txt
2025-08-21 09:20:04,530 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-21 09:20:04,530 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json...
2025-08-21 09:20:04,530 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/bqrm/BQCP24h/ListStation.json. Found 68 stations.
2025-08-21 09:20:04,530 - INFO - Synop24h:115 - Today's date: 2025-08-21
2025-08-21 09:20:04,530 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-21 09:20:04,531 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508210600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-21 09:20:04,706 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508210600.bufr. DataFrame shape: (192, 3)
2025-08-21 09:20:04,707 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-21 09:20:04,707 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 96
2025-08-21 09:20:04,709 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (96, 2)
2025-08-21 09:20:04,709 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-21 09:20:04,709 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx
2025-08-21 09:20:04,730 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-21 09:20:04,730 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-21 09:20:04,731 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-21 09:20:04,739 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-21 09:20:04,765 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/cumul24_08210600.xlsx
2025-08-21 09:20:04,766 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/bqrm/BQCP24h/Synop20250821-06.txt. Total unique missing stations: 2
2025-08-21 09:20:04,766 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx
2025-08-21 09:20:04,785 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-21 09:20:04,785 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-21 09:20:04,787 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-21 09:20:04,795 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-21 09:20:04,821 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/bqrm/BQCP24h/agricole_08210600.xlsx
2025-08-21 09:20:04,821 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08210600.xlsx
2025-08-21 09:20:04,841 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/cumul24_08210600.xlsx, active sheet: 'Feuille1'
2025-08-21 09:20:04,841 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08210600.xlsx
2025-08-21 09:20:04,861 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/agricole_08210600.xlsx, active sheet: 'Feuille1'
2025-08-21 09:20:04,861 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/bqrm/BQCP24h/templates/cumul.docx...
2025-08-21 09:20:04,870 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-21 09:20:04,870 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json...
2025-08-21 09:20:04,870 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-21 09:20:04,870 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 20 Août 2025 à 06h au 21 Août 2025 à 06h.'
2025-08-21 09:20:04,870 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 21 Août 2025'
2025-08-21 09:20:04,872 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-21 09:20:04,872 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-21 09:20:04,872 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-21 09:20:05,042 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-21 09:20:05,055 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-21 09:20:05,055 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-21 09:20:05,225 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-21 09:20:05,238 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-21 09:20:05,251 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/bqrm/BQCP24h/Cumul_table08210600.docx
2025-08-21 09:20:05,251 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-21 09:20:05,341 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 09:20:05,342 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-21 09:20:05,342 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-21 09:20:05,342 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 21 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-21 09:20:05,888 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/bqrm/BQCP24h
2025-08-21 09:20:05,888 - INFO - SynoClim:66 - Configured file paths:
2025-08-21 09:20:05,888 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 09:20:05,888 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-21 09:20:05,888 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 09:20:05,888 - INFO - SynoClim:70 -   Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-21 09:20:05,888 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 09:20:05,888 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/bqrm/BQCP24h/20250821.txt
2025-08-21 09:20:05,888 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-21 09:20:05,888 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-21.xlsx
2025-08-21 09:20:05,888 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/bqrm/BQCP24h/month_translation.json
2025-08-21 09:20:05,889 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/bqrm/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 09:20:06,061 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (192, 3)
2025-08-21 09:20:06,065 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-21 09:20:06,066 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-21 09:20:06,066 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (96, 3)
2025-08-21 09:20:06,070 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-21 09:20:06,071 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (96, 3)
2025-08-21 09:20:06,072 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-21 09:20:06,072 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx
2025-08-21 09:20:06,155 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-21 09:20:06,155 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-21 09:20:06,156 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/bqrm/BQCP24h/climaticstations.json
2025-08-21 09:20:06,156 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-21 09:20:06,156 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/bqrm/BQCP24h/Climxlsx/data_2025-08-21.xlsx. Attempting to load.
2025-08-21 09:20:06,168 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-21 09:20:06,171 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-21 09:20:06,173 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,174 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,175 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,185 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,188 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,189 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,195 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,198 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,199 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,201 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,204 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,204 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,210 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,211 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,222 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,224 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,226 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,226 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,227 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,229 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,230 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,234 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,235 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,238 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,239 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,241 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,243 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-21 09:20:06,244 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 27
2025-08-21 09:20:06,244 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 09:20:06,266 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/bqrm/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 09:20:06,266 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/bqrm/BQCP24h/20250821.txt
2025-08-21 09:20:06,266 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/bqrm/BQCP24h/20250821.txt
2025-08-21 09:20:06,266 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/bqrm/BQCP24h/templates/doc_template.docx
2025-08-21 09:20:06,278 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-21 09:20:06,279 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/bqrm/BQCP24h/month_translation.json.
2025-08-21 09:20:06,279 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-21 09:20:06,279 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 20 Août 2025 à 06h au 21 Août 2025 à 06h.'
2025-08-21 09:20:06,279 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-21 09:20:06,280 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-21 09:20:07,628 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-21 09:20:07,628 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 09:20:07,639 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 09:20:07,639 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-21 09:20:07,730 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 09:20:07,730 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-21 09:20:07,730 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-21 09:20:07,730 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 21 /home/aoumeur/bqrm/BQCP24h in directory: '/home/aoumeur/bqrm/BQCP24h'
2025-08-21 09:20:07,791 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:07,791 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/bqrm/BQCP24h/logs/BQCP24h.log
2025-08-21 09:20:07,791 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-21 09:20:07,791 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 09:20:07,792 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/Cumul_table08210600.docx
2025-08-21 09:20:07,792 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/bqrm/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 09:20:07,792 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 21/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-21 09:20:07,792 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 21/08/2025'
2025-08-21 09:20:08,040 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-21 09:20:08,043 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-21 09:20:08,043 - INFO - send_MSG:151 - Script execution finished.
2025-08-21 09:20:08,055 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 09:20:08,056 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-21 09:20:08,056 - INFO - Bulletin:206 - Restored CWD after script execution to /home/aoumeur.
2025-08-21 09:20:08,056 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-21 09:20:08,056 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/bqrm/BQCP24h/txt/2025/08.
2025-08-21 09:20:08,056 - INFO - file_operations:98 - Moved '20250821.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-21 09:20:08,056 - INFO - file_operations:98 - Moved 'Synop20250821-06.txt' to '/home/aoumeur/bqrm/BQCP24h/txt/2025/08'.
2025-08-21 09:20:08,056 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-21 09:20:08,057 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h (Pattern: *.xlsx)
2025-08-21 09:20:08,057 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 3 files from /home/aoumeur/bqrm/BQCP24h.
2025-08-21 09:20:08,057 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/bqrm/BQCP24h.
2025-08-21 09:20:08,057 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h (Pattern: *.docx)
2025-08-21 09:20:08,058 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/bqrm/BQCP24h.
2025-08-21 09:20:08,058 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-21 09:20:08,058 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-21 09:20:08,058 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 9 files from /home/aoumeur/bqrm/BQCP24h/Climxlsx.
2025-08-21 09:20:08,059 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/bqrm/BQCP24h/Backup/2025/08 and /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/21.
2025-08-21 09:20:08,059 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-21 09:20:08,059 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/21 to /home/aoumeur/bqrm/BQCP24h/Backup/2025/08/21.
2025-08-21 09:20:08,059 - INFO - file_operations:342 - Attempting to copy directory from '/bqrm_data/observations/2025/08/21' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/21'.
2025-08-21 09:20:08,059 - INFO - file_operations:358 - Destination directory '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/21' exists. Removing it before copying.
2025-08-21 09:20:08,098 - INFO - file_operations:373 - Successfully copied directory from '/bqrm_data/observations/2025/08/21' to '/home/aoumeur/bqrm/BQCP24h/Backup/2025/08/21'.
2025-08-21 09:20:08,098 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-21 09:20:08,098 - INFO - Bulletin:262 - Script finished.
2025-08-21 09:20:08,099 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-21 11:45:19,759 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-21 11:45:19,759 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:19,759 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:19,759 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-21 11:45:19,759 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-21 11:45:19,759 - INFO - Bulletin:75 - Current Day (DD): 21
2025-08-21 11:45:19,759 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/BQRM_V01/BQCP24h
2025-08-21 11:45:19,759 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-21 11:45:19,759 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-21 11:45:19,759 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-21 11:45:19,759 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/BQRM_V01/BQCP24h
2025-08-21 11:45:19,759 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-21.csv.
2025-08-21 11:45:19,759 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-21 11:45:19,760 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-21 11:45:20,057 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-21 11:45:20,057 - INFO - fetchdata:227 - Local file exported_data_2025-08-21.csv is missing. Downloading.
2025-08-21 11:45:20,057 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-21.csv to /home/aoumeur/BQRM_V01/BQCP24h/exported_data_2025-08-21.csv
2025-08-21 11:45:20,157 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-21.csv
2025-08-21 11:45:20,179 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 11:45:20,179 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 11:45:20,180 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-21.csv successful.
2025-08-21 11:45:20,180 - INFO - Bulletin:133 - Moved exported_data_2025-08-21.csv to /home/aoumeur/BQRM_V01/BQCP24h/Clim.
2025-08-21 11:45:20,180 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/21/Synop_202508210600.bufr to /home/aoumeur/BQRM_V01/BQCP24h/Synop.
2025-08-21 11:45:20,180 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-21 11:45:20,180 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/BQRM_V01/BQCP24h for Python script execution.
2025-08-21 11:45:20,181 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-21 11:45:20,181 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-21 11:45:20,181 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 21 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-21 11:45:20,696 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:20,696 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-21 11:45:20,699 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/BQRM_V01/BQCP24h/Clim/exported_data_2025-08-21.csv
2025-08-21 11:45:20,704 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-21 11:45:20,716 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-21.xlsx
2025-08-21 11:45:20,716 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-21 11:45:20,790 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 11:45:20,790 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-21 11:45:20,790 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-21 11:45:20,790 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 21 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-21 11:45:21,428 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:21,428 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-21 11:45:21,428 - INFO - Synop24h:77 - Constructed file paths:
2025-08-21 11:45:21,429 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 11:45:21,429 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-21 11:45:21,429 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-21 11:45:21,429 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08210600.xlsx
2025-08-21 11:45:21,429 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08210600.xlsx
2025-08-21 11:45:21,429 - INFO - Synop24h:83 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx
2025-08-21 11:45:21,429 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08210600.docx
2025-08-21 11:45:21,429 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json
2025-08-21 11:45:21,429 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/BQRM_V01/BQCP24h/Synop20250821-06.txt
2025-08-21 11:45:21,429 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-21 11:45:21,429 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json...
2025-08-21 11:45:21,429 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json. Found 68 stations.
2025-08-21 11:45:21,429 - INFO - Synop24h:115 - Today's date: 2025-08-21
2025-08-21 11:45:21,430 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-21 11:45:21,430 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508210600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-21 11:45:21,623 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508210600.bufr. DataFrame shape: (192, 3)
2025-08-21 11:45:21,624 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-21 11:45:21,624 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 96
2025-08-21 11:45:21,626 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (96, 2)
2025-08-21 11:45:21,627 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-21 11:45:21,627 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-21 11:45:21,648 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-21 11:45:21,648 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-21 11:45:21,650 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-21 11:45:21,659 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-21 11:45:21,686 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08210600.xlsx
2025-08-21 11:45:21,686 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/BQRM_V01/BQCP24h/Synop20250821-06.txt. Total unique missing stations: 2
2025-08-21 11:45:21,686 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-21 11:45:21,708 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-21 11:45:21,708 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-21 11:45:21,710 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-21 11:45:21,718 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-21 11:45:21,746 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/agricole_08210600.xlsx
2025-08-21 11:45:21,746 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08210600.xlsx
2025-08-21 11:45:21,767 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08210600.xlsx, active sheet: 'Feuille1'
2025-08-21 11:45:21,767 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08210600.xlsx
2025-08-21 11:45:21,790 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08210600.xlsx, active sheet: 'Feuille1'
2025-08-21 11:45:21,790 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx...
2025-08-21 11:45:21,800 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-21 11:45:21,800 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json...
2025-08-21 11:45:21,800 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-21 11:45:21,800 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 20 Août 2025 à 06h au 21 Août 2025 à 06h.'
2025-08-21 11:45:21,800 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 21 Août 2025'
2025-08-21 11:45:21,802 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-21 11:45:21,802 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-21 11:45:21,803 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-21 11:45:21,989 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-21 11:45:22,002 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-21 11:45:22,002 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-21 11:45:22,179 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-21 11:45:22,192 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-21 11:45:22,206 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08210600.docx
2025-08-21 11:45:22,206 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-21 11:45:22,305 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 11:45:22,306 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-21 11:45:22,306 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-21 11:45:22,306 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 21 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-21 11:45:22,888 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=21, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-21 11:45:22,888 - INFO - SynoClim:66 - Configured file paths:
2025-08-21 11:45:22,888 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 11:45:22,888 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-21 11:45:22,888 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 11:45:22,888 - INFO - SynoClim:70 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-21 11:45:22,888 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 11:45:22,888 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/BQRM_V01/BQCP24h/20250821.txt
2025-08-21 11:45:22,888 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-21 11:45:22,888 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-21.xlsx
2025-08-21 11:45:22,888 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-21 11:45:22,889 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508210600.bufr
2025-08-21 11:45:23,069 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (192, 3)
2025-08-21 11:45:23,074 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-21 11:45:23,074 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-21 11:45:23,075 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (96, 3)
2025-08-21 11:45:23,079 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-21 11:45:23,080 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (96, 3)
2025-08-21 11:45:23,081 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-21 11:45:23,081 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-21 11:45:23,166 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-21 11:45:23,166 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-21 11:45:23,166 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-21 11:45:23,166 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-21 11:45:23,167 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-21.xlsx. Attempting to load.
2025-08-21 11:45:23,179 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-21 11:45:23,183 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-21 11:45:23,184 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,186 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,187 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,197 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,200 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,201 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,207 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,210 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,212 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,214 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,217 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,218 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,224 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,224 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,236 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,238 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,240 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,241 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,241 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,243 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,244 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,249 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,250 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,253 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,254 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,256 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,258 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-21 11:45:23,259 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 27
2025-08-21 11:45:23,259 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 11:45:23,367 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025210600.xlsx
2025-08-21 11:45:23,367 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/BQRM_V01/BQCP24h/20250821.txt
2025-08-21 11:45:23,368 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/BQRM_V01/BQCP24h/20250821.txt
2025-08-21 11:45:23,368 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-21 11:45:23,383 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-21 11:45:23,383 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-21 11:45:23,383 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-21 11:45:23,383 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 20 Août 2025 à 06h au 21 Août 2025 à 06h.'
2025-08-21 11:45:23,384 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-21 11:45:23,385 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-21 11:45:24,831 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-21 11:45:24,831 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 11:45:24,842 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 11:45:24,842 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-21 11:45:24,935 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 11:45:24,935 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-21 11:45:24,935 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-21 11:45:24,935 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 21 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-21 11:45:24,998 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:24,998 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-21 11:45:24,998 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-21 11:45:24,999 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:45:24,999 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08210600.docx
2025-08-21 11:45:24,999 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08210600.docx
2025-08-21 11:45:24,999 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 21/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-21 11:45:24,999 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 21/08/2025'
2025-08-21 11:45:25,276 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-21 11:45:25,279 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-21 11:45:25,279 - INFO - send_MSG:151 - Script execution finished.
2025-08-21 11:45:25,308 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-21 11:45:25,309 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-21 11:45:25,309 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-21 11:45:25,309 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08.
2025-08-21 11:45:25,310 - INFO - file_operations:98 - Moved '20250821.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-21 11:45:25,311 - INFO - file_operations:98 - Moved 'Synop20250821-06.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-21 11:45:25,311 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-21 11:45:25,312 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.xlsx)
2025-08-21 11:45:25,313 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 3 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-21 11:45:25,313 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-21 11:45:25,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.docx)
2025-08-21 11:45:25,314 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-21 11:45:25,314 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-21 11:45:25,315 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-21 11:45:25,315 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 1 files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-21 11:45:25,315 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08 and /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/21.
2025-08-21 11:45:25,315 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-21 11:45:25,315 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/21 to /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/21.
2025-08-21 11:45:25,315 - INFO - file_operations:342 - Attempting to copy directory from '/bqrm_data/observations/2025/08/21' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/21'.
2025-08-21 11:45:25,315 - INFO - file_operations:358 - Destination directory '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/21' exists. Removing it before copying.
2025-08-21 11:45:25,319 - INFO - file_operations:373 - Successfully copied directory from '/bqrm_data/observations/2025/08/21' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/21'.
2025-08-21 11:45:25,319 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-21 11:45:25,319 - INFO - Bulletin:262 - Script finished.
2025-08-21 11:45:25,319 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-25 09:03:28,451 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-25 09:03:28,465 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:03:28,465 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:03:28,466 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-25 09:03:28,466 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-25 09:03:28,466 - INFO - Bulletin:75 - Current Day (DD): 25
2025-08-25 09:03:28,466 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:03:28,466 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-25 09:03:28,466 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-25 09:03:28,466 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-25 09:03:28,466 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:03:28,466 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-25.csv.
2025-08-25 09:03:28,466 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-25 09:03:28,466 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-25 09:03:28,517 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-25 09:03:28,518 - INFO - fetchdata:227 - Local file exported_data_2025-08-25.csv is missing. Downloading.
2025-08-25 09:03:28,518 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/exported_data_2025-08-25.csv
2025-08-25 09:03:28,613 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-25.csv
2025-08-25 09:03:28,614 - INFO - fetchdata:257 - FTP client closed.
2025-08-25 09:03:28,615 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-25 09:03:28,615 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-25.csv successful.
2025-08-25 09:03:28,616 - INFO - Bulletin:133 - Moved exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/Clim.
2025-08-25 09:03:28,616 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr to /home/aoumeur/BQRM_V01/BQCP24h/Synop.
2025-08-25 09:03:28,617 - WARNING - file_operations:242 - File not found: /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr. Skipping this operation.
2025-08-25 09:03:28,617 - ERROR - Bulletin:162 - BUFR Synop file not found at source: /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr. Skipping copy.
2025-08-25 09:03:28,617 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/BQRM_V01/BQCP24h for Python script execution.
2025-08-25 09:03:28,617 - ERROR - Bulletin:200 - Skipping Python script execution due to previous failures (FTP download or BUFR file copy).
2025-08-25 09:03:28,617 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-25 09:03:28,618 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08.
2025-08-25 09:03:28,619 - INFO - file_operations:90 - No files found matching pattern '*.txt' in '/home/aoumeur/BQRM_V01/BQCP24h'.
2025-08-25 09:03:28,619 - INFO - Bulletin:218 - No *.txt files found to move or all failed.
2025-08-25 09:03:28,619 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:03:28,619 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.xlsx)
2025-08-25 09:03:28,621 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 0 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:03:28,621 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:03:28,621 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.docx)
2025-08-25 09:03:28,623 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 0 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:03:28,623 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 09:03:28,626 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-25 09:03:28,626 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 0 files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 09:03:28,626 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08 and /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 09:03:28,627 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-25 09:03:28,627 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/25 to /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 09:03:28,628 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 09:03:28,628 - INFO - file_operations:355 - Destination directory '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25' exists. Removing it before copying.
2025-08-25 09:03:28,630 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 09:03:28,630 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-25 09:03:28,630 - INFO - Bulletin:262 - Script finished.
2025-08-25 09:03:28,631 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-25 09:04:31,369 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-25 09:04:31,369 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:31,370 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:31,370 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-25 09:04:31,370 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-25 09:04:31,370 - INFO - Bulletin:75 - Current Day (DD): 25
2025-08-25 09:04:31,370 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:04:31,370 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-25 09:04:31,370 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-25 09:04:31,370 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-25 09:04:31,370 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:04:31,370 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-25.csv.
2025-08-25 09:04:31,370 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-25 09:04:31,370 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-25 09:04:34,393 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-25 09:04:34,394 - INFO - fetchdata:227 - Local file exported_data_2025-08-25.csv is missing. Downloading.
2025-08-25 09:04:34,394 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/exported_data_2025-08-25.csv
2025-08-25 09:04:34,399 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-25.csv
2025-08-25 09:04:34,400 - INFO - fetchdata:257 - FTP client closed.
2025-08-25 09:04:34,400 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-25 09:04:34,401 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-25.csv successful.
2025-08-25 09:04:34,401 - INFO - Bulletin:133 - Moved exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/Clim.
2025-08-25 09:04:34,402 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr to /home/aoumeur/BQRM_V01/BQCP24h/Synop.
2025-08-25 09:04:34,403 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-25 09:04:34,403 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/BQRM_V01/BQCP24h for Python script execution.
2025-08-25 09:04:34,403 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-25 09:04:34,404 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-25 09:04:34,404 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 09:04:34,812 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:34,812 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:04:34,815 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/BQRM_V01/BQCP24h/Clim/exported_data_2025-08-25.csv
2025-08-25 09:04:34,819 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-25 09:04:34,830 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 09:04:34,831 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-25 09:04:34,891 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 09:04:34,891 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-25 09:04:34,891 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-25 09:04:34,891 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 09:04:35,433 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:35,433 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:04:35,433 - INFO - Synop24h:77 - Constructed file paths:
2025-08-25 09:04:35,433 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 09:04:35,433 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 09:04:35,433 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 09:04:35,433 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 09:04:35,433 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 09:04:35,433 - INFO - Synop24h:83 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx
2025-08-25 09:04:35,433 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 09:04:35,433 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json
2025-08-25 09:04:35,434 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt
2025-08-25 09:04:35,434 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 09:04:35,434 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json...
2025-08-25 09:04:35,434 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json. Found 68 stations.
2025-08-25 09:04:35,434 - INFO - Synop24h:115 - Today's date: 2025-08-25
2025-08-25 09:04:35,434 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-25 09:04:35,435 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-25 09:04:35,575 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr. DataFrame shape: (150, 3)
2025-08-25 09:04:35,576 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-25 09:04:35,577 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-25 09:04:35,578 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-25 09:04:35,579 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-25 09:04:35,579 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 09:04:35,600 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-25 09:04:35,600 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-25 09:04:35,601 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-25 09:04:35,609 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-25 09:04:35,635 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 09:04:35,636 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt. Total unique missing stations: 2
2025-08-25 09:04:35,636 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 09:04:35,655 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-25 09:04:35,655 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-25 09:04:35,657 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 09:04:35,665 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 09:04:35,690 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 09:04:35,690 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 09:04:35,710 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 09:04:35,710 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 09:04:35,731 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 09:04:35,731 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx...
2025-08-25 09:04:35,753 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-25 09:04:35,753 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json...
2025-08-25 09:04:35,753 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 09:04:35,753 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 09:04:35,753 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 25 Août 2025'
2025-08-25 09:04:35,755 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-25 09:04:35,755 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-25 09:04:35,755 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-25 09:04:35,932 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 09:04:35,945 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-25 09:04:35,945 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-25 09:04:36,116 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 09:04:36,129 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-25 09:04:36,143 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 09:04:36,143 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-25 09:04:36,233 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 09:04:36,233 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-25 09:04:36,233 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-25 09:04:36,233 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 09:04:36,779 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 09:04:36,779 - INFO - SynoClim:66 - Configured file paths:
2025-08-25 09:04:36,779 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 09:04:36,780 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 09:04:36,780 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 09:04:36,780 - INFO - SynoClim:70 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 09:04:36,780 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 09:04:36,780 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 09:04:36,780 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 09:04:36,780 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 09:04:36,780 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 09:04:36,781 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 09:04:36,925 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-25 09:04:36,929 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-25 09:04:36,930 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-25 09:04:36,930 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-25 09:04:36,934 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-25 09:04:36,935 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-25 09:04:36,936 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 09:04:36,936 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 09:04:37,019 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-25 09:04:37,020 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-25 09:04:37,020 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 09:04:37,020 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-25 09:04:37,020 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx. Attempting to load.
2025-08-25 09:04:37,032 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-25 09:04:37,035 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-25 09:04:37,037 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,038 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,039 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,047 - INFO - SynoClim:258 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,048 - INFO - SynoClim:258 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,049 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,050 - INFO - SynoClim:258 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,050 - INFO - SynoClim:258 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,052 - INFO - SynoClim:258 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,053 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,054 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,055 - INFO - SynoClim:258 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,056 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,060 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,063 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,064 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,067 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,068 - INFO - SynoClim:229 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,069 - INFO - SynoClim:229 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,070 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,071 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,076 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,077 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,088 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,090 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,092 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,093 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,093 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,095 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,096 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,099 - INFO - SynoClim:258 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,101 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,101 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,104 - INFO - SynoClim:258 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,105 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,106 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,108 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,110 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-25 09:04:37,111 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 38
2025-08-25 09:04:37,111 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 09:04:37,133 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 09:04:37,134 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 09:04:37,134 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 09:04:37,134 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 09:04:37,146 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-25 09:04:37,146 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 09:04:37,146 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-25 09:04:37,146 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 09:04:37,146 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-25 09:04:37,147 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-25 09:04:38,489 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-25 09:04:38,489 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 09:04:38,500 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 09:04:38,500 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-25 09:04:38,591 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 09:04:38,591 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-25 09:04:38,591 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-25 09:04:38,591 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 09:04:38,659 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:38,659 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 09:04:38,659 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-25 09:04:38,659 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-25, Yesterday: 2025-08-24
2025-08-25 09:04:38,659 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 09:04:38,659 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 09:04:38,659 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 25/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-25 09:04:38,659 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 25/08/2025'
2025-08-25 09:04:38,859 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-25 09:04:38,862 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-25 09:04:38,862 - INFO - send_MSG:151 - Script execution finished.
2025-08-25 09:04:38,890 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 09:04:38,891 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-25 09:04:38,891 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-25 09:04:38,891 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08.
2025-08-25 09:04:38,892 - INFO - file_operations:98 - Moved 'Synop20250825-06.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 09:04:38,892 - INFO - file_operations:98 - Moved '20250825.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 09:04:38,892 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:04:38,892 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.xlsx)
2025-08-25 09:04:38,894 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 3 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:04:38,894 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:04:38,894 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.docx)
2025-08-25 09:04:38,895 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 09:04:38,895 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 09:04:38,896 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-25 09:04:38,896 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 1 files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 09:04:38,896 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08 and /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 09:04:38,896 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-25 09:04:38,896 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/25 to /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 09:04:38,897 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 09:04:38,897 - INFO - file_operations:355 - Destination directory '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25' exists. Removing it before copying.
2025-08-25 09:04:38,902 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 09:04:38,902 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-25 09:04:38,902 - INFO - Bulletin:262 - Script finished.
2025-08-25 09:04:38,903 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-25 11:24:59,354 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-25 11:24:59,354 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:24:59,354 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:24:59,354 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-25 11:24:59,354 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-25 11:24:59,354 - INFO - Bulletin:75 - Current Day (DD): 25
2025-08-25 11:24:59,354 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 11:24:59,354 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-25 11:24:59,354 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-25 11:24:59,354 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-25 11:24:59,354 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 11:24:59,355 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-25.csv.
2025-08-25 11:24:59,355 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-25 11:24:59,355 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-25 11:25:00,104 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-25 11:25:00,104 - INFO - fetchdata:227 - Local file exported_data_2025-08-25.csv is missing. Downloading.
2025-08-25 11:25:00,105 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/exported_data_2025-08-25.csv
2025-08-25 11:25:00,305 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-25.csv
2025-08-25 11:25:00,306 - INFO - fetchdata:257 - FTP client closed.
2025-08-25 11:25:00,307 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-25 11:25:00,307 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-25.csv successful.
2025-08-25 11:25:00,307 - INFO - Bulletin:133 - Moved exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/Clim.
2025-08-25 11:25:00,308 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr to /home/aoumeur/BQRM_V01/BQCP24h/Synop.
2025-08-25 11:25:00,309 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-25 11:25:00,309 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/BQRM_V01/BQCP24h for Python script execution.
2025-08-25 11:25:00,309 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-25 11:25:00,310 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-25 11:25:00,310 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 11:25:00,713 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:25:00,713 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 11:25:00,716 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/BQRM_V01/BQCP24h/Clim/exported_data_2025-08-25.csv
2025-08-25 11:25:00,720 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-25 11:25:00,731 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 11:25:00,731 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-25 11:25:00,792 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 11:25:00,792 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-25 11:25:00,792 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-25 11:25:00,792 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 11:25:01,331 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:25:01,331 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 11:25:01,332 - INFO - Synop24h:77 - Constructed file paths:
2025-08-25 11:25:01,332 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 11:25:01,332 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 11:25:01,332 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 11:25:01,332 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 11:25:01,332 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 11:25:01,332 - INFO - Synop24h:83 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx
2025-08-25 11:25:01,332 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 11:25:01,332 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json
2025-08-25 11:25:01,332 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt
2025-08-25 11:25:01,332 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 11:25:01,332 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json...
2025-08-25 11:25:01,332 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json. Found 68 stations.
2025-08-25 11:25:01,332 - INFO - Synop24h:115 - Today's date: 2025-08-25
2025-08-25 11:25:01,332 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-25 11:25:01,333 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-25 11:25:01,475 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr. DataFrame shape: (150, 3)
2025-08-25 11:25:01,475 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-25 11:25:01,476 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-25 11:25:01,478 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-25 11:25:01,478 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-25 11:25:01,478 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 11:25:01,499 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-25 11:25:01,499 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-25 11:25:01,501 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-25 11:25:01,509 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-25 11:25:01,553 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 11:25:01,554 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt. Total unique missing stations: 2
2025-08-25 11:25:01,554 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 11:25:01,573 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-25 11:25:01,573 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-25 11:25:01,575 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 11:25:01,583 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 11:25:01,608 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 11:25:01,608 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 11:25:01,627 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 11:25:01,627 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 11:25:01,647 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 11:25:01,647 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx...
2025-08-25 11:25:01,656 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-25 11:25:01,656 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json...
2025-08-25 11:25:01,657 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 11:25:01,657 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 11:25:01,657 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 25 Août 2025'
2025-08-25 11:25:01,658 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-25 11:25:01,659 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-25 11:25:01,659 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-25 11:25:01,827 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 11:25:01,840 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-25 11:25:01,840 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-25 11:25:02,009 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 11:25:02,022 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-25 11:25:02,034 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 11:25:02,035 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-25 11:25:02,125 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 11:25:02,126 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-25 11:25:02,126 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-25 11:25:02,126 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 11:25:02,665 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 11:25:02,665 - INFO - SynoClim:66 - Configured file paths:
2025-08-25 11:25:02,665 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 11:25:02,665 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 11:25:02,666 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 11:25:02,666 - INFO - SynoClim:70 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 11:25:02,666 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 11:25:02,666 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 11:25:02,666 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 11:25:02,666 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 11:25:02,666 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 11:25:02,667 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 11:25:02,807 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-25 11:25:02,812 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-25 11:25:02,812 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-25 11:25:02,813 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-25 11:25:02,816 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-25 11:25:02,818 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-25 11:25:02,818 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 11:25:02,818 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 11:25:02,903 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-25 11:25:02,903 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-25 11:25:02,903 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 11:25:02,903 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-25 11:25:02,903 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx. Attempting to load.
2025-08-25 11:25:02,915 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-25 11:25:02,919 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-25 11:25:02,920 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,921 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,922 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,931 - INFO - SynoClim:258 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,932 - INFO - SynoClim:258 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,932 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,933 - INFO - SynoClim:258 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,934 - INFO - SynoClim:258 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,935 - INFO - SynoClim:258 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,936 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,937 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,938 - INFO - SynoClim:258 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,939 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,943 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,946 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,948 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,950 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,951 - INFO - SynoClim:229 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,952 - INFO - SynoClim:229 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,953 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,954 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,959 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,960 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,971 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,973 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,974 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,975 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,976 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,977 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,979 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,982 - INFO - SynoClim:258 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,983 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,984 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,986 - INFO - SynoClim:258 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,987 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,988 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,990 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,992 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-25 11:25:02,993 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 38
2025-08-25 11:25:02,993 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 11:25:03,015 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 11:25:03,015 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 11:25:03,016 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 11:25:03,016 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 11:25:03,028 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-25 11:25:03,028 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 11:25:03,028 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-25 11:25:03,028 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 11:25:03,028 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-25 11:25:03,029 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-25 11:25:04,414 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-25 11:25:04,414 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 11:25:04,425 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 11:25:04,425 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-25 11:25:04,517 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 11:25:04,518 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-25 11:25:04,518 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-25 11:25:04,518 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 11:25:04,581 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:25:04,581 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 11:25:04,581 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-25 11:25:04,582 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-25, Yesterday: 2025-08-24
2025-08-25 11:25:04,582 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 11:25:04,582 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 11:25:04,582 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 25/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-25 11:25:04,582 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 25/08/2025'
2025-08-25 11:25:04,795 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-25 11:25:04,797 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-25 11:25:04,797 - INFO - send_MSG:151 - Script execution finished.
2025-08-25 11:25:04,823 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 11:25:04,823 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-25 11:25:04,823 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-25 11:25:04,823 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08.
2025-08-25 11:25:04,824 - INFO - file_operations:98 - Moved 'Synop20250825-06.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 11:25:04,824 - INFO - file_operations:98 - Moved '20250825.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 11:25:04,825 - INFO - Bulletin:221 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 11:25:04,825 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.xlsx)
2025-08-25 11:25:04,826 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 3 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 11:25:04,826 - INFO - Bulletin:225 - Removing *.docx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 11:25:04,826 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.docx)
2025-08-25 11:25:04,827 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 11:25:04,827 - INFO - Bulletin:230 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 11:25:04,828 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-25 11:25:04,828 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 1 files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 11:25:04,828 - INFO - Bulletin:236 - Creating backup directories: /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08 and /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 11:25:04,828 - INFO - Bulletin:240 - Backup directories created successfully.
2025-08-25 11:25:04,828 - INFO - Bulletin:248 - Copying SMAL* data from /bqrm_data/observations/2025/08/25 to /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 11:25:04,828 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 11:25:04,828 - INFO - file_operations:355 - Destination directory '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25' exists. Removing it before copying.
2025-08-25 11:25:04,831 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 11:25:04,831 - INFO - Bulletin:256 - TAC data copy to backup successful.
2025-08-25 11:25:04,831 - INFO - Bulletin:262 - Script finished.
2025-08-25 11:25:04,831 - INFO - Bulletin:276 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
2025-08-25 14:48:16,624 - INFO - Bulletin:62 - Script started: Bufr and Arpege Data Retrieval and Processing.
2025-08-25 14:48:16,625 - INFO - Bulletin:64 - All logs will be written to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:16,625 - INFO - Bulletin:69 - Set environment variable PYTAPS_SHARED_LOG_FILE to: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:16,625 - INFO - Bulletin:73 - Current Year (AA): 2025
2025-08-25 14:48:16,625 - INFO - Bulletin:74 - Current Month (MM): 08
2025-08-25 14:48:16,625 - INFO - Bulletin:75 - Current Day (DD): 25
2025-08-25 14:48:16,625 - INFO - Bulletin:76 - Script Directory (SCRIPT_DIR): /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 14:48:16,625 - INFO - Bulletin:88 - BUFR Input Root: bufr_data/observations
2025-08-25 14:48:16,625 - INFO - Bulletin:89 - TAC Input Root: bqrm_data/observations
2025-08-25 14:48:16,625 - INFO - Bulletin:90 - FTP Server: 10.16.80.222
2025-08-25 14:48:16,625 - INFO - Bulletin:91 - Local Directory for downloads: /home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 14:48:16,625 - INFO - Bulletin:103 - Attempting to connect to FTP server 10.16.80.222 and download exported_data_2025-08-25.csv.
2025-08-25 14:48:16,625 - INFO - fetchdata:171 - Starting FTP file fetching process for 1 files.
2025-08-25 14:48:16,625 - INFO - fetchdata:17 - Attempting to connect to FTP server 10.16.80.222:21...
2025-08-25 14:48:16,629 - INFO - fetchdata:20 - Successfully connected and logged in to 10.16.80.222.
2025-08-25 14:48:16,630 - INFO - fetchdata:227 - Local file exported_data_2025-08-25.csv is missing. Downloading.
2025-08-25 14:48:16,630 - INFO - fetchdata:230 - Downloading /exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/exported_data_2025-08-25.csv
2025-08-25 14:48:16,667 - INFO - fetchdata:239 - Successfully downloaded exported_data_2025-08-25.csv
2025-08-25 14:48:16,668 - INFO - fetchdata:257 - FTP client closed.
2025-08-25 14:48:16,668 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-25 14:48:16,668 - INFO - Bulletin:128 - FTP download of exported_data_2025-08-25.csv successful.
2025-08-25 14:48:16,669 - INFO - Bulletin:133 - Moved exported_data_2025-08-25.csv to /home/aoumeur/BQRM_V01/BQCP24h/Clim.
2025-08-25 14:48:16,670 - INFO - Bulletin:152 - Attempting to copy BUFR Synop file from /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/25/Synop_202508250600.bufr to /home/aoumeur/BQRM_V01/BQCP24h/Synop.
2025-08-25 14:48:16,671 - INFO - Bulletin:159 - BUFR Synop file copy successful.
2025-08-25 14:48:16,671 - INFO - Bulletin:173 - Changed directory to /home/aoumeur/BQRM_V01/BQCP24h for Python script execution.
2025-08-25 14:48:16,671 - INFO - Bulletin:179 - Both FTP download and BUFR file copy were successful. Proceeding with Python script execution.
2025-08-25 14:48:16,671 - INFO - Bulletin:184 - Executing python3 csvtoxlsx.py...
2025-08-25 14:48:16,671 - INFO - system_utils:36 - Executing command: python3 csvtoxlsx.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 14:48:17,101 - INFO - csvtoxlsx:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:17,101 - INFO - csvtoxlsx:68 - Script csvtoxlsx.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 14:48:17,104 - INFO - csvtoxlsx:74 - Successfully read CSV file: /home/aoumeur/BQRM_V01/BQCP24h/Clim/exported_data_2025-08-25.csv
2025-08-25 14:48:17,109 - INFO - csvtoxlsx:95 - Data reshaped successfully.
2025-08-25 14:48:17,124 - INFO - csvtoxlsx:119 - Data has been reshaped and saved to /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 14:48:17,124 - INFO - csvtoxlsx:124 - Script csvtoxlsx.py finished.
2025-08-25 14:48:17,187 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 14:48:17,187 - INFO - Bulletin:196 - csvtoxlsx.py executed successfully.
2025-08-25 14:48:17,187 - INFO - Bulletin:184 - Executing python3 Synop24h.py...
2025-08-25 14:48:17,187 - INFO - system_utils:36 - Executing command: python3 Synop24h.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 14:48:17,731 - INFO - Synop24h:54 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:17,732 - INFO - Synop24h:63 - Script Synop24h.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 14:48:17,732 - INFO - Synop24h:77 - Constructed file paths:
2025-08-25 14:48:17,732 - INFO - Synop24h:78 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 14:48:17,732 - INFO - Synop24h:79 -   24h Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 14:48:17,732 - INFO - Synop24h:80 -   Agri Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 14:48:17,732 - INFO - Synop24h:81 -   Output 24h Excel: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 14:48:17,732 - INFO - Synop24h:82 -   Output Agri Excel: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 14:48:17,732 - INFO - Synop24h:83 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx
2025-08-25 14:48:17,732 - INFO - Synop24h:84 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 14:48:17,732 - INFO - Synop24h:85 -   Station mapping file: /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json
2025-08-25 14:48:17,732 - INFO - Synop24h:86 -   Missing stations log: /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt
2025-08-25 14:48:17,733 - INFO - Synop24h:87 -   Month translation file: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 14:48:17,733 - INFO - Synop24h:102 - Attempting to load station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json...
2025-08-25 14:48:17,733 - INFO - Synop24h:105 - Successfully loaded station mapping from /home/aoumeur/BQRM_V01/BQCP24h/ListStation.json. Found 68 stations.
2025-08-25 14:48:17,733 - INFO - Synop24h:115 - Today's date: 2025-08-25
2025-08-25 14:48:17,733 - INFO - Synop24h:122 - Cumulative precipitation will not be reset.
2025-08-25 14:48:17,734 - INFO - data_utils:319 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr for columns: ['stationOrSiteName', 'totalPrecipitationOrTotalWaterEquivalent', 'timePeriod'] with kwargs: {}
2025-08-25 14:48:17,873 - INFO - data_utils:328 - Successfully loaded BUFR data from /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr. DataFrame shape: (150, 3)
2025-08-25 14:48:17,873 - INFO - Synop24h:143 - Columns renamed in DataFrame.
2025-08-25 14:48:17,874 - INFO - Synop24h:147 - Filtered for 24-hour precipitation (Time == -24). Records found: 75
2025-08-25 14:48:17,875 - INFO - Synop24h:155 - Selected 'SYNOP_STATION_NAME' and 'Précip (mm)' columns. Current DataFrame shape: (75, 2)
2025-08-25 14:48:17,876 - INFO - Synop24h:159 - DataFrame sorted by 'SYNOP_STATION_NAME'.
2025-08-25 14:48:17,876 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx
2025-08-25 14:48:17,897 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul24.xlsx, active sheet: 'Feuille1'
2025-08-25 14:48:17,897 - INFO - Synop24h:187 - Updating 24-hour precipitation Excel file with data.
2025-08-25 14:48:17,899 - WARNING - Synop24h:208 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data. Marked as missing.
2025-08-25 14:48:17,906 - WARNING - Synop24h:208 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data. Marked as missing.
2025-08-25 14:48:17,932 - INFO - Synop24h:224 - Updated 24-hour precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 14:48:17,932 - INFO - Synop24h:237 - Missing stations list saved to /home/aoumeur/BQRM_V01/BQCP24h/Synop20250825-06.txt. Total unique missing stations: 2
2025-08-25 14:48:17,932 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx
2025-08-25 14:48:17,951 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/agricole.xlsx, active sheet: 'Feuille1'
2025-08-25 14:48:17,951 - INFO - Synop24h:271 - Updating cumulative precipitation Excel file with daily data.
2025-08-25 14:48:17,953 - WARNING - Synop24h:297 - Row 3: Station 'Relizane' (RELIZANE) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 14:48:17,961 - WARNING - Synop24h:297 - Row 11: Station 'El-Kheiter' (EL-KHEITER) not found in BUFR data for cumulative update. Cumulative unchanged.
2025-08-25 14:48:17,986 - INFO - Synop24h:312 - Updated cumulative precipitation Excel file saved to /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 14:48:17,986 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx
2025-08-25 14:48:18,005 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/cumul24_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 14:48:18,006 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx
2025-08-25 14:48:18,025 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/agricole_08250600.xlsx, active sheet: 'Feuille1'
2025-08-25 14:48:18,026 - INFO - Synop24h:347 - Loading Word template from /home/aoumeur/BQRM_V01/BQCP24h/templates/cumul.docx...
2025-08-25 14:48:18,035 - INFO - Synop24h:349 - Word template loaded successfully.
2025-08-25 14:48:18,035 - INFO - Synop24h:373 - Attempting to load month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json...
2025-08-25 14:48:18,035 - INFO - Synop24h:376 - Successfully loaded month translation from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 14:48:18,036 - INFO - Synop24h:396 - Generated date line for 24h precip: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 14:48:18,036 - INFO - Synop24h:397 - Generated date line for cumulative precip: 'Cumuls de pluie enregistrés Validité : du 01 Septembre 2025 au 25 Août 2025'
2025-08-25 14:48:18,037 - INFO - Synop24h:420 - Updated 24h precipitation date line in Word document.
2025-08-25 14:48:18,038 - INFO - Synop24h:434 - Updated cumulative precipitation date line in Word document.
2025-08-25 14:48:18,038 - INFO - Synop24h:439 - Populating 24-hour precipitation table (table 1) in Word document.
2025-08-25 14:48:18,218 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 14:48:18,231 - INFO - Synop24h:462 - Set font size for 24h precipitation table in Word.
2025-08-25 14:48:18,231 - INFO - Synop24h:467 - Populating cumulative precipitation table (table 3) in Word document.
2025-08-25 14:48:18,401 - WARNING - Synop24h:364 - Could not format value for Word: 'None'. Returning '/'.
2025-08-25 14:48:18,414 - INFO - Synop24h:490 - Set font size for cumulative precipitation table in Word.
2025-08-25 14:48:18,428 - INFO - Synop24h:497 - Combined Word document with 24-hour and cumulative precipitation saved as /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 14:48:18,428 - INFO - Synop24h:501 - Script Synop24h.py finished.
2025-08-25 14:48:18,518 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 14:48:18,518 - INFO - Bulletin:196 - Synop24h.py executed successfully.
2025-08-25 14:48:18,518 - INFO - Bulletin:184 - Executing python3 SynoClim.py...
2025-08-25 14:48:18,518 - INFO - system_utils:36 - Executing command: python3 SynoClim.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 14:48:19,070 - INFO - SynoClim:53 - Script SynoClim.py started with args: Year=2025, Month=08, Day=25, LocalDir=/home/aoumeur/BQRM_V01/BQCP24h
2025-08-25 14:48:19,070 - INFO - SynoClim:66 - Configured file paths:
2025-08-25 14:48:19,070 - INFO - SynoClim:67 -   BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 14:48:19,070 - INFO - SynoClim:68 -   Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 14:48:19,070 - INFO - SynoClim:69 -   Output Excel: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 14:48:19,070 - INFO - SynoClim:70 -   Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 14:48:19,070 - INFO - SynoClim:71 -   Output Word: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 14:48:19,070 - INFO - SynoClim:72 -   Missing stations file: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 14:48:19,070 - INFO - SynoClim:73 -   JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 14:48:19,070 - INFO - SynoClim:74 -   Climatic Excel data: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx
2025-08-25 14:48:19,070 - INFO - SynoClim:75 -   Month translation JSON: /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json
2025-08-25 14:48:19,071 - INFO - SynoClim:86 - Attempting to read BUFR file: /home/aoumeur/BQRM_V01/BQCP24h/Synop/Synop_202508250600.bufr
2025-08-25 14:48:19,213 - INFO - SynoClim:91 - Successfully read BUFR file. Initial DataFrame shape: (150, 3)
2025-08-25 14:48:19,218 - INFO - SynoClim:98 - Renaming DataFrame columns.
2025-08-25 14:48:19,218 - INFO - SynoClim:105 - Filtering for 24-hour precipitation (Time == -24).
2025-08-25 14:48:19,219 - INFO - SynoClim:107 - Filtered 24-hour precipitation DataFrame shape: (75, 3)
2025-08-25 14:48:19,222 - INFO - SynoClim:111 - Dropping rows with missing station names.
2025-08-25 14:48:19,224 - INFO - SynoClim:114 - Dropped 0 rows with missing station names. New shape: (75, 3)
2025-08-25 14:48:19,224 - INFO - SynoClim:121 - Attempting to load Excel template: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 14:48:19,224 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx
2025-08-25 14:48:19,306 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BQCP24h/templates/template.xlsx, active sheet: 'Feuille1'
2025-08-25 14:48:19,307 - INFO - SynoClim:123 - Successfully loaded Excel template.
2025-08-25 14:48:19,307 - INFO - SynoClim:138 - Attempting to load JSON mapping file: /home/aoumeur/BQRM_V01/BQCP24h/climaticstations.json
2025-08-25 14:48:19,307 - INFO - SynoClim:141 - Successfully loaded JSON mapping. 49 entries found.
2025-08-25 14:48:19,307 - INFO - SynoClim:166 - Additional Excel file found: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx/data_2025-08-25.xlsx. Attempting to load.
2025-08-25 14:48:19,319 - INFO - SynoClim:171 - Successfully loaded additional Excel file. Columns: ['Station', 'Precipitation']
2025-08-25 14:48:19,322 - INFO - SynoClim:199 - Starting to loop through Excel template rows to populate precipitation values.
2025-08-25 14:48:19,324 - INFO - SynoClim:229 -   Station 'MATRIOUNE' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,325 - INFO - SynoClim:229 -   Station 'AOULEF' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,326 - INFO - SynoClim:229 -   Station 'REGGANE' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,335 - INFO - SynoClim:258 -   Station 'REGHAIA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,336 - INFO - SynoClim:258 -   Station 'BORDJ-EL-BAHRI' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,336 - INFO - SynoClim:229 -   Station 'SOUK OUFELLA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,337 - INFO - SynoClim:258 -   Station 'EL-HARRACH' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,338 - INFO - SynoClim:258 -   Station 'BARAKI' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,339 - INFO - SynoClim:258 -   Station 'KOUBA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,340 - INFO - SynoClim:258 -   Station 'OUED KORICH' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,341 - INFO - SynoClim:258 -   Station 'BOUZAREAH' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,342 - INFO - SynoClim:258 -   Station 'AIN-BENIAN' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,343 - INFO - SynoClim:258 -   Station 'MAHALMA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,347 - INFO - SynoClim:229 -   Station 'TIKDJDA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,350 - INFO - SynoClim:229 -   Station 'ABDENNIZI' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,352 - INFO - SynoClim:229 -   Station 'TIRIRINE' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,354 - INFO - SynoClim:229 -   Station 'AMGUID' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,355 - INFO - SynoClim:229 -   Station 'MERTOUTEK' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,356 - INFO - SynoClim:229 -   Station 'MOULAY-LAHCEN' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,358 - INFO - SynoClim:229 -   Station 'ARAK' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,358 - INFO - SynoClim:258 -   Station 'SKIKDA PORT' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,364 - INFO - SynoClim:229 -   Station 'IN AZAOUA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,364 - INFO - SynoClim:258 -   Station 'BOUCHEGOUF' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,376 - INFO - SynoClim:258 -   Station 'TALMINE' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,377 - INFO - SynoClim:258 -   Station 'BIDON-5' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,379 - INFO - SynoClim:258 -   Station 'OUALLEN' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,380 - INFO - SynoClim:229 -   Station 'EL KHEITER' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,381 - INFO - SynoClim:258 -   Station 'OULED DJELLAL' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,382 - INFO - SynoClim:258 -   Station 'TABELBALA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,384 - INFO - SynoClim:258 -   Station 'TAGUENTOUR' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,386 - INFO - SynoClim:258 -   Station 'ANESBARAKA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,388 - INFO - SynoClim:229 -   Station 'EL-KALA' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,389 - INFO - SynoClim:258 -   Station 'IN ATEI' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,391 - INFO - SynoClim:258 -   Station 'TINALKOUN' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,392 - INFO - SynoClim:258 -   Station 'BORDJ-HAOUS' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,393 - INFO - SynoClim:258 -   Station 'OUED ARIKINE' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,395 - INFO - SynoClim:258 -   Station 'EL M’GHAIR' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,397 - INFO - SynoClim:229 -   Station 'CHERCHELL' not found in any data source. Marked as missing ('/').
2025-08-25 14:48:19,398 - INFO - SynoClim:266 - Finished populating Excel template. Total missing stations identified: 38
2025-08-25 14:48:19,398 - INFO - SynoClim:271 - Attempting to save updated Excel file to: /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 14:48:19,420 - INFO - SynoClim:273 - Precipitation values successfully inserted into /home/aoumeur/BQRM_V01/BQCP24h/synop_precip_output2025250600.xlsx
2025-08-25 14:48:19,420 - INFO - SynoClim:279 - Attempting to save missing stations list to: /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 14:48:19,420 - INFO - SynoClim:285 - Missing stations saved in /home/aoumeur/BQRM_V01/BQCP24h/20250825.txt
2025-08-25 14:48:19,421 - INFO - SynoClim:295 - Attempting to load Word template: /home/aoumeur/BQRM_V01/BQCP24h/templates/doc_template.docx
2025-08-25 14:48:19,432 - INFO - SynoClim:297 - Successfully loaded Word template.
2025-08-25 14:48:19,433 - INFO - SynoClim:308 - Attempting to load month_translation.json from /home/aoumeur/BQRM_V01/BQCP24h/month_translation.json.
2025-08-25 14:48:19,433 - INFO - SynoClim:311 - Successfully loaded month translation JSON.
2025-08-25 14:48:19,433 - INFO - SynoClim:333 - Generated date line for Word document: 'Quantités de pluie enregistrée du 24 Août 2025 à 06h au 25 Août 2025 à 06h.'
2025-08-25 14:48:19,433 - INFO - SynoClim:337 - Attempting to update the first table (date line) in the Word document.
2025-08-25 14:48:19,434 - INFO - SynoClim:359 - Attempting to populate the second table (precipitation data) in the Word document.
2025-08-25 14:48:20,819 - INFO - SynoClim:389 - Finished populating Word document table.
2025-08-25 14:48:20,820 - INFO - SynoClim:392 - Attempting to save filled Word document to: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 14:48:20,831 - INFO - SynoClim:394 - Precipitation values successfully inserted and formatted in /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 14:48:20,831 - INFO - SynoClim:401 - Script SynoClim.py finished.
2025-08-25 14:48:20,921 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 14:48:20,921 - INFO - Bulletin:196 - SynoClim.py executed successfully.
2025-08-25 14:48:20,921 - INFO - Bulletin:184 - Executing python3 send_MSG.py...
2025-08-25 14:48:20,921 - INFO - system_utils:36 - Executing command: python3 send_MSG.py 2025 08 25 /home/aoumeur/BQRM_V01/BQCP24h in directory: '/home/aoumeur/BQRM_V01/BQCP24h'
2025-08-25 14:48:20,985 - INFO - send_MSG:85 - Shared log file path from environment: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:20,985 - INFO - send_MSG:86 - Logger initialized for send_MSG. Log file: /home/aoumeur/BQRM_V01/BQCP24h/logs/BQCP24h.log
2025-08-25 14:48:20,985 - INFO - send_MSG:87 - Starting daily weather bulletin sending script.
2025-08-25 14:48:20,985 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-25, Yesterday: 2025-08-24
2025-08-25 14:48:20,985 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/Cumul_table08250600.docx
2025-08-25 14:48:20,985 - INFO - send_MSG:114 - File found and added for attachment: /home/aoumeur/BQRM_V01/BQCP24h/SynopClim_precip_table08250600.docx
2025-08-25 14:48:20,985 - INFO - send_MSG:131 - Attempting to send email with subject: 'Bulletin du 25/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-25 14:48:20,985 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Bulletin du 25/08/2025'
2025-08-25 14:48:21,161 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-25 14:48:21,163 - INFO - send_MSG:147 - Email process completed successfully.
2025-08-25 14:48:21,163 - INFO - send_MSG:151 - Script execution finished.
2025-08-25 14:48:21,192 - INFO - system_utils:47 - Command 'python3' completed successfully.
2025-08-25 14:48:21,193 - INFO - Bulletin:196 - send_MSG.py executed successfully.
2025-08-25 14:48:21,193 - INFO - Bulletin:211 - Starting post-processing and cleanup operations.
2025-08-25 14:48:21,193 - INFO - Bulletin:215 - Moving *.txt files to /home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08.
2025-08-25 14:48:21,194 - INFO - file_operations:98 - Moved 'Synop20250825-06.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 14:48:21,194 - INFO - file_operations:98 - Moved '20250825.txt' to '/home/aoumeur/BQRM_V01/BQCP24h/txt/2025/08'.
2025-08-25 14:48:21,195 - INFO - Bulletin:226 - Removing *.docx files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 14:48:21,195 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h (Pattern: *.docx)
2025-08-25 14:48:21,196 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 2 files from /home/aoumeur/BQRM_V01/BQCP24h.
2025-08-25 14:48:21,196 - INFO - Bulletin:231 - Removing *.xlsx files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 14:48:21,197 - INFO - file_operations:283 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx (Pattern: *.xlsx)
2025-08-25 14:48:21,197 - INFO - file_operations:300 - Finished cleanup. Successfully deleted 1 files from /home/aoumeur/BQRM_V01/BQCP24h/Climxlsx.
2025-08-25 14:48:21,197 - INFO - Bulletin:237 - Creating backup directories: /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08 and /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 14:48:21,197 - INFO - Bulletin:241 - Backup directories created successfully.
2025-08-25 14:48:21,198 - INFO - Bulletin:249 - Copying SMAL* data from /bqrm_data/observations/2025/08/25 to /home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25.
2025-08-25 14:48:21,198 - INFO - file_operations:339 - Attempting to copy directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 14:48:21,198 - INFO - file_operations:355 - Destination directory '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25' exists. Removing it before copying.
2025-08-25 14:48:21,204 - INFO - file_operations:370 - Successfully copied directory from '/bqrm_data/observations/2025/08/25' to '/home/aoumeur/BQRM_V01/BQCP24h/Backup/2025/08/25'.
2025-08-25 14:48:21,204 - INFO - Bulletin:257 - TAC data copy to backup successful.
2025-08-25 14:48:21,204 - INFO - Bulletin:263 - Script finished.
2025-08-25 14:48:21,204 - INFO - Bulletin:277 - Cleaned up PYTAPS_SHARED_LOG_FILE environment variable.
