2025-08-14 10:09:09,005 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-14 10:09:09,005 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:09,005 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-14, Yesterday: 2025-08-13
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/14/Synop_202508140600.bufr
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/13/Synop_202508131800.bufr
2025-08-14 10:09:09,006 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-14 10:09:09,007 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508140600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-14 10:09:09,162 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-14 10:09:09,162 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/13/Synop_202508131800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-14 10:09:09,273 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 86
2025-08-14 10:09:09,273 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-14 10:09:09,273 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-14 10:09:09,276 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-14 10:09:09,279 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-14 10:09:09,280 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250814.csv
2025-08-14 10:09:09,281 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-14 10:09:09,281 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:09,765 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-14 10:09:09,765 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-14 10:09:09,765 - INFO - 6-create_tables:73 - Calculated dates: Today=20250814, Yesterday=20250813
2025-08-14 10:09:09,765 - INFO - 6-create_tables:79 - Dates prepared: Today 20250814, Yesterday 20250813
2025-08-14 10:09:09,766 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-14 10:09:09,767 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250814.csv
2025-08-14 10:09:09,768 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-14 10:09:09,776 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250814.csv
2025-08-14 10:09:09,778 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-14 10:09:09,783 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-14 10:09:09,789 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-14 10:09:09,789 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250814.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-14 10:09:09,790 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-14 10:09:09,795 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-14 10:09:09,801 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-14 10:09:09,817 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-14 10:09:09,817 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-14 10:09:09,834 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-14 10:09:09,841 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-14 10:09:09,847 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:09,857 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:09,857 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-14 10:09:09,857 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:10,427 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-14 10:09:10,427 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-14 10:09:10,428 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-14 10:09:10,428 - INFO - 7-create_word:83 - Today's date: 14-08-2025, Tomorrow's date: 15-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:91 - Yesterday's date calculated: 13-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-14 10:09:10,428 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-14 10:09:10,801 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 94 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-14 10:09:10,801 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-14 10:09:10,801 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,801 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,801 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,801 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,808 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-14 10:09:10,808 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,822 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,844 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,844 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-14 10:09:10,847 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-14 10:09:10,847 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-14 10:09:10,884 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-14 10:09:10,924 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-14 10:09:10,934 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,935 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-14 10:09:10,935 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:10,950 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-14 10:09:10,950 - ERROR - system_utils:58 - STDOUT: 
2025-08-14 10:09:10,950 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-14 10:09:10,950 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-14 10:09:11,041 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-14 10:09:11,042 - ERROR - system_utils:58 - STDOUT: 2025-08-14 10:09:10,427 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-14 10:09:10,427 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-14 10:09:10,428 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-14 10:09:10,428 - INFO - 7-create_word:83 - Today's date: 14-08-2025, Tomorrow's date: 15-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:91 - Yesterday's date calculated: 13-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-14 10:09:10,428 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-14 10:09:10,801 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 94 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-14 10:09:10,801 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-14 10:09:10,801 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,801 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,801 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,801 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,808 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-14 10:09:10,808 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,822 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,844 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,844 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-14 10:09:10,847 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-14 10:09:10,847 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-14 10:09:10,884 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-14 10:09:10,924 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-14 10:09:10,934 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,935 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-14 10:09:10,935 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:10,950 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-14 10:09:10,950 - ERROR - system_utils:58 - STDOUT: 
2025-08-14 10:09:10,950 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-14 10:09:10,950 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-14 10:09:11,042 - ERROR - system_utils:59 - STDERR: 
2025-08-14 10:09:11,042 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-14 10:09:11,107 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-14 10:09:11,107 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:09,765 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-14 10:09:09,765 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-14 10:09:09,765 - INFO - 6-create_tables:73 - Calculated dates: Today=20250814, Yesterday=20250813
2025-08-14 10:09:09,765 - INFO - 6-create_tables:79 - Dates prepared: Today 20250814, Yesterday 20250813
2025-08-14 10:09:09,766 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-14 10:09:09,767 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250814.csv
2025-08-14 10:09:09,768 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-14 10:09:09,776 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250814.csv
2025-08-14 10:09:09,778 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-14 10:09:09,783 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-14 10:09:09,789 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-14 10:09:09,789 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250814.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-14 10:09:09,790 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-14 10:09:09,795 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-14 10:09:09,801 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-14 10:09:09,817 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-14 10:09:09,817 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-14 10:09:09,834 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-14 10:09:09,841 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-14 10:09:09,847 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:09,857 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:09,857 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-14 10:09:09,857 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:11,041 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-14 10:09:11,042 - ERROR - system_utils:58 - STDOUT: 2025-08-14 10:09:10,427 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-14 10:09:10,427 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-14 10:09:10,428 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-14 10:09:10,428 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-14 10:09:10,428 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-14 10:09:10,428 - INFO - 7-create_word:83 - Today's date: 14-08-2025, Tomorrow's date: 15-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:91 - Yesterday's date calculated: 13-08-2025
2025-08-14 10:09:10,428 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-14 10:09:10,428 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-14 10:09:10,801 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 94 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-14 10:09:10,801 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-14 10:09:10,801 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,801 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,801 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,801 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,808 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-14 10:09:10,808 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,822 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-14 10:09:10,844 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-14 10:09:10,844 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 13-08-2025 et prévues pour le 14-08-2025 et 15-08-2025 : '
2025-08-14 10:09:10,847 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-14 10:09:10,847 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-14 10:09:10,847 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-14 10:09:10,884 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-14 10:09:10,924 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-14 10:09:10,934 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_14-08-2025.docx
2025-08-14 10:09:10,935 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-14 10:09:10,935 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-14 10:09:10,950 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-14 10:09:10,950 - ERROR - system_utils:58 - STDOUT: 
2025-08-14 10:09:10,950 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-14 10:09:10,950 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-14 10:09:11,042 - ERROR - system_utils:59 - STDERR: 
2025-08-14 10:09:11,042 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-14 10:09:11,107 - ERROR - system_utils:59 - STDERR: 
2025-08-14 10:09:11,107 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:01,217 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:75 - Fetching files for date: 20250815 with pattern: *SP1*20250815000*
2025-08-15 09:15:01,230 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-15 09:15:01,230 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250815000*)...
2025-08-15 09:15:01,230 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-15 09:15:01,496 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-15 09:15:01,509 - INFO - fetchdata:61 - Found 9 files matching pattern '*SP1*20250815000*'.
2025-08-15 09:15:01,510 - INFO - 1-get_arpege:106 - Found 9 matching files on FTP server:
2025-08-15 09:15:01,510 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,511 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,512 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:01,512 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-15 09:15:01,512 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250815000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:01,512 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-15 09:15:01,512 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-15 09:15:01,734 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-15 09:15:01,734 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-15 09:15:01,734 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250815000*'
2025-08-15 09:15:01,735 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-15 09:15:01,743 - INFO - fetchdata:105 - Found 9 files matching pattern on remote server.
2025-08-15 09:15:01,743 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:02,164 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:02,164 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:02,590 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:02,591 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,017 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,017 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,502 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,502 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,968 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:03,968 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:04,444 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:04,444 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:04,919 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:04,919 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:05,504 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:05,504 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508150000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:05,778 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508150000--.grib2
2025-08-15 09:15:05,778 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-15 09:15:05,778 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-15 09:15:05,779 - INFO - 1-get_arpege:138 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-15 09:15:05,779 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-15 09:15:05,779 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:06,571 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-15 09:15:06,571 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:06,572 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:06,572 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:06,572 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:06,572 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-15 09:15:06,572 - INFO - 2-conv:56 - Processing for date: 20250815
2025-08-15 09:15:06,572 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-15 09:15:06,572 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2. Processing this branch.
2025-08-15 09:15:06,572 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-15 09:15:06,573 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2' to 't2m00-12.grib'.
2025-08-15 09:15:06,573 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:06,863 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:06,863 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2' to 't2m12-24.grib'.
2025-08-15 09:15:06,863 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,037 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,037 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2' to 't2m24-36.grib'.
2025-08-15 09:15:07,038 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,212 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,212 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2' to 't2m36-48.grib'.
2025-08-15 09:15:07,212 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,375 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,375 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,375 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,387 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,388 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:07,388 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-15 09:15:07,388 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-15 09:15:07,389 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-15 09:15:07,390 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-15 09:15:07,391 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-15 09:15:07,391 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-15 09:15:07,391 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-15 09:15:07,391 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:07,391 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-15 09:15:07,391 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:08,235 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,250 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,260 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-15 09:15:08,269 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:08,520 - INFO - grib_processor:113 - GRIB file '2t_20250815.grib' opened successfully.
2025-08-15 09:15:08,520 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-15 09:15:08,521 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-15 09:15:08,521 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:13,375 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-15 09:15:13,376 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:18,063 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:18,063 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-15 09:15:18,109 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,109 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-15 09:15:18,110 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,110 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-15 09:15:18,111 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-15 09:15:18,118 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,120 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-15 09:15:18,120 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508150600.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/14/Synop_202508141800.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-15 09:15:18,969 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508150600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,122 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-15 09:15:19,122 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508141800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-15 09:15:19,223 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-15 09:15:19,227 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-15 09:15:19,229 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-15 09:15:19,230 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:19,640 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-15 09:15:19,640 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-15 09:15:19,640 - INFO - 6-create_tables:73 - Calculated dates: Today=20250815, Yesterday=20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:79 - Dates prepared: Today 20250815, Yesterday 20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-15 09:15:19,641 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:19,643 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-15 09:15:19,651 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,652 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-15 09:15:19,656 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-15 09:15:19,662 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-15 09:15:19,663 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-15 09:15:19,664 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-15 09:15:19,668 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-15 09:15:19,673 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-15 09:15:19,689 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-15 09:15:19,690 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-15 09:15:19,705 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-15 09:15:19,712 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-15 09:15:19,719 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-15 09:15:19,728 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,663 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,663 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,664 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,664 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,728 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:19,640 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-15 09:15:19,640 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-15 09:15:19,640 - INFO - 6-create_tables:73 - Calculated dates: Today=20250815, Yesterday=20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:79 - Dates prepared: Today 20250815, Yesterday 20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-15 09:15:19,641 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:19,643 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-15 09:15:19,651 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,652 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-15 09:15:19,656 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-15 09:15:19,662 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-15 09:15:19,663 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-15 09:15:19,664 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-15 09:15:19,668 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-15 09:15:19,673 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-15 09:15:19,689 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-15 09:15:19,690 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-15 09:15:19,705 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-15 09:15:19,712 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-15 09:15:19,719 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-15 09:15:19,728 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,663 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,663 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,664 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,664 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,729 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,858 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,858 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508150600.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/14/Synop_202508141800.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-15 09:15:18,969 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508150600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,122 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-15 09:15:19,122 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508141800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-15 09:15:19,223 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-15 09:15:19,227 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-15 09:15:19,229 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-15 09:15:19,230 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,728 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:19,640 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-15 09:15:19,640 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-15 09:15:19,640 - INFO - 6-create_tables:73 - Calculated dates: Today=20250815, Yesterday=20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:79 - Dates prepared: Today 20250815, Yesterday 20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-15 09:15:19,641 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:19,643 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-15 09:15:19,651 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,652 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-15 09:15:19,656 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-15 09:15:19,662 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-15 09:15:19,663 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-15 09:15:19,664 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-15 09:15:19,668 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-15 09:15:19,673 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-15 09:15:19,689 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-15 09:15:19,690 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-15 09:15:19,705 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-15 09:15:19,712 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-15 09:15:19,719 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-15 09:15:19,728 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,663 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,663 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,664 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,664 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,729 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,859 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,859 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,988 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,989 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:08,235 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,250 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,260 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-15 09:15:08,269 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:08,520 - INFO - grib_processor:113 - GRIB file '2t_20250815.grib' opened successfully.
2025-08-15 09:15:08,520 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-15 09:15:08,521 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-15 09:15:08,521 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:13,375 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-15 09:15:13,376 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:18,063 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:18,063 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-15 09:15:18,109 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,109 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-15 09:15:18,110 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,110 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-15 09:15:18,111 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-15 09:15:18,118 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,120 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-15 09:15:18,120 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,858 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,858 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508150600.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/14/Synop_202508141800.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-15 09:15:18,969 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508150600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,122 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-15 09:15:19,122 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508141800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-15 09:15:19,223 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-15 09:15:19,227 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-15 09:15:19,229 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-15 09:15:19,230 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,728 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:19,640 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-15 09:15:19,640 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-15 09:15:19,640 - INFO - 6-create_tables:73 - Calculated dates: Today=20250815, Yesterday=20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:79 - Dates prepared: Today 20250815, Yesterday 20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-15 09:15:19,641 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:19,643 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-15 09:15:19,651 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,652 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-15 09:15:19,656 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-15 09:15:19,662 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-15 09:15:19,663 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-15 09:15:19,664 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-15 09:15:19,668 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-15 09:15:19,673 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-15 09:15:19,689 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-15 09:15:19,690 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-15 09:15:19,705 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-15 09:15:19,712 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-15 09:15:19,719 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-15 09:15:19,728 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,663 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,663 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,664 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,664 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,729 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,859 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,859 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,989 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,989 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:21,098 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:21,098 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:06,571 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-15 09:15:06,571 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:06,572 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:06,572 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:06,572 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:06,572 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-15 09:15:06,572 - INFO - 2-conv:56 - Processing for date: 20250815
2025-08-15 09:15:06,572 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-15 09:15:06,572 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2. Processing this branch.
2025-08-15 09:15:06,572 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-15 09:15:06,573 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2' to 't2m00-12.grib'.
2025-08-15 09:15:06,573 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:06,863 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:06,863 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2' to 't2m12-24.grib'.
2025-08-15 09:15:06,863 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,037 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,037 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2' to 't2m24-36.grib'.
2025-08-15 09:15:07,038 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,212 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,212 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2' to 't2m36-48.grib'.
2025-08-15 09:15:07,212 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508150000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:07,375 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-15 09:15:07,375 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,375 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,387 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib'.
2025-08-15 09:15:07,388 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:07,388 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-15 09:15:07,388 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-15 09:15:07,389 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-15 09:15:07,390 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-15 09:15:07,391 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-15 09:15:07,391 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-15 09:15:07,391 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-15 09:15:07,391 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:07,391 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-15 09:15:07,391 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,988 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,989 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-15 09:15:08,234 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:08,235 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,250 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-15 09:15:08,260 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-15 09:15:08,269 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250815.grib
2025-08-15 09:15:08,520 - INFO - grib_processor:113 - GRIB file '2t_20250815.grib' opened successfully.
2025-08-15 09:15:08,520 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-15 09:15:08,521 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-15 09:15:08,521 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:13,375 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-15 09:15:13,376 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-15 09:15:13,376 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-15 09:15:18,063 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-15 09:15:18,063 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-15 09:15:18,109 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-15 09:15:18,109 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,109 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-15 09:15:18,110 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-15 09:15:18,110 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-15 09:15:18,110 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-15 09:15:18,111 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-15 09:15:18,118 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,119 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:18,120 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-15 09:15:18,120 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,858 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,858 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-15, Yesterday: 2025-08-14
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-15 09:15:18,968 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508150600.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/14/Synop_202508141800.bufr
2025-08-15 09:15:18,969 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-15 09:15:18,969 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508150600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,122 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-15 09:15:19,122 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/14/Synop_202508141800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-15 09:15:19,223 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-15 09:15:19,223 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-15 09:15:19,227 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-15 09:15:19,229 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,230 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-15 09:15:19,230 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,728 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:19,640 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-15 09:15:19,640 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-15 09:15:19,640 - INFO - 6-create_tables:73 - Calculated dates: Today=20250815, Yesterday=20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:79 - Dates prepared: Today 20250815, Yesterday 20250814
2025-08-15 09:15:19,640 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-15 09:15:19,641 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250815.csv
2025-08-15 09:15:19,643 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-15 09:15:19,651 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv
2025-08-15 09:15:19,652 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-15 09:15:19,656 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-15 09:15:19,662 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-15 09:15:19,663 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250815.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-15 09:15:19,664 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-15 09:15:19,668 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-15 09:15:19,673 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-15 09:15:19,689 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-15 09:15:19,690 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-15 09:15:19,705 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-15 09:15:19,712 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-15 09:15:19,719 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:19,728 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-15 09:15:19,728 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,663 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-15 09:15:20,663 - ERROR - system_utils:58 - STDOUT: 2025-08-15 09:15:20,313 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-15 09:15:20,313 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-15 09:15:20,313 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,313 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-15 09:15:20,314 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-15 09:15:20,314 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-15 09:15:20,314 - INFO - 7-create_word:83 - Today's date: 15-08-2025, Tomorrow's date: 16-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:91 - Yesterday's date calculated: 14-08-2025
2025-08-15 09:15:20,314 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-15 09:15:20,314 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-15 09:15:20,380 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-15 09:15:20,380 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-15 09:15:20,381 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,381 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,381 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,381 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,389 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-15 09:15:20,389 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,402 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-15 09:15:20,454 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-15 09:15:20,454 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 14-08-2025 et prévues pour le 15-08-2025 et 16-08-2025 : '
2025-08-15 09:15:20,459 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-15 09:15:20,459 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-15 09:15:20,459 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-15 09:15:20,502 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-15 09:15:20,547 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-15 09:15:20,558 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_15-08-2025.docx
2025-08-15 09:15:20,558 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-15 09:15:20,558 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-15 09:15:20,573 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-15 09:15:20,573 - ERROR - system_utils:58 - STDOUT: 
2025-08-15 09:15:20,573 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-15 09:15:20,573 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-15 09:15:20,664 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,664 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,729 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,729 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,859 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,859 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:20,989 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:20,989 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-15 09:15:21,098 - ERROR - system_utils:59 - STDERR: 
2025-08-15 09:15:21,098 - ERROR - 1-get_arpege:150 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 144, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-16 09:15:01,143 - INFO - 1-get_arpege:75 - Fetching files for date: 20250816 with pattern: *SP1*20250816000*
2025-08-16 09:15:01,144 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-16 09:15:01,144 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250816000*)...
2025-08-16 09:15:01,144 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-16 09:15:01,420 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-16 09:15:01,432 - INFO - fetchdata:61 - Found 7 files matching pattern '*SP1*20250816000*'.
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:106 - Found 7 matching files on FTP server:
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-16 09:15:01,433 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250816000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:01,433 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-16 09:15:01,433 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-16 09:15:01,636 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-16 09:15:01,637 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-16 09:15:01,637 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250816000*'
2025-08-16 09:15:01,637 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-16 09:15:01,648 - INFO - fetchdata:105 - Found 7 files matching pattern on remote server.
2025-08-16 09:15:01,648 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:02,105 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:02,106 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:02,582 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:02,582 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:03,117 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:03,118 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:03,725 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:03,725 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:04,294 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:04,294 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:04,750 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:04,750 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508160000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:05,214 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508160000--.grib2
2025-08-16 09:15:05,214 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-16 09:15:05,215 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-16 09:15:05,215 - INFO - 1-get_arpege:138 - Successfully verified 7 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-16 09:15:05,215 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-16 09:15:05,215 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,004 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-16 09:15:06,004 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:06,004 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:06,004 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:06,004 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:06,004 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-16 09:15:06,005 - INFO - 2-conv:56 - Processing for date: 20250816
2025-08-16 09:15:06,005 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-16 09:15:06,005 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2. Processing this branch.
2025-08-16 09:15:06,005 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-16 09:15:06,005 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2' to 't2m00-12.grib'.
2025-08-16 09:15:06,005 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,350 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,350 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2' to 't2m12-24.grib'.
2025-08-16 09:15:06,350 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,528 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,528 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2' to 't2m24-36.grib'.
2025-08-16 09:15:06,528 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,704 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,704 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2' to 't2m36-48.grib'.
2025-08-16 09:15:06,704 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,867 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,867 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,868 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,880 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,880 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:06,880 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-16 09:15:06,881 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-16 09:15:06,882 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-16 09:15:06,882 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-16 09:15:06,883 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-16 09:15:06,883 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-16 09:15:06,883 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-16 09:15:06,883 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:06,883 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-16 09:15:06,883 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:07,732 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:07,734 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,736 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,747 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-16 09:15:07,756 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:07,995 - INFO - grib_processor:113 - GRIB file '2t_20250816.grib' opened successfully.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-16 09:15:07,996 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:12,883 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-16 09:15:12,883 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:17,629 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:17,629 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-16 09:15:17,676 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,677 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,678 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-16 09:15:17,679 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-16 09:15:17,686 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-16 09:15:17,688 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508160600.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508151800.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-16 09:15:18,573 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508160600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,726 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-16 09:15:18,727 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508151800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-16 09:15:18,844 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-16 09:15:18,847 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-16 09:15:18,850 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-16 09:15:18,851 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:19,264 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-16 09:15:19,264 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-16 09:15:19,264 - INFO - 6-create_tables:73 - Calculated dates: Today=20250816, Yesterday=20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:79 - Dates prepared: Today 20250816, Yesterday 20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-16 09:15:19,265 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:19,267 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-16 09:15:19,275 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:19,276 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-16 09:15:19,280 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-16 09:15:19,286 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-16 09:15:19,287 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-16 09:15:19,288 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-16 09:15:19,292 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-16 09:15:19,297 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-16 09:15:19,313 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-16 09:15:19,313 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-16 09:15:19,329 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-16 09:15:19,336 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-16 09:15:19,342 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-16 09:15:19,351 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,192 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,192 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,256 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,264 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-16 09:15:19,264 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-16 09:15:19,264 - INFO - 6-create_tables:73 - Calculated dates: Today=20250816, Yesterday=20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:79 - Dates prepared: Today 20250816, Yesterday 20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-16 09:15:19,265 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:19,267 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-16 09:15:19,275 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:19,276 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-16 09:15:19,280 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-16 09:15:19,286 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-16 09:15:19,287 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-16 09:15:19,288 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-16 09:15:19,292 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-16 09:15:19,297 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-16 09:15:19,313 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-16 09:15:19,313 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-16 09:15:19,329 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-16 09:15:19,336 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-16 09:15:19,342 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-16 09:15:19,351 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,192 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,192 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,192 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,257 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,386 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,386 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508160600.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508151800.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-16 09:15:18,573 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508160600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,726 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-16 09:15:18,727 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508151800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-16 09:15:18,844 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-16 09:15:18,847 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-16 09:15:18,850 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-16 09:15:18,851 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,256 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,264 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-16 09:15:19,264 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-16 09:15:19,264 - INFO - 6-create_tables:73 - Calculated dates: Today=20250816, Yesterday=20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:79 - Dates prepared: Today 20250816, Yesterday 20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-16 09:15:19,265 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:19,267 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-16 09:15:19,275 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:19,276 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-16 09:15:19,280 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-16 09:15:19,286 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-16 09:15:19,287 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-16 09:15:19,288 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-16 09:15:19,292 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-16 09:15:19,297 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-16 09:15:19,313 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-16 09:15:19,313 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-16 09:15:19,329 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-16 09:15:19,336 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-16 09:15:19,342 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-16 09:15:19,351 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,192 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,192 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,192 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,257 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,387 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,387 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,516 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,516 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:07,732 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:07,734 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,736 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,747 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-16 09:15:07,756 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:07,995 - INFO - grib_processor:113 - GRIB file '2t_20250816.grib' opened successfully.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-16 09:15:07,996 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:12,883 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-16 09:15:12,883 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:17,629 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:17,629 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-16 09:15:17,676 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,677 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,678 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-16 09:15:17,679 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-16 09:15:17,686 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-16 09:15:17,688 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,386 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,386 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508160600.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508151800.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-16 09:15:18,573 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508160600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,726 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-16 09:15:18,727 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508151800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-16 09:15:18,844 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-16 09:15:18,847 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-16 09:15:18,850 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-16 09:15:18,851 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,256 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,264 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-16 09:15:19,264 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-16 09:15:19,264 - INFO - 6-create_tables:73 - Calculated dates: Today=20250816, Yesterday=20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:79 - Dates prepared: Today 20250816, Yesterday 20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-16 09:15:19,265 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:19,267 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-16 09:15:19,275 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:19,276 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-16 09:15:19,280 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-16 09:15:19,286 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-16 09:15:19,287 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-16 09:15:19,288 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-16 09:15:19,292 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-16 09:15:19,297 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-16 09:15:19,313 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-16 09:15:19,313 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-16 09:15:19,329 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-16 09:15:19,336 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-16 09:15:19,342 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-16 09:15:19,351 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,192 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,192 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,192 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,257 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,387 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,387 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,516 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,517 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,627 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,627 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:06,004 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-16 09:15:06,004 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:06,004 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:06,004 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:06,004 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:06,004 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-16 09:15:06,005 - INFO - 2-conv:56 - Processing for date: 20250816
2025-08-16 09:15:06,005 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-16 09:15:06,005 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2. Processing this branch.
2025-08-16 09:15:06,005 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-16 09:15:06,005 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2' to 't2m00-12.grib'.
2025-08-16 09:15:06,005 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,350 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,350 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2' to 't2m12-24.grib'.
2025-08-16 09:15:06,350 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,528 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,528 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2' to 't2m24-36.grib'.
2025-08-16 09:15:06,528 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,704 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,704 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2' to 't2m36-48.grib'.
2025-08-16 09:15:06,704 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508160000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:06,867 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-16 09:15:06,867 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,868 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,880 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib'.
2025-08-16 09:15:06,880 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:06,880 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-16 09:15:06,881 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-16 09:15:06,882 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-16 09:15:06,882 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-16 09:15:06,883 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-16 09:15:06,883 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-16 09:15:06,883 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-16 09:15:06,883 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:06,883 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-16 09:15:06,883 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,516 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,516 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:07,732 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-16 09:15:07,733 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:07,734 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,736 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-16 09:15:07,747 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-16 09:15:07,756 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250816.grib
2025-08-16 09:15:07,995 - INFO - grib_processor:113 - GRIB file '2t_20250816.grib' opened successfully.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-16 09:15:07,995 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-16 09:15:07,996 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:12,883 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-16 09:15:12,883 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-16 09:15:12,883 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-16 09:15:17,629 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-16 09:15:17,629 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-16 09:15:17,676 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,677 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-16 09:15:17,677 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-16 09:15:17,677 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-16 09:15:17,678 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-16 09:15:17,678 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-16 09:15:17,679 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-16 09:15:17,686 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:17,688 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-16 09:15:17,688 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,386 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,386 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-16, Yesterday: 2025-08-15
2025-08-16 09:15:18,572 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508160600.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/15/Synop_202508151800.bufr
2025-08-16 09:15:18,573 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-16 09:15:18,573 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508160600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,726 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-16 09:15:18,727 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/15/Synop_202508151800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-16 09:15:18,844 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-16 09:15:18,844 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-16 09:15:18,847 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-16 09:15:18,850 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:18,851 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-16 09:15:18,851 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,256 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,264 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-16 09:15:19,264 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-16 09:15:19,264 - INFO - 6-create_tables:73 - Calculated dates: Today=20250816, Yesterday=20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:79 - Dates prepared: Today 20250816, Yesterday 20250815
2025-08-16 09:15:19,264 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-16 09:15:19,265 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250816.csv
2025-08-16 09:15:19,267 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-16 09:15:19,275 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv
2025-08-16 09:15:19,276 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-16 09:15:19,280 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-16 09:15:19,286 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-16 09:15:19,287 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250816.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-16 09:15:19,288 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-16 09:15:19,292 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-16 09:15:19,297 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-16 09:15:19,313 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-16 09:15:19,313 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-16 09:15:19,329 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-16 09:15:19,336 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-16 09:15:19,342 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,351 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-16 09:15:19,351 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,192 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-16 09:15:20,192 - ERROR - system_utils:58 - STDOUT: 2025-08-16 09:15:19,910 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-16 09:15:19,910 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-16 09:15:19,911 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-16 09:15:19,911 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-16 09:15:19,911 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-16 09:15:19,911 - INFO - 7-create_word:83 - Today's date: 16-08-2025, Tomorrow's date: 17-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:91 - Yesterday's date calculated: 15-08-2025
2025-08-16 09:15:19,911 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-16 09:15:19,911 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-16 09:15:19,966 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-16 09:15:19,966 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-16 09:15:19,966 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,966 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,967 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:19,967 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,974 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-16 09:15:19,974 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,987 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-16 09:15:19,997 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-16 09:15:19,997 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 15-08-2025 et prévues pour le 16-08-2025 et 17-08-2025 : '
2025-08-16 09:15:20,000 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-16 09:15:20,000 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-16 09:15:20,000 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-16 09:15:20,037 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-16 09:15:20,076 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-16 09:15:20,086 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_16-08-2025.docx
2025-08-16 09:15:20,086 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-16 09:15:20,086 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-16 09:15:20,102 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-16 09:15:20,102 - ERROR - system_utils:58 - STDOUT: 
2025-08-16 09:15:20,102 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-16 09:15:20,102 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-16 09:15:20,192 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,192 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,257 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,257 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,387 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,387 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,516 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,517 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-16 09:15:20,627 - ERROR - system_utils:59 - STDERR: 
2025-08-16 09:15:20,627 - ERROR - 1-get_arpege:150 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 144, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:01,542 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:75 - Fetching files for date: 20250817 with pattern: *SP1*20250817000*
2025-08-17 09:15:01,543 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-17 09:15:01,543 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250817000*)...
2025-08-17 09:15:01,543 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-17 09:15:01,814 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-17 09:15:01,826 - INFO - fetchdata:61 - Found 7 files matching pattern '*SP1*20250817000*'.
2025-08-17 09:15:01,827 - INFO - 1-get_arpege:106 - Found 7 matching files on FTP server:
2025-08-17 09:15:01,827 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,827 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,827 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-17 09:15:01,828 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250817000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:01,828 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-17 09:15:01,829 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-17 09:15:02,054 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-17 09:15:02,054 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-17 09:15:02,054 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250817000*'
2025-08-17 09:15:02,055 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-17 09:15:02,064 - INFO - fetchdata:105 - Found 7 files matching pattern on remote server.
2025-08-17 09:15:02,064 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:02,621 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:02,621 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:03,263 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:03,263 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:03,976 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:03,976 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:04,548 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:04,548 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:05,158 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:05,158 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:05,829 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:05,829 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508170000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:06,419 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508170000--.grib2
2025-08-17 09:15:06,419 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-17 09:15:06,419 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-17 09:15:06,419 - INFO - 1-get_arpege:138 - Successfully verified 7 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-17 09:15:06,419 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-17 09:15:06,419 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,277 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-17 09:15:07,277 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:07,277 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:07,277 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:07,277 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:07,277 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-17 09:15:07,277 - INFO - 2-conv:56 - Processing for date: 20250817
2025-08-17 09:15:07,277 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-17 09:15:07,277 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2. Processing this branch.
2025-08-17 09:15:07,277 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-17 09:15:07,277 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2' to 't2m00-12.grib'.
2025-08-17 09:15:07,278 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,457 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,458 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2' to 't2m12-24.grib'.
2025-08-17 09:15:07,458 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,636 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,636 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2' to 't2m24-36.grib'.
2025-08-17 09:15:07,636 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,815 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,815 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2' to 't2m36-48.grib'.
2025-08-17 09:15:07,815 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,990 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,990 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:07,990 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:08,003 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:08,003 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:08,004 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-17 09:15:08,004 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-17 09:15:08,005 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-17 09:15:08,006 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-17 09:15:08,006 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-17 09:15:08,006 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-17 09:15:08,006 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-17 09:15:08,006 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:08,006 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-17 09:15:08,007 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:08,934 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,936 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,948 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-17 09:15:08,957 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:09,209 - INFO - grib_processor:113 - GRIB file '2t_20250817.grib' opened successfully.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-17 09:15:09,209 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:14,400 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-17 09:15:14,400 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:19,470 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:19,470 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-17 09:15:19,523 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,523 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-17 09:15:19,524 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,524 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-17 09:15:19,525 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-17 09:15:19,533 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,535 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-17 09:15:19,535 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508170600.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508161800.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-17 09:15:20,425 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508170600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,585 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-17 09:15:20,586 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508161800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-17 09:15:20,702 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-17 09:15:20,706 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-17 09:15:20,708 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-17 09:15:20,710 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:21,178 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-17 09:15:21,178 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-17 09:15:21,178 - INFO - 6-create_tables:73 - Calculated dates: Today=20250817, Yesterday=20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:79 - Dates prepared: Today 20250817, Yesterday 20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-17 09:15:21,179 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:21,182 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-17 09:15:21,191 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:21,193 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-17 09:15:21,199 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-17 09:15:21,206 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-17 09:15:21,206 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-17 09:15:21,208 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-17 09:15:21,213 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-17 09:15:21,219 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-17 09:15:21,239 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-17 09:15:21,239 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-17 09:15:21,257 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-17 09:15:21,266 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-17 09:15:21,274 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-17 09:15:21,284 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,190 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,190 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,178 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-17 09:15:21,178 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-17 09:15:21,178 - INFO - 6-create_tables:73 - Calculated dates: Today=20250817, Yesterday=20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:79 - Dates prepared: Today 20250817, Yesterday 20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-17 09:15:21,179 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:21,182 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-17 09:15:21,191 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:21,193 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-17 09:15:21,199 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-17 09:15:21,206 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-17 09:15:21,206 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-17 09:15:21,208 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-17 09:15:21,213 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-17 09:15:21,219 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-17 09:15:21,239 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-17 09:15:21,239 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-17 09:15:21,257 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-17 09:15:21,266 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-17 09:15:21,274 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-17 09:15:21,284 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,190 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,190 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,190 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,262 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,402 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508170600.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508161800.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-17 09:15:20,425 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508170600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,585 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-17 09:15:20,586 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508161800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-17 09:15:20,702 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-17 09:15:20,706 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-17 09:15:20,708 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-17 09:15:20,710 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,262 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,178 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-17 09:15:21,178 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-17 09:15:21,178 - INFO - 6-create_tables:73 - Calculated dates: Today=20250817, Yesterday=20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:79 - Dates prepared: Today 20250817, Yesterday 20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-17 09:15:21,179 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:21,182 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-17 09:15:21,191 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:21,193 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-17 09:15:21,199 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-17 09:15:21,206 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-17 09:15:21,206 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-17 09:15:21,208 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-17 09:15:21,213 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-17 09:15:21,219 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-17 09:15:21,239 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-17 09:15:21,239 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-17 09:15:21,257 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-17 09:15:21,266 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-17 09:15:21,274 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-17 09:15:21,284 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,190 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,190 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,190 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,262 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,403 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,556 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,556 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:08,934 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,936 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,948 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-17 09:15:08,957 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:09,209 - INFO - grib_processor:113 - GRIB file '2t_20250817.grib' opened successfully.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-17 09:15:09,209 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:14,400 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-17 09:15:14,400 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:19,470 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:19,470 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-17 09:15:19,523 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,523 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-17 09:15:19,524 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,524 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-17 09:15:19,525 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-17 09:15:19,533 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,535 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-17 09:15:19,535 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,402 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508170600.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508161800.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-17 09:15:20,425 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508170600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,585 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-17 09:15:20,586 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508161800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-17 09:15:20,702 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-17 09:15:20,706 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-17 09:15:20,708 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-17 09:15:20,710 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,262 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,178 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-17 09:15:21,178 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-17 09:15:21,178 - INFO - 6-create_tables:73 - Calculated dates: Today=20250817, Yesterday=20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:79 - Dates prepared: Today 20250817, Yesterday 20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-17 09:15:21,179 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:21,182 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-17 09:15:21,191 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:21,193 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-17 09:15:21,199 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-17 09:15:21,206 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-17 09:15:21,206 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-17 09:15:21,208 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-17 09:15:21,213 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-17 09:15:21,219 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-17 09:15:21,239 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-17 09:15:21,239 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-17 09:15:21,257 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-17 09:15:21,266 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-17 09:15:21,274 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-17 09:15:21,284 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,190 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,190 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,190 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,262 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,403 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,556 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,556 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,679 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,679 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:07,277 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-17 09:15:07,277 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:07,277 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:07,277 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:07,277 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:07,277 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-17 09:15:07,277 - INFO - 2-conv:56 - Processing for date: 20250817
2025-08-17 09:15:07,277 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-17 09:15:07,277 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2. Processing this branch.
2025-08-17 09:15:07,277 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-17 09:15:07,277 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2' to 't2m00-12.grib'.
2025-08-17 09:15:07,278 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,457 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,458 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2' to 't2m12-24.grib'.
2025-08-17 09:15:07,458 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,636 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,636 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2' to 't2m24-36.grib'.
2025-08-17 09:15:07,636 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,815 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,815 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2' to 't2m36-48.grib'.
2025-08-17 09:15:07,815 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508170000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:07,990 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-17 09:15:07,990 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:07,990 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:08,003 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib'.
2025-08-17 09:15:08,003 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:08,004 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-17 09:15:08,004 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-17 09:15:08,005 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-17 09:15:08,006 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-17 09:15:08,006 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-17 09:15:08,006 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-17 09:15:08,006 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-17 09:15:08,006 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:08,006 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-17 09:15:08,007 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,556 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,556 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-17 09:15:08,933 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:08,934 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,936 - INFO - data_utils:72 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-17 09:15:08,948 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-17 09:15:08,957 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250817.grib
2025-08-17 09:15:09,209 - INFO - grib_processor:113 - GRIB file '2t_20250817.grib' opened successfully.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-17 09:15:09,209 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-17 09:15:09,209 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:14,400 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-17 09:15:14,400 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-17 09:15:14,400 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-17 09:15:19,470 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-17 09:15:19,470 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-17 09:15:19,523 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-17 09:15:19,523 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,523 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-17 09:15:19,524 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-17 09:15:19,524 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-17 09:15:19,524 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-17 09:15:19,525 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-17 09:15:19,533 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - data_utils:146 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,534 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:19,535 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-17 09:15:19,535 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,402 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:20,424 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-17, Yesterday: 2025-08-16
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508170600.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/16/Synop_202508161800.bufr
2025-08-17 09:15:20,425 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-17 09:15:20,425 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508170600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,585 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 86
2025-08-17 09:15:20,586 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/16/Synop_202508161800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-17 09:15:20,702 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-17 09:15:20,702 - INFO - data_utils:50 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-17 09:15:20,706 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-17 09:15:20,708 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:20,709 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-17 09:15:20,710 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,262 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,178 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-17 09:15:21,178 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-17 09:15:21,178 - INFO - 6-create_tables:73 - Calculated dates: Today=20250817, Yesterday=20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:79 - Dates prepared: Today 20250817, Yesterday 20250816
2025-08-17 09:15:21,178 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-17 09:15:21,179 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250817.csv
2025-08-17 09:15:21,182 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-17 09:15:21,191 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv
2025-08-17 09:15:21,193 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-17 09:15:21,199 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-17 09:15:21,206 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-17 09:15:21,206 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250817.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-17 09:15:21,208 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-17 09:15:21,213 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-17 09:15:21,219 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-17 09:15:21,239 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-17 09:15:21,239 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-17 09:15:21,257 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-17 09:15:21,266 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-17 09:15:21,274 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,284 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-17 09:15:21,284 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,190 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-17 09:15:22,190 - ERROR - system_utils:58 - STDOUT: 2025-08-17 09:15:21,874 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-17 09:15:21,874 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-17 09:15:21,874 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-17 09:15:21,874 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-17 09:15:21,874 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-17 09:15:21,875 - INFO - 7-create_word:83 - Today's date: 17-08-2025, Tomorrow's date: 18-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:91 - Yesterday's date calculated: 16-08-2025
2025-08-17 09:15:21,875 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-17 09:15:21,875 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-17 09:15:21,945 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 8 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-17 09:15:21,945 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-17 09:15:21,945 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,945 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,945 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:21,945 - INFO - data_utils:282 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,953 - INFO - data_utils:285 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-17 09:15:21,953 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,967 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-17 09:15:21,976 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-17 09:15:21,976 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,979 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 16-08-2025 et prévues pour le 17-08-2025 et 18-08-2025 : '
2025-08-17 09:15:21,980 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-17 09:15:21,980 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-17 09:15:21,980 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-17 09:15:22,019 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-17 09:15:22,060 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-17 09:15:22,071 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_17-08-2025.docx
2025-08-17 09:15:22,071 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-17 09:15:22,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-17 09:15:22,087 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-17 09:15:22,087 - ERROR - system_utils:58 - STDOUT: 
2025-08-17 09:15:22,087 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-17 09:15:22,087 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-17 09:15:22,190 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,190 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,262 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,262 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,403 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,403 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,556 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,556 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-17 09:15:22,679 - ERROR - system_utils:59 - STDERR: 
2025-08-17 09:15:22,679 - ERROR - 1-get_arpege:150 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 144, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:02,060 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:75 - Fetching files for date: 20250818 with pattern: *SP1*20250818000*
2025-08-18 09:15:02,061 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-18 09:15:02,061 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250818000*)...
2025-08-18 09:15:02,061 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-18 09:15:02,325 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-18 09:15:02,335 - INFO - fetchdata:61 - Found 6 files matching pattern '*SP1*20250818000*'.
2025-08-18 09:15:02,335 - INFO - 1-get_arpege:106 - Found 6 matching files on FTP server:
2025-08-18 09:15:02,336 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,336 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,336 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,336 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,336 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,337 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:02,337 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-18 09:15:02,337 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250818000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:02,337 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 09:15:02,337 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-18 09:15:02,560 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-18 09:15:02,560 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-18 09:15:02,560 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250818000*'
2025-08-18 09:15:02,560 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 09:15:02,565 - INFO - fetchdata:105 - Found 6 files matching pattern on remote server.
2025-08-18 09:15:02,565 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,019 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,019 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,483 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,483 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,954 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:03,954 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:04,434 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:04,434 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:04,880 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:04,880 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:05,352 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 09:15:05,353 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 09:15:05,353 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-18 09:15:05,353 - INFO - 1-get_arpege:138 - Successfully verified 6 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-18 09:15:05,353 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-18 09:15:05,353 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,335 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-18 09:15:06,335 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:06,335 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:06,335 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:06,335 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:06,336 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 09:15:06,336 - INFO - 2-conv:56 - Processing for date: 20250818
2025-08-18 09:15:06,336 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-18 09:15:06,336 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2. Processing this branch.
2025-08-18 09:15:06,336 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-18 09:15:06,336 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2' to 't2m00-12.grib'.
2025-08-18 09:15:06,336 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,600 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,600 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2' to 't2m12-24.grib'.
2025-08-18 09:15:06,600 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,773 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,773 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2' to 't2m24-36.grib'.
2025-08-18 09:15:06,773 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,979 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,979 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2' to 't2m36-48.grib'.
2025-08-18 09:15:06,979 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:07,207 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:07,207 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,207 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,221 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,221 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:07,221 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-18 09:15:07,222 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-18 09:15:07,223 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-18 09:15:07,224 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-18 09:15:07,224 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-18 09:15:07,224 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-18 09:15:07,225 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-18 09:15:07,225 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:07,225 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-18 09:15:07,225 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,147 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,157 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-18 09:15:08,166 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:08,415 - INFO - grib_processor:113 - GRIB file '2t_20250818.grib' opened successfully.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-18 09:15:08,415 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:13,710 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-18 09:15:13,710 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:18,960 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:18,960 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-18 09:15:19,008 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,008 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-18 09:15:19,009 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,009 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-18 09:15:19,010 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-18 09:15:19,017 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-18 09:15:19,019 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508180600.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508171800.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-18 09:15:19,978 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,125 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 74
2025-08-18 09:15:20,125 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508171800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-18 09:15:20,235 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-18 09:15:20,238 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-18 09:15:20,240 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-18 09:15:20,242 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:20,718 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 09:15:20,718 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 09:15:20,718 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 09:15:20,720 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:20,722 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 09:15:20,731 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,732 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 09:15:20,737 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 09:15:20,745 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 09:15:20,745 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 09:15:20,747 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 09:15:20,752 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 09:15:20,758 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 09:15:20,775 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 09:15:20,775 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 09:15:20,792 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 09:15:20,800 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 09:15:20,807 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 09:15:20,817 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,693 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,694 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,694 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,694 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:20,718 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 09:15:20,718 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 09:15:20,718 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 09:15:20,720 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:20,722 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 09:15:20,731 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,732 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 09:15:20,737 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 09:15:20,745 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 09:15:20,745 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 09:15:20,747 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 09:15:20,752 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 09:15:20,758 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 09:15:20,775 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 09:15:20,775 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 09:15:20,792 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 09:15:20,800 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 09:15:20,807 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 09:15:20,817 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,693 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,694 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,694 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,694 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,760 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,901 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,901 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508180600.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508171800.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-18 09:15:19,978 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,125 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 74
2025-08-18 09:15:20,125 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508171800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-18 09:15:20,235 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-18 09:15:20,238 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-18 09:15:20,240 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-18 09:15:20,242 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,760 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:20,718 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 09:15:20,718 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 09:15:20,718 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 09:15:20,720 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:20,722 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 09:15:20,731 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,732 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 09:15:20,737 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 09:15:20,745 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 09:15:20,745 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 09:15:20,747 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 09:15:20,752 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 09:15:20,758 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 09:15:20,775 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 09:15:20,775 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 09:15:20,792 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 09:15:20,800 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 09:15:20,807 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 09:15:20,817 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,693 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,694 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,694 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,694 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,760 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,903 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,903 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:22,058 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:22,058 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,147 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,157 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-18 09:15:08,166 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:08,415 - INFO - grib_processor:113 - GRIB file '2t_20250818.grib' opened successfully.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-18 09:15:08,415 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:13,710 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-18 09:15:13,710 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:18,960 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:18,960 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-18 09:15:19,008 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,008 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-18 09:15:19,009 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,009 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-18 09:15:19,010 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-18 09:15:19,017 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-18 09:15:19,019 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,901 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,901 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508180600.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508171800.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-18 09:15:19,978 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,125 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 74
2025-08-18 09:15:20,125 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508171800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-18 09:15:20,235 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-18 09:15:20,238 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-18 09:15:20,240 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-18 09:15:20,242 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,760 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:20,718 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 09:15:20,718 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 09:15:20,718 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 09:15:20,720 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:20,722 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 09:15:20,731 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,732 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 09:15:20,737 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 09:15:20,745 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 09:15:20,745 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 09:15:20,747 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 09:15:20,752 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 09:15:20,758 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 09:15:20,775 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 09:15:20,775 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 09:15:20,792 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 09:15:20,800 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 09:15:20,807 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 09:15:20,817 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,693 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,694 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,694 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,694 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,760 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,903 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,903 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:22,058 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:22,058 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:22,176 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:22,176 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:06,335 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-18 09:15:06,335 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:06,335 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:06,335 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:06,335 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:06,336 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 09:15:06,336 - INFO - 2-conv:56 - Processing for date: 20250818
2025-08-18 09:15:06,336 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-18 09:15:06,336 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2. Processing this branch.
2025-08-18 09:15:06,336 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-18 09:15:06,336 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2' to 't2m00-12.grib'.
2025-08-18 09:15:06,336 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,600 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,600 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2' to 't2m12-24.grib'.
2025-08-18 09:15:06,600 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,773 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,773 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2' to 't2m24-36.grib'.
2025-08-18 09:15:06,773 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:06,979 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:06,979 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2' to 't2m36-48.grib'.
2025-08-18 09:15:06,979 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:07,207 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 09:15:07,207 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,207 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,221 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 09:15:07,221 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:07,221 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-18 09:15:07,222 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-18 09:15:07,223 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-18 09:15:07,224 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-18 09:15:07,224 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-18 09:15:07,224 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-18 09:15:07,225 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-18 09:15:07,225 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:07,225 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-18 09:15:07,225 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:22,058 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:22,058 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:08,143 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:08,144 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,147 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 09:15:08,157 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-18 09:15:08,166 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 09:15:08,415 - INFO - grib_processor:113 - GRIB file '2t_20250818.grib' opened successfully.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-18 09:15:08,415 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-18 09:15:08,415 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:13,710 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-18 09:15:13,710 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-18 09:15:13,710 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 09:15:18,960 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 09:15:18,960 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-18 09:15:19,008 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-18 09:15:19,008 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,008 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-18 09:15:19,009 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 09:15:19,009 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-18 09:15:19,009 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-18 09:15:19,010 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-18 09:15:19,017 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:19,019 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-18 09:15:19,019 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,901 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,901 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:19,976 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508180600.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508171800.bufr
2025-08-18 09:15:19,977 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-18 09:15:19,978 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,125 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 74
2025-08-18 09:15:20,125 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508171800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-18 09:15:20,235 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-18 09:15:20,235 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-18 09:15:20,238 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-18 09:15:20,240 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,242 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-18 09:15:20,242 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,760 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:20,718 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 09:15:20,718 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 09:15:20,718 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 09:15:20,718 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 09:15:20,720 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 09:15:20,722 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 09:15:20,731 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 09:15:20,732 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 09:15:20,737 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 09:15:20,745 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 09:15:20,745 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 09:15:20,747 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 09:15:20,752 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 09:15:20,758 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 09:15:20,775 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 09:15:20,775 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 09:15:20,792 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 09:15:20,800 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 09:15:20,807 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:20,817 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 09:15:20,817 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,693 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-18 09:15:21,694 - ERROR - system_utils:58 - STDOUT: 2025-08-18 09:15:21,410 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 09:15:21,411 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 09:15:21,411 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 09:15:21,411 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 09:15:21,411 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 09:15:21,411 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 09:15:21,411 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 09:15:21,411 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 09:15:21,466 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 09:15:21,467 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 09:15:21,467 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,467 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,467 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,467 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,474 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 09:15:21,474 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,488 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 09:15:21,497 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 09:15:21,497 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 09:15:21,500 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 09:15:21,501 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 09:15:21,501 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 09:15:21,537 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 09:15:21,576 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 09:15:21,586 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 09:15:21,586 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 09:15:21,586 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 09:15:21,602 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 2.
2025-08-18 09:15:21,602 - ERROR - system_utils:58 - STDOUT: 
2025-08-18 09:15:21,602 - ERROR - system_utils:59 - STDERR: /usr/bin/python3: can't open file '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py': [Errno 2] No such file or directory
2025-08-18 09:15:21,602 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 2.
2025-08-18 09:15:21,694 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,694 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,760 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,760 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:21,903 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:21,903 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:22,058 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:22,058 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 09:15:22,176 - ERROR - system_utils:59 - STDERR: 
2025-08-18 09:15:22,176 - ERROR - 1-get_arpege:150 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 144, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 14:13:28,683 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-18 14:13:28,684 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 14:13:28,684 - INFO - 1-get_arpege:75 - Fetching files for date: 20250818 with pattern: *SP1*20250818000*
2025-08-18 14:13:28,684 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-18 14:13:28,684 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250818000*)...
2025-08-18 14:13:28,684 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-18 14:13:28,930 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-18 14:13:28,942 - INFO - fetchdata:61 - Found 6 files matching pattern '*SP1*20250818000*'.
2025-08-18 14:13:28,943 - INFO - 1-get_arpege:106 - Found 6 matching files on FTP server:
2025-08-18 14:13:28,943 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,943 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-18 14:13:28,944 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250818000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 14:13:28,944 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-18 14:13:28,945 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-18 14:13:29,151 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-18 14:13:29,151 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-18 14:13:29,152 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250818000*'
2025-08-18 14:13:29,152 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 14:13:29,161 - INFO - fetchdata:105 - Found 6 files matching pattern on remote server.
2025-08-18 14:13:29,161 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:29,823 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:29,823 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:30,323 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:30,324 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:30,755 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:30,755 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:31,208 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:31,209 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:31,679 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:31,679 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:32,192 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508180000--.grib2
2025-08-18 14:13:32,193 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-18 14:13:32,193 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-18 14:13:32,193 - INFO - 1-get_arpege:138 - Successfully verified 6 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-18 14:13:32,193 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-18 14:13:32,193 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:32,954 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-18 14:13:32,954 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 14:13:32,955 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:32,955 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:32,955 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:32,955 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-18 14:13:32,955 - INFO - 2-conv:56 - Processing for date: 20250818
2025-08-18 14:13:32,955 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-18 14:13:32,955 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2. Processing this branch.
2025-08-18 14:13:32,955 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-18 14:13:32,955 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2' to 't2m00-12.grib'.
2025-08-18 14:13:32,955 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:33,367 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 14:13:33,367 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2' to 't2m12-24.grib'.
2025-08-18 14:13:33,368 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:33,745 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 14:13:33,745 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2' to 't2m24-36.grib'.
2025-08-18 14:13:33,745 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:34,129 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 14:13:34,129 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2' to 't2m36-48.grib'.
2025-08-18 14:13:34,130 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508180000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:34,519 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-18 14:13:34,519 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 14:13:34,519 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 14:13:34,531 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib'.
2025-08-18 14:13:34,531 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 14:13:34,531 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-18 14:13:34,532 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-18 14:13:34,533 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-18 14:13:34,534 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-18 14:13:34,534 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-18 14:13:34,534 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-18 14:13:34,535 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-18 14:13:34,535 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 14:13:34,535 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-18 14:13:34,535 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:35,387 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-18 14:13:35,388 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 14:13:35,389 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 14:13:35,391 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-18 14:13:35,401 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-18 14:13:35,410 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250818.grib
2025-08-18 14:13:35,645 - INFO - grib_processor:113 - GRIB file '2t_20250818.grib' opened successfully.
2025-08-18 14:13:35,645 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-18 14:13:35,646 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-18 14:13:35,646 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 14:13:40,542 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 14:13:40,542 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-18 14:13:40,542 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-18 14:13:40,542 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-18 14:13:45,261 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-18 14:13:45,262 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-18 14:13:45,310 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-18 14:13:45,310 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-18 14:13:45,310 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 14:13:45,310 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 14:13:45,311 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-18 14:13:45,311 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-18 14:13:45,311 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-18 14:13:45,311 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-18 14:13:45,311 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-18 14:13:45,311 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-18 14:13:45,312 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-18 14:13:45,319 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 14:13:45,321 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 14:13:45,321 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 14:13:45,321 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-18 14:13:45,321 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:46,166 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-18, Yesterday: 2025-08-17
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508180600.bufr
2025-08-18 14:13:46,167 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/17/Synop_202508171800.bufr
2025-08-18 14:13:46,168 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-18 14:13:46,168 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508180600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 14:13:46,295 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 74
2025-08-18 14:13:46,295 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/17/Synop_202508171800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-18 14:13:46,402 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 88
2025-08-18 14:13:46,402 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-18 14:13:46,402 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-18 14:13:46,406 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-18 14:13:46,408 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-18 14:13:46,410 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 14:13:46,410 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-18 14:13:46,410 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:46,824 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-18 14:13:46,824 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-18 14:13:46,824 - INFO - 6-create_tables:73 - Calculated dates: Today=20250818, Yesterday=20250817
2025-08-18 14:13:46,824 - INFO - 6-create_tables:79 - Dates prepared: Today 20250818, Yesterday 20250817
2025-08-18 14:13:46,824 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-18 14:13:46,825 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250818.csv
2025-08-18 14:13:46,827 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-18 14:13:46,835 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv
2025-08-18 14:13:46,836 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-18 14:13:46,840 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-18 14:13:46,846 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-18 14:13:46,846 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250818.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-18 14:13:46,848 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-18 14:13:46,852 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-18 14:13:46,857 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-18 14:13:46,873 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-18 14:13:46,873 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-18 14:13:46,889 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-18 14:13:46,896 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-18 14:13:46,902 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:46,911 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:46,911 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-18 14:13:46,911 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:47,472 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-18 14:13:47,472 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 14:13:47,472 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:47,472 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:47,472 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-18 14:13:47,472 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-18 14:13:47,472 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-18 14:13:47,472 - INFO - 7-create_word:83 - Today's date: 18-08-2025, Tomorrow's date: 19-08-2025
2025-08-18 14:13:47,472 - INFO - 7-create_word:91 - Yesterday's date calculated: 17-08-2025
2025-08-18 14:13:47,472 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-18 14:13:47,472 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-18 14:13:47,530 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-18 14:13:47,530 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-18 14:13:47,530 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:47,530 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 14:13:47,530 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 14:13:47,530 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:47,538 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-18 14:13:47,538 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:47,551 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-18 14:13:47,561 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-18 14:13:47,561 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 14:13:47,564 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 17-08-2025 et prévues pour le 18-08-2025 et 19-08-2025 : '
2025-08-18 14:13:47,564 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-18 14:13:47,565 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-18 14:13:47,565 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-18 14:13:47,602 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-18 14:13:47,641 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-18 14:13:47,651 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 14:13:47,651 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-18 14:13:47,651 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-18 14:13:47,718 - INFO - 8-send_MSG:73 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-18 14:13:47,718 - INFO - 8-send_MSG:74 - Starting daily antiacridienne bulletin sending script.
2025-08-18 14:13:47,718 - INFO - 8-send_MSG:93 - File found and added for attachment: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_18-08-2025.docx
2025-08-18 14:13:47,718 - INFO - 8-send_MSG:107 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 18/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-18 14:13:47,718 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 18/08/2025'
2025-08-18 14:13:47,925 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-18 14:13:47,927 - INFO - 8-send_MSG:123 - Email process completed successfully.
2025-08-18 14:13:47,928 - INFO - 8-send_MSG:128 - Script execution finished.
2025-08-18 14:13:47,941 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:47,942 - INFO - 7-create_word:305 - Successfully executed 8-send_MSG.py.
2025-08-18 14:13:47,942 - INFO - 7-create_word:313 - --- Script '7-create_word.py' finished. ---
2025-08-18 14:13:48,046 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:48,047 - INFO - 6-create_tables:261 - Successfully executed 7-create_word.py.
2025-08-18 14:13:48,047 - INFO - 6-create_tables:270 - --- Script '6-create_tables.py' finished. ---
2025-08-18 14:13:48,113 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:48,113 - INFO - 5-traitement_obs_min_max:195 - Successfully executed 6-create_tables.py.
2025-08-18 14:13:48,113 - INFO - 5-traitement_obs_min_max:204 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-18 14:13:48,246 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:48,246 - INFO - 3-create_forecast_table:262 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-18 14:13:48,246 - INFO - 3-create_forecast_table:270 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-18 14:13:48,388 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:48,389 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-18 14:13:48,389 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-18 14:13:48,502 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-18 14:13:48,502 - INFO - 1-get_arpege:148 - Successfully executed 2-conv.py.
2025-08-18 14:13:48,502 - INFO - 1-get_arpege:157 - --- Script '1-get_arpege.py' finished. ---
2025-08-19 09:15:01,631 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-19 09:15:01,631 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-19 09:15:01,631 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-19 09:15:01,631 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:75 - Fetching files for date: 20250819 with pattern: *SP1*20250819000*
2025-08-19 09:15:01,632 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-19 09:15:01,632 - INFO - fetchdata:48 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250819000*)...
2025-08-19 09:15:01,632 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-19 09:15:01,894 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-19 09:15:01,910 - INFO - fetchdata:61 - Found 9 files matching pattern '*SP1*20250819000*'.
2025-08-19 09:15:01,911 - INFO - 1-get_arpege:106 - Found 9 matching files on FTP server:
2025-08-19 09:15:01,912 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,912 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,912 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,912 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,913 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,913 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,913 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,913 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,914 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:01,914 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-19 09:15:01,914 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250819000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-19 09:15:01,915 - INFO - fetchdata:76 - Starting FTP file fetch process.
2025-08-19 09:15:01,915 - INFO - fetchdata:15 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-19 09:15:02,135 - INFO - fetchdata:18 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-19 09:15:02,135 - INFO - fetchdata:85 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-19 09:15:02,136 - INFO - fetchdata:92 - Looking for files matching pattern: '*SP1*20250819000*'
2025-08-19 09:15:02,136 - INFO - fetchdata:96 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-19 09:15:02,146 - INFO - fetchdata:105 - Found 9 files matching pattern on remote server.
2025-08-19 09:15:02,147 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:02,664 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:02,664 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:03,229 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:03,229 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:03,842 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:03,842 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:04,379 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:04,379 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:04,886 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:04,886 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:05,376 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:05,376 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:05,969 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:05,969 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:06,625 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:06,625 - INFO - fetchdata:118 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508190000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:06,911 - INFO - fetchdata:121 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508190000--.grib2
2025-08-19 09:15:06,911 - INFO - fetchdata:129 - FTP file fetch process completed.
2025-08-19 09:15:06,912 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-19 09:15:06,912 - INFO - 1-get_arpege:138 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-19 09:15:06,912 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-19 09:15:06,912 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:07,963 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-19 09:15:07,963 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-19 09:15:07,963 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:07,963 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:07,963 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:07,963 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-19 09:15:07,963 - INFO - 2-conv:56 - Processing for date: 20250819
2025-08-19 09:15:07,963 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-19 09:15:07,963 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2. Processing this branch.
2025-08-19 09:15:07,963 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-19 09:15:07,963 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2' to 't2m00-12.grib'.
2025-08-19 09:15:07,963 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508190000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:08,187 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-19 09:15:08,187 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2' to 't2m12-24.grib'.
2025-08-19 09:15:08,188 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508190000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:08,367 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-19 09:15:08,367 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2' to 't2m24-36.grib'.
2025-08-19 09:15:08,367 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508190000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:08,543 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-19 09:15:08,544 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2' to 't2m36-48.grib'.
2025-08-19 09:15:08,544 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508190000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:08,720 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-19 09:15:08,720 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib'.
2025-08-19 09:15:08,720 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib'.
2025-08-19 09:15:08,733 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib'.
2025-08-19 09:15:08,733 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib
2025-08-19 09:15:08,733 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-19 09:15:08,734 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-19 09:15:08,734 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-19 09:15:08,735 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-19 09:15:08,736 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-19 09:15:08,736 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-19 09:15:08,736 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-19 09:15:08,736 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib
2025-08-19 09:15:08,736 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-19 09:15:08,736 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:09,638 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-19 09:15:09,638 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-19 09:15:09,639 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-19, Yesterday: 2025-08-18
2025-08-19 09:15:09,640 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-19 09:15:09,642 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-19 09:15:09,653 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-19 09:15:09,662 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250819.grib
2025-08-19 09:15:09,904 - INFO - grib_processor:113 - GRIB file '2t_20250819.grib' opened successfully.
2025-08-19 09:15:09,904 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-19 09:15:09,904 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-19 09:15:09,904 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-19 09:15:15,148 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-19 09:15:15,148 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-19 09:15:15,148 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-19 09:15:15,148 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-19 09:15:20,110 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-19 09:15:20,111 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-19 09:15:20,162 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-19 09:15:20,162 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-19 09:15:20,162 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-19 09:15:20,163 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-19 09:15:20,163 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-19 09:15:20,163 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-19 09:15:20,163 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-19 09:15:20,163 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-19 09:15:20,164 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-19 09:15:20,164 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-19 09:15:20,165 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-19 09:15:20,172 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250819.csv
2025-08-19 09:15:20,174 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250819.csv
2025-08-19 09:15:20,174 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250819.csv
2025-08-19 09:15:20,174 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-19 09:15:20,174 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:21,112 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-19 09:15:21,112 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:21,112 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:21,112 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-19, Yesterday: 2025-08-18
2025-08-19 09:15:21,112 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-19 09:15:21,113 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-19 09:15:21,113 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508190600.bufr
2025-08-19 09:15:21,113 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/18/Synop_202508181800.bufr
2025-08-19 09:15:21,113 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-19 09:15:21,113 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508190600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-19 09:15:21,265 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 87
2025-08-19 09:15:21,265 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/18/Synop_202508181800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-19 09:15:21,373 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 87
2025-08-19 09:15:21,373 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-19 09:15:21,373 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-19 09:15:21,376 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-19 09:15:21,379 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-19 09:15:21,380 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250819.csv
2025-08-19 09:15:21,380 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-19 09:15:21,380 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:21,873 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-19 09:15:21,874 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-19 09:15:21,874 - INFO - 6-create_tables:73 - Calculated dates: Today=20250819, Yesterday=20250818
2025-08-19 09:15:21,874 - INFO - 6-create_tables:79 - Dates prepared: Today 20250819, Yesterday 20250818
2025-08-19 09:15:21,874 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-19 09:15:21,875 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250819.csv
2025-08-19 09:15:21,877 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-19 09:15:21,886 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250819.csv
2025-08-19 09:15:21,887 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-19 09:15:21,892 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-19 09:15:21,899 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-19 09:15:21,899 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250819.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-19 09:15:21,901 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-19 09:15:21,905 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-19 09:15:21,912 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-19 09:15:21,930 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-19 09:15:21,930 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-19 09:15:21,948 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-19 09:15:21,956 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-19 09:15:21,963 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:21,974 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:21,974 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-19 09:15:21,974 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:22,548 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-19 09:15:22,548 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-19 09:15:22,548 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:22,548 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:22,548 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-19 09:15:22,548 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-19 09:15:22,548 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-19 09:15:22,548 - INFO - 7-create_word:83 - Today's date: 19-08-2025, Tomorrow's date: 20-08-2025
2025-08-19 09:15:22,548 - INFO - 7-create_word:91 - Yesterday's date calculated: 18-08-2025
2025-08-19 09:15:22,548 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-19 09:15:22,548 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-19 09:15:22,633 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-19 09:15:22,633 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-19 09:15:22,633 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:22,633 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-19 09:15:22,633 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_19-08-2025.docx
2025-08-19 09:15:22,633 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:22,641 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-19 09:15:22,641 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:22,654 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-19 09:15:22,664 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-19 09:15:22,664 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 18-08-2025 et prévues pour le 19-08-2025 et 20-08-2025 : '
2025-08-19 09:15:22,667 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 18-08-2025 et prévues pour le 19-08-2025 et 20-08-2025 : '
2025-08-19 09:15:22,667 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-19 09:15:22,668 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-19 09:15:22,668 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-19 09:15:22,705 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-19 09:15:22,744 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-19 09:15:22,754 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_19-08-2025.docx
2025-08-19 09:15:22,754 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-19 09:15:22,755 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-19 09:15:22,820 - INFO - 8-send_MSG:73 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-19 09:15:22,820 - INFO - 8-send_MSG:74 - Starting daily antiacridienne bulletin sending script.
2025-08-19 09:15:22,820 - INFO - 8-send_MSG:93 - File found and added for attachment: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_19-08-2025.docx
2025-08-19 09:15:22,820 - INFO - 8-send_MSG:107 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 19/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-19 09:15:22,820 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 19/08/2025'
2025-08-19 09:15:23,026 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-19 09:15:23,028 - INFO - 8-send_MSG:123 - Email process completed successfully.
2025-08-19 09:15:23,028 - INFO - 8-send_MSG:128 - Script execution finished.
2025-08-19 09:15:23,055 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,055 - INFO - 7-create_word:305 - Successfully executed 8-send_MSG.py.
2025-08-19 09:15:23,055 - INFO - 7-create_word:313 - --- Script '7-create_word.py' finished. ---
2025-08-19 09:15:23,152 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,152 - INFO - 6-create_tables:261 - Successfully executed 7-create_word.py.
2025-08-19 09:15:23,152 - INFO - 6-create_tables:270 - --- Script '6-create_tables.py' finished. ---
2025-08-19 09:15:23,218 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,219 - INFO - 5-traitement_obs_min_max:195 - Successfully executed 6-create_tables.py.
2025-08-19 09:15:23,219 - INFO - 5-traitement_obs_min_max:204 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-19 09:15:23,350 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,350 - INFO - 3-create_forecast_table:262 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-19 09:15:23,350 - INFO - 3-create_forecast_table:270 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-19 09:15:23,484 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,484 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-19 09:15:23,484 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-19 09:15:23,601 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-19 09:15:23,601 - INFO - 1-get_arpege:148 - Successfully executed 2-conv.py.
2025-08-19 09:15:23,601 - INFO - 1-get_arpege:157 - --- Script '1-get_arpege.py' finished. ---
2025-08-20 09:15:02,265 - INFO - 1-get_arpege:54 - --- Script '1-get_arpege.py' started ---
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:55 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:56 - Current working directory: /home/aoumeur
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:57 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:58 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:59 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:60 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:63 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:75 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 09:15:02,266 - INFO - 1-get_arpege:78 - Checking if files exist on FTP server...
2025-08-20 09:15:02,266 - INFO - fetchdata:49 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 09:15:02,266 - INFO - fetchdata:16 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 09:15:02,518 - INFO - fetchdata:19 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 09:15:02,530 - INFO - fetchdata:62 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 09:15:02,530 - INFO - 1-get_arpege:106 - Found 9 matching files on FTP server:
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,531 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,532 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,532 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,532 - INFO - 1-get_arpege:108 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:02,532 - INFO - 1-get_arpege:111 - Proceeding with FTP download.
2025-08-20 09:15:02,532 - INFO - 1-get_arpege:112 - Downloading files matching pattern '*SP1*20250820000*' from /share/meteofrance/Arpege_Orig to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:02,532 - INFO - fetchdata:77 - Starting FTP file fetch process.
2025-08-20 09:15:02,532 - INFO - fetchdata:16 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 09:15:02,742 - INFO - fetchdata:19 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 09:15:02,742 - INFO - fetchdata:86 - Changed remote directory to: /share/meteofrance/Arpege_Orig
2025-08-20 09:15:02,743 - INFO - fetchdata:93 - Looking for files matching pattern: '*SP1*20250820000*'
2025-08-20 09:15:02,743 - INFO - fetchdata:97 - Local download directory: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 09:15:02,752 - INFO - fetchdata:106 - Found 9 files matching pattern on remote server.
2025-08-20 09:15:02,752 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:03,178 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:03,178 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:03,684 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:03,684 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:04,292 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:04,292 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:04,896 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:04,896 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:05,376 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:05,376 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:05,860 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:05,861 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:06,333 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:06,334 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:06,948 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:06,948 - INFO - fetchdata:119 - Downloading W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:07,276 - INFO - fetchdata:122 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 09:15:07,277 - INFO - fetchdata:130 - FTP file fetch process completed.
2025-08-20 09:15:07,277 - INFO - 1-get_arpege:124 - FTP transfer completed successfully.
2025-08-20 09:15:07,277 - INFO - 1-get_arpege:138 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 09:15:07,277 - INFO - 1-get_arpege:141 - Attempting to run next program: 2-conv.py
2025-08-20 09:15:07,277 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,120 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 09:15:08,120 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:08,120 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:08,120 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:08,120 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:08,120 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 09:15:08,120 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 09:15:08,120 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 09:15:08,120 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 09:15:08,120 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 09:15:08,121 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 09:15:08,121 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,306 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,306 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 09:15:08,306 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,499 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,499 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 09:15:08,499 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,685 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,685 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 09:15:08,686 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,872 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,872 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,873 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,885 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,885 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:08,885 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 09:15:08,885 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 09:15:08,886 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 09:15:08,887 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 09:15:08,887 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 09:15:08,887 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 09:15:08,888 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 09:15:08,888 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:08,888 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 09:15:08,888 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:09,801 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,812 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,822 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 09:15:09,831 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:10,062 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 09:15:10,063 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:14,931 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 09:15:14,932 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:19,646 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:19,646 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 09:15:19,694 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 09:15:19,697 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 09:15:19,704 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,726 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 09:15:19,726 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:20,595 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 09:15:20,597 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,747 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 09:15:20,747 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 09:15:20,848 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 09:15:20,852 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 09:15:20,854 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 09:15:20,855 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:21,292 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 09:15:21,293 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 09:15:21,293 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 09:15:21,294 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:21,296 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 09:15:21,304 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:21,305 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 09:15:21,310 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 09:15:21,316 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 09:15:21,317 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 09:15:21,318 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 09:15:21,322 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 09:15:21,328 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 09:15:21,344 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 09:15:21,344 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 09:15:21,360 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 09:15:21,368 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 09:15:21,374 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 09:15:21,383 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,407 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:21,292 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 09:15:21,293 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 09:15:21,293 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 09:15:21,294 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:21,296 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 09:15:21,304 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:21,305 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 09:15:21,310 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 09:15:21,316 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 09:15:21,317 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 09:15:21,318 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 09:15:21,322 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 09:15:21,328 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 09:15:21,344 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 09:15:21,344 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 09:15:21,360 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 09:15:21,368 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 09:15:21,374 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 09:15:21,383 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,407 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,407 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,474 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:20,595 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 09:15:20,597 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,747 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 09:15:20,747 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 09:15:20,848 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 09:15:20,852 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 09:15:20,854 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 09:15:20,855 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,473 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:21,292 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 09:15:21,293 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 09:15:21,293 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 09:15:21,294 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:21,296 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 09:15:21,304 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:21,305 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 09:15:21,310 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 09:15:21,316 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 09:15:21,317 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 09:15:21,318 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 09:15:21,322 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 09:15:21,328 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 09:15:21,344 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 09:15:21,344 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 09:15:21,360 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 09:15:21,368 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 09:15:21,374 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 09:15:21,383 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,407 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,407 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,474 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,626 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,786 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,786 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:09,801 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,812 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,822 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 09:15:09,831 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:10,062 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 09:15:10,063 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:14,931 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 09:15:14,932 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:19,646 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:19,646 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 09:15:19,694 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 09:15:19,697 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 09:15:19,704 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,726 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 09:15:19,726 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,625 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:20,595 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 09:15:20,597 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,747 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 09:15:20,747 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 09:15:20,848 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 09:15:20,852 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 09:15:20,854 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 09:15:20,855 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,473 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:21,292 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 09:15:21,293 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 09:15:21,293 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 09:15:21,294 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:21,296 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 09:15:21,304 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:21,305 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 09:15:21,310 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 09:15:21,316 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 09:15:21,317 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 09:15:21,318 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 09:15:21,322 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 09:15:21,328 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 09:15:21,344 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 09:15:21,344 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 09:15:21,360 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 09:15:21,368 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 09:15:21,374 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 09:15:21,383 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,407 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,407 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,474 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,626 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,786 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,786 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,902 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,903 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:08,120 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 09:15:08,120 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:08,120 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:08,120 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:08,120 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:08,120 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 09:15:08,120 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 09:15:08,120 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 09:15:08,120 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 09:15:08,120 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 09:15:08,121 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 09:15:08,121 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,306 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,306 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 09:15:08,306 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,499 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,499 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 09:15:08,499 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,685 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,685 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 09:15:08,686 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:08,872 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 09:15:08,872 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,873 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,885 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 09:15:08,885 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:08,885 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 09:15:08,885 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 09:15:08,886 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 09:15:08,887 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 09:15:08,887 - INFO - file_operations:170 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 09:15:08,887 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 09:15:08,888 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 09:15:08,888 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:08,888 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 09:15:08,888 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,786 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,786 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:09,799 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 09:15:09,800 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:09,801 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,812 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 09:15:09,822 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 09:15:09,831 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 09:15:10,062 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 09:15:10,062 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 09:15:10,063 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:14,931 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 09:15:14,932 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 09:15:14,932 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 09:15:19,646 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 09:15:19,646 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 09:15:19,694 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 09:15:19,695 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 09:15:19,695 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 09:15:19,695 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 09:15:19,696 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 09:15:19,697 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 09:15:19,704 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,725 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:19,726 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 09:15:19,726 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,625 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:20,595 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 09:15:20,596 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 09:15:20,597 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 09:15:20,597 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,747 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 09:15:20,747 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 09:15:20,848 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 09:15:20,848 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 09:15:20,852 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 09:15:20,854 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:20,855 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 09:15:20,855 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,473 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:21,292 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 09:15:21,293 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 09:15:21,293 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 09:15:21,293 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 09:15:21,294 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 09:15:21,296 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 09:15:21,304 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 09:15:21,305 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 09:15:21,310 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 09:15:21,316 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 09:15:21,317 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 09:15:21,318 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 09:15:21,322 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 09:15:21,328 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 09:15:21,344 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 09:15:21,344 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 09:15:21,360 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 09:15:21,368 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 09:15:21,374 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:21,383 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 09:15:21,383 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,407 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:58 - STDOUT: 2025-08-20 09:15:22,018 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 09:15:22,018 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 09:15:22,018 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 09:15:22,018 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 09:15:22,018 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 09:15:22,018 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 09:15:22,019 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 09:15:22,019 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 09:15:22,102 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 09:15:22,102 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 09:15:22,102 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,102 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,102 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,102 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,110 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 09:15:22,110 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,125 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 09:15:22,135 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 09:15:22,135 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,138 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 09:15:22,139 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 09:15:22,139 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 09:15:22,139 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 09:15:22,182 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 09:15:22,229 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 09:15:22,240 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 09:15:22,240 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 09:15:22,241 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 09:15:22,311 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 09:15:22,311 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 09:15:22,311 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,311 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,407 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,407 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,473 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,474 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,625 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,626 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,786 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,786 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 09:15:22,903 - ERROR - system_utils:59 - STDERR: 
2025-08-20 09:15:22,903 - ERROR - 1-get_arpege:150 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 144, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:77 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 15:28:11,363 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-20 15:28:11,363 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 15:28:11,363 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:28:11,623 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:28:11,632 - INFO - fetchdata:81 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:108 - Found 9 matching files on FTP server:
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,632 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:11,633 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-20 15:28:11,633 - INFO - 1-get_arpege:124 - Attempting to download 9 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:11,633 - INFO - fetchdata:171 - Starting FTP file fetching process for 9 files.
2025-08-20 15:28:11,633 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:28:11,844 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:28:11,845 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:11,845 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:12,384 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:12,385 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:12,385 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:13,012 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:13,012 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:13,013 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:13,586 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:13,587 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:13,587 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:14,068 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:14,068 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:14,068 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:14,591 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:14,591 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:14,592 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:15,163 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:15,163 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:15,163 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:15,750 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:15,750 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:15,750 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:16,305 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:16,305 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:28:16,305 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:16,525 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:28:16,525 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:28:16,525 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:28:16,525 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-20 15:28:16,525 - INFO - 1-get_arpege:150 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 15:28:16,525 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-20 15:28:16,526 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:17,310 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:28:17,310 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:17,310 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:17,310 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:17,310 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:17,310 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:28:17,310 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:28:17,310 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:28:17,311 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:28:17,311 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:28:17,311 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:28:17,311 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:17,675 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:17,675 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:28:17,675 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,024 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,024 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:28:18,024 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,375 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,375 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:28:18,375 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,722 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,722 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,722 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,734 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,734 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:18,734 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:28:18,735 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:28:18,736 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:28:18,736 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:28:18,737 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:28:18,737 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:28:18,737 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:28:18,737 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:18,737 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:28:18,737 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:19,549 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,551 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,561 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 15:28:19,570 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:19,792 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:28:19,792 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:24,372 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:28:24,372 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:28,837 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:28,837 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:28:28,881 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,882 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,883 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:28:28,884 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:28:28,890 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:28:28,892 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:28:29,700 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 15:28:29,700 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,840 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:28:29,840 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 15:28:29,933 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:28:29,936 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:28:29,938 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:28:29,939 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:29,940 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:28:29,940 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:30,391 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 15:28:30,391 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 15:28:30,391 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:28:30,392 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:30,394 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 15:28:30,402 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:30,403 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 15:28:30,407 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:28:30,413 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 15:28:30,414 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:28:30,415 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 15:28:30,419 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:28:30,424 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 15:28:30,440 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:28:30,440 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:28:30,455 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:28:30,462 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 15:28:30,468 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 15:28:30,477 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,414 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,489 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:30,391 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 15:28:30,391 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 15:28:30,391 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:28:30,392 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:30,394 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 15:28:30,402 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:30,403 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 15:28:30,407 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:28:30,413 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 15:28:30,414 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:28:30,415 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 15:28:30,419 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:28:30,424 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 15:28:30,440 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:28:30,440 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:28:30,455 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:28:30,462 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 15:28:30,468 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 15:28:30,477 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,414 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,414 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,490 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:28:29,700 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 15:28:29,700 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,840 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:28:29,840 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 15:28:29,933 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:28:29,936 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:28:29,938 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:28:29,939 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:29,940 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:28:29,940 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,489 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:30,391 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 15:28:30,391 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 15:28:30,391 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:28:30,392 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:30,394 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 15:28:30,402 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:30,403 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 15:28:30,407 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:28:30,413 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 15:28:30,414 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:28:30,415 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 15:28:30,419 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:28:30,424 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 15:28:30,440 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:28:30,440 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:28:30,455 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:28:30,462 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 15:28:30,468 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 15:28:30,477 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,414 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,414 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,490 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,621 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,746 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,746 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:19,549 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,551 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,561 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 15:28:19,570 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:19,792 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:28:19,792 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:24,372 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:28:24,372 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:28,837 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:28,837 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:28:28,881 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,882 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,883 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:28:28,884 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:28:28,890 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:28:28,892 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,621 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:28:29,700 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 15:28:29,700 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,840 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:28:29,840 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 15:28:29,933 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:28:29,936 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:28:29,938 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:28:29,939 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:29,940 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:28:29,940 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,489 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:30,391 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 15:28:30,391 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 15:28:30,391 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:28:30,392 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:30,394 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 15:28:30,402 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:30,403 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 15:28:30,407 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:28:30,413 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 15:28:30,414 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:28:30,415 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 15:28:30,419 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:28:30,424 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 15:28:30,440 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:28:30,440 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:28:30,455 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:28:30,462 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 15:28:30,468 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 15:28:30,477 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,414 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,414 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,490 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,621 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,746 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,746 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,852 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,852 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:17,310 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:28:17,310 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:17,310 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:17,310 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:17,310 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:17,310 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:28:17,310 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:28:17,310 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:28:17,311 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:28:17,311 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:28:17,311 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:28:17,311 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:17,675 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:17,675 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:28:17,675 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,024 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,024 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:28:18,024 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,375 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,375 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:28:18,375 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:18,722 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:28:18,722 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,722 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,734 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:28:18,734 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:18,734 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:28:18,735 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:28:18,736 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:28:18,736 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:28:18,737 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:28:18,737 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:28:18,737 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:28:18,737 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:18,737 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:28:18,737 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,746 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,746 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:51 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:60 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:71 - Preparing dates for data processing.
2025-08-20 15:28:19,548 - INFO - 3-create_forecast_table:78 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:19,549 - INFO - 3-create_forecast_table:93 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,551 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:28:19,561 - INFO - 3-create_forecast_table:99 - Successfully loaded 75 stations.
2025-08-20 15:28:19,570 - INFO - 3-create_forecast_table:112 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:28:19,792 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:115 - GRIB file resource successfully opened.
2025-08-20 15:28:19,792 - INFO - 3-create_forecast_table:133 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:28:19,792 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:24,372 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:147 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:28:24,372 - INFO - 3-create_forecast_table:155 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:28:24,372 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:28:28,837 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:28:28,837 - INFO - 3-create_forecast_table:169 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:28:28,881 - INFO - 3-create_forecast_table:180 - GRIB file resource closed successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:186 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,882 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:194 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:28:28,882 - INFO - 3-create_forecast_table:200 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:28:28,882 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:28:28,883 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:206 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:28:28,883 - INFO - 3-create_forecast_table:213 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:28:28,884 - INFO - 3-create_forecast_table:226 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:28:28,890 - INFO - 3-create_forecast_table:243 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:248 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:28,892 - INFO - 3-create_forecast_table:255 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:28:28,892 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,621 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:60 - --- Script Start ---
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:61 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:62 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:72 - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:88 - Defined 27 stations.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:93 - Initial stations DataFrame created.
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:101 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:28:29,699 - INFO - 5-traitement_obs_min_max:102 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:28:29,700 - INFO - 5-traitement_obs_min_max:112 - Proceeding with available BUFR files.
2025-08-20 15:28:29,700 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,840 - INFO - 5-traitement_obs_min_max:124 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:28:29,840 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:139 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:28:29,932 - INFO - 5-traitement_obs_min_max:146 - Starting DataFrame cleaning and filtering.
2025-08-20 15:28:29,933 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:28:29,936 - INFO - 5-traitement_obs_min_max:162 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:28:29,938 - INFO - 5-traitement_obs_min_max:170 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:28:29,939 - INFO - 5-traitement_obs_min_max:180 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:29,940 - INFO - 5-traitement_obs_min_max:187 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:28:29,940 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,489 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:58 - STDOUT: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:30,391 - INFO - 6-create_tables:77 - Preparing date variables for file paths.
2025-08-20 15:28:30,391 - INFO - 6-create_tables:61 - Preparing date variables (today and yesterday).
2025-08-20 15:28:30,391 - INFO - 6-create_tables:73 - Calculated dates: Today=20250820, Yesterday=20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:79 - Dates prepared: Today 20250820, Yesterday 20250819
2025-08-20 15:28:30,391 - INFO - 6-create_tables:84 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:28:30,392 - INFO - 6-create_tables:91 - Attempting to load arpege data from: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:28:30,394 - INFO - 6-create_tables:93 - Successfully loaded arpege data. Rows: 75
2025-08-20 15:28:30,402 - INFO - 6-create_tables:112 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:28:30,403 - INFO - 6-create_tables:114 - Successfully loaded tmin_max data. Rows: 27
2025-08-20 15:28:30,407 - INFO - 6-create_tables:131 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:28:30,413 - INFO - 6-create_tables:155 - Defined 10 station mappings for observations.
2025-08-20 15:28:30,414 - WARNING - 6-create_tables:162 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:28:30,415 - INFO - 6-create_tables:164 - Successfully loaded observations min/max data. Rows: 27
2025-08-20 15:28:30,419 - INFO - 6-create_tables:180 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:28:30,424 - INFO - 6-create_tables:193 - Merging arpege and observations data (first merge).
2025-08-20 15:28:30,440 - INFO - 6-create_tables:210 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:28:30,440 - WARNING - 6-create_tables:213 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:28:30,455 - INFO - 6-create_tables:224 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:28:30,462 - INFO - 6-create_tables:229 - Sorting final table by the specified station list order.
2025-08-20 15:28:30,468 - INFO - 6-create_tables:236 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:245 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:30,477 - INFO - 6-create_tables:253 - Attempting to run next program: 7-create_word.py
2025-08-20 15:28:30,477 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,414 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:28:31,032 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:28:31,032 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:28:31,032 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:28:31,032 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:28:31,032 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:28:31,032 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:28:31,032 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:28:31,032 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:28:31,115 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:28:31,115 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:28:31,115 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,115 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,115 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,115 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,122 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:28:31,122 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,135 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:28:31,145 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:28:31,145 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:28:31,148 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:28:31,148 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:28:31,148 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:28:31,190 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:28:31,232 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:28:31,244 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:28:31,244 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:28:31,244 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:28:31,318 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:28:31,318 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:28:31,318 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,318 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,414 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,414 - ERROR - 6-create_tables:263 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 257, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,490 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,490 - ERROR - 5-traitement_obs_min_max:197 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 191, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,621 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,621 - ERROR - 3-create_forecast_table:264 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 258, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,746 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,746 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:28:31,852 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:28:31,852 - ERROR - 1-get_arpege:162 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 156, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 15:37:05,174 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:37:05,175 - INFO - 1-get_arpege:77 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 15:37:05,175 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-20 15:37:05,175 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 15:37:05,175 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:37:05,433 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:37:05,445 - INFO - fetchdata:81 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 15:37:05,446 - INFO - 1-get_arpege:108 - Found 9 matching files on FTP server:
2025-08-20 15:37:05,446 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,446 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,446 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,447 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:05,448 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-20 15:37:05,448 - INFO - 1-get_arpege:124 - Attempting to download 9 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:05,448 - INFO - fetchdata:171 - Starting FTP file fetching process for 9 files.
2025-08-20 15:37:05,448 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:37:05,663 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:37:05,664 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:05,664 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:06,069 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:06,069 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:06,069 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:06,510 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:06,510 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:06,510 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:07,091 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:07,091 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:07,091 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:07,762 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:07,762 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:07,762 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:08,245 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:08,245 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:08,245 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:08,697 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:08,697 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:08,698 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:09,167 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:09,167 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:09,167 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:09,780 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:09,780 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:37:09,780 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:10,104 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:37:10,104 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:37:10,104 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:37:10,104 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-20 15:37:10,104 - INFO - 1-get_arpege:150 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 15:37:10,104 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-20 15:37:10,104 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:10,887 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:37:10,888 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:10,888 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:10,888 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:10,888 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:10,888 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:37:10,888 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:37:10,888 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:37:10,888 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:37:10,888 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:37:10,888 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:37:10,888 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:11,350 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:11,350 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:37:11,350 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:11,777 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:11,777 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:37:11,778 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:12,174 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:12,175 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:37:12,175 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:12,610 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:12,610 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,610 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,623 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,623 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:12,623 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:37:12,624 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:37:12,625 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:37:12,625 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:37:12,626 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:37:12,626 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:37:12,626 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:37:12,626 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:12,626 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:37:12,626 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,549 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:13,550 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,552 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,562 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:37:13,570 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:13,803 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:37:13,803 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:37:13,804 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:37:13,804 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:18,938 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:37:18,938 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:23,676 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:23,676 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:37:23,744 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:37:23,745 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:37:23,755 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:37:23,757 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:24,600 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:37:24,601 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,742 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:37:24,742 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:37:24,835 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:37:24,839 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:37:24,841 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:37:24,843 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:25,345 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:25,345 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:37:25,348 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:25,356 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,357 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,362 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:37:25,370 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:37:25,370 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:37:25,371 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,376 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:37:25,383 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:37:25,403 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:37:25,403 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:37:25,422 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:37:25,430 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:37:25,438 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:37:25,448 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:37:25,448 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,484 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:25,345 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:25,345 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:37:25,348 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:25,356 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,357 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,362 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:37:25,370 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:37:25,370 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:37:25,371 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,376 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:37:25,383 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:37:25,403 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:37:25,403 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:37:25,422 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:37:25,430 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:37:25,438 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:37:25,448 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:37:25,448 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,484 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,484 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,563 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:24,600 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:37:24,601 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,742 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:37:24,742 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:37:24,835 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:37:24,839 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:37:24,841 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:37:24,843 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,563 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:25,345 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:25,345 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:37:25,348 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:25,356 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,357 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,362 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:37:25,370 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:37:25,370 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:37:25,371 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,376 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:37:25,383 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:37:25,403 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:37:25,403 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:37:25,422 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:37:25,430 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:37:25,438 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:37:25,448 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:37:25,448 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,484 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,484 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,563 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,692 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,822 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,823 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,549 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:13,550 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,552 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,562 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:37:13,570 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:13,803 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:37:13,803 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:37:13,804 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:37:13,804 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:18,938 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:37:18,938 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:23,676 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:23,676 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:37:23,744 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:37:23,745 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:37:23,755 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:37:23,757 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,692 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:24,600 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:37:24,601 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,742 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:37:24,742 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:37:24,835 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:37:24,839 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:37:24,841 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:37:24,843 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,563 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:25,345 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:25,345 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:37:25,348 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:25,356 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,357 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,362 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:37:25,370 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:37:25,370 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:37:25,371 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,376 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:37:25,383 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:37:25,403 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:37:25,403 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:37:25,422 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:37:25,430 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:37:25,438 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:37:25,448 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:37:25,448 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,484 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,484 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,563 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,692 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,823 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,823 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,931 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,931 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:10,887 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:37:10,888 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:10,888 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:10,888 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:10,888 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:10,888 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:37:10,888 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:37:10,888 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:37:10,888 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:37:10,888 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:37:10,888 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:37:10,888 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:11,350 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:11,350 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:37:11,350 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:11,777 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:11,777 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:37:11,778 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:12,174 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:12,175 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:37:12,175 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:12,610 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:37:12,610 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,610 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,623 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:37:12,623 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:12,623 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:37:12,624 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:37:12,625 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:37:12,625 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:37:12,626 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:37:12,626 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:37:12,626 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:37:12,626 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:12,626 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:37:12,626 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,822 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,823 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:13,548 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:13,549 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:13,550 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,552 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:37:13,562 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:37:13,570 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:37:13,803 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:37:13,803 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:37:13,804 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:37:13,804 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:18,938 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:37:18,938 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:37:18,938 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:37:23,676 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:37:23,676 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:37:23,744 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:37:23,744 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:37:23,745 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:37:23,745 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:37:23,745 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:37:23,746 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:37:23,755 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:23,757 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:37:23,757 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,692 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:24,599 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:24,600 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:37:24,600 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:37:24,601 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,742 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:37:24,742 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:37:24,835 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:37:24,835 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:37:24,839 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:37:24,841 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:24,842 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:37:24,843 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,563 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:25,345 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:37:25,345 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:37:25,348 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:37:25,356 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,357 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,362 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:37:25,370 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:37:25,370 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:37:25,371 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:37:25,376 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:37:25,383 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:37:25,403 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:37:25,403 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:37:25,422 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:37:25,430 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:37:25,438 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:37:25,448 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:25,448 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:37:25,448 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,484 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:37:26,083 - INFO - 7-create_word:56 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:37:26,083 - INFO - 7-create_word:57 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:37:26,084 - INFO - 7-create_word:58 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:59 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:60 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:37:26,084 - INFO - 7-create_word:64 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:37:26,084 - INFO - 7-create_word:75 - Preparing today's and tomorrow's dates.
2025-08-20 15:37:26,084 - INFO - 7-create_word:83 - Today's date: 20-08-2025, Tomorrow's date: 21-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:91 - Yesterday's date calculated: 19-08-2025
2025-08-20 15:37:26,084 - INFO - 7-create_word:100 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:37:26,084 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:37:26,178 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:37:26,178 - INFO - 7-create_word:103 - Temporary files cleanup complete.
2025-08-20 15:37:26,178 - INFO - 7-create_word:156 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,178 - INFO - 7-create_word:157 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,178 - INFO - 7-create_word:158 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,178 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,187 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:37:26,187 - INFO - 7-create_word:168 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,202 - INFO - 7-create_word:180 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:37:26,212 - INFO - 7-create_word:191 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:37:26,212 - INFO - 7-create_word:114 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:140 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:37:26,217 - INFO - 7-create_word:212 - Starting to update the Word document table.
2025-08-20 15:37:26,217 - INFO - 7-create_word:219 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:37:26,217 - INFO - 7-create_word:230 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:37:26,262 - INFO - 7-create_word:250 - Applying consistent formatting to table cells.
2025-08-20 15:37:26,306 - INFO - 7-create_word:272 - Table update and formatting complete.
2025-08-20 15:37:26,317 - INFO - 7-create_word:289 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:37:26,317 - INFO - 7-create_word:295 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:37:26,317 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:37:26,391 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:37:26,391 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:37:26,391 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,391 - ERROR - 7-create_word:307 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 300, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,484 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,484 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,563 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,563 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,692 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,692 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,823 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,823 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:37:26,932 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:37:26,932 - ERROR - 1-get_arpege:162 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 156, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:10,607 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:77 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 15:41:10,608 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-20 15:41:10,608 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 15:41:10,608 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:41:10,870 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:41:10,883 - INFO - fetchdata:81 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 15:41:10,884 - INFO - 1-get_arpege:108 - Found 9 matching files on FTP server:
2025-08-20 15:41:10,884 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,884 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,884 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,885 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:10,886 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-20 15:41:10,886 - INFO - 1-get_arpege:124 - Attempting to download 9 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:10,886 - INFO - fetchdata:171 - Starting FTP file fetching process for 9 files.
2025-08-20 15:41:10,886 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:41:11,106 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:41:11,106 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:11,107 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:11,602 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:11,602 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:11,602 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:12,035 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:12,036 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:12,036 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:12,507 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:12,507 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:12,507 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:13,141 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:13,141 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:13,141 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:13,734 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:13,734 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:13,734 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:14,258 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:14,258 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:14,258 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:14,732 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:14,732 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:14,733 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:15,175 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:15,175 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:15,175 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:15,451 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:15,452 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:41:15,452 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:41:15,452 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-20 15:41:15,452 - INFO - 1-get_arpege:150 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 15:41:15,452 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-20 15:41:15,452 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:16,249 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:41:16,249 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:16,249 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:16,249 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:16,249 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:16,249 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:16,249 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:41:16,249 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:41:16,249 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:41:16,249 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:41:16,250 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:41:16,250 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:16,650 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:16,650 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:41:16,650 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,044 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,044 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:41:17,045 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,508 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,508 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:41:17,508 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,902 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,902 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,902 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,915 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,915 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:17,915 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:41:17,916 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:41:17,917 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:41:17,918 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:41:17,919 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:41:17,919 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:41:17,919 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:41:17,919 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:17,919 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:41:17,919 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:18,853 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,856 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,867 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:41:18,876 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:19,117 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:41:19,117 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:24,022 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:41:24,022 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:29,135 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:29,135 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:41:29,184 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,184 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:41:29,185 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,185 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:41:29,193 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:41:29,196 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:30,106 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:41:30,106 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,269 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:41:30,269 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:41:30,373 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:41:30,376 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:41:30,379 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:41:30,380 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:30,915 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,915 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:41:30,918 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:30,926 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,927 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,931 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:41:30,937 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:41:30,937 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:41:30,938 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,942 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:41:30,947 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:41:30,963 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:41:30,963 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:41:30,978 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:41:30,985 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:41:30,991 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:30,999 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:41:31,000 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,000 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:41:31,000 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,980 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,981 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,077 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,915 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,915 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:41:30,918 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:30,926 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,927 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,931 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:41:30,937 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:41:30,937 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:41:30,938 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,942 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:41:30,947 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:41:30,963 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:41:30,963 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:41:30,978 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:41:30,985 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:41:30,991 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:30,999 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:41:31,000 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,000 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:41:31,000 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,980 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,981 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,078 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,247 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:30,106 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:41:30,106 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,269 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:41:30,269 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:41:30,373 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:41:30,376 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:41:30,379 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:41:30,380 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,077 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,915 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,915 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:41:30,918 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:30,926 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,927 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,931 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:41:30,937 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:41:30,937 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:41:30,938 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,942 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:41:30,947 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:41:30,963 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:41:30,963 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:41:30,978 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:41:30,985 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:41:30,991 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:30,999 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:41:31,000 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,000 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:41:31,000 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,980 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,981 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,078 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,248 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,387 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,387 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:18,853 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,856 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,867 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:41:18,876 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:19,117 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:41:19,117 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:24,022 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:41:24,022 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:29,135 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:29,135 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:41:29,184 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,184 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:41:29,185 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,185 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:41:29,193 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:41:29,196 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,247 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:30,106 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:41:30,106 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,269 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:41:30,269 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:41:30,373 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:41:30,376 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:41:30,379 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:41:30,380 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,077 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,915 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,915 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:41:30,918 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:30,926 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,927 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,931 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:41:30,937 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:41:30,937 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:41:30,938 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,942 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:41:30,947 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:41:30,963 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:41:30,963 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:41:30,978 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:41:30,985 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:41:30,991 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:30,999 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:41:31,000 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,000 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:41:31,000 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,980 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,981 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,078 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,248 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,387 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,387 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,523 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,523 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:16,249 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:41:16,249 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:16,249 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:16,249 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:16,249 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:16,249 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:16,249 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:41:16,249 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:41:16,249 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:41:16,249 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:41:16,250 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:41:16,250 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:16,650 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:16,650 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:41:16,650 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,044 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,044 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:41:17,045 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,508 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,508 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:41:17,508 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:17,902 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:17,902 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,902 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,915 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:17,915 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:17,915 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:41:17,916 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:41:17,917 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:41:17,918 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:41:17,919 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:41:17,919 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:41:17,919 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:41:17,919 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:17,919 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:41:17,919 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,387 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,387 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:18,852 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:18,852 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:18,853 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,856 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:18,867 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:41:18,876 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:19,117 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:41:19,117 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:41:19,117 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:24,022 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:41:24,022 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:41:24,022 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:29,135 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:29,135 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:41:29,184 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:41:29,184 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,184 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:41:29,185 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:41:29,185 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:41:29,185 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:41:29,186 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:41:29,193 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:29,195 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:41:29,196 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,247 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:41:30,105 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:30,106 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:41:30,106 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:41:30,106 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,269 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:41:30,269 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:41:30,373 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:41:30,373 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:41:30,376 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:41:30,379 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,380 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:41:30,380 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:32,077 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:30,915 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:30,915 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:41:30,918 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:41:30,926 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,927 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,931 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:41:30,937 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:41:30,937 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:41:30,938 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:41:30,942 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:41:30,947 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:41:30,963 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:41:30,963 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:41:30,978 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:41:30,985 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:41:30,991 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:30,999 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:41:31,000 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,000 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:41:31,000 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,980 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:58 - STDOUT: 2025-08-20 15:41:31,549 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:41:31,549 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:31,549 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,549 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:31,550 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:31,550 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:41:31,550 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:41:31,550 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:41:31,637 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:31,637 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:41:31,638 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,638 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,638 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,638 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,645 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:41:31,645 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,660 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:41:31,671 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:41:31,671 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:41:31,674 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:41:31,675 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:41:31,675 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:41:31,717 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:41:31,762 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:41:31,774 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:41:31,774 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:41:31,774 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:31,853 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-20 15:41:31,854 - ERROR - system_utils:58 - STDOUT: Error: PyTAP library not found. Please install it using 'pip install pytaps'.
2025-08-20 15:41:31,854 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,854 - ERROR - 7-create_word:290 - An error occurred while running 8-send_MSG.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py", line 283, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:31,981 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:31,981 - ERROR - 6-create_tables:226 - An error occurred while running 7-create_word.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py", line 220, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/7-create_word.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,078 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,078 - ERROR - 5-traitement_obs_min_max:195 - An error occurred while running 6-create_tables.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py", line 189, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,248 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,248 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,387 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,387 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:32,523 - ERROR - system_utils:59 - STDERR: 
2025-08-20 15:41:32,523 - ERROR - 1-get_arpege:162 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/bqrm/BMSLA/scr/1-get_arpege.py", line 156, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/bqrm/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:77 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 15:41:43,911 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-20 15:41:43,911 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 15:41:43,911 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:41:44,115 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:41:44,129 - INFO - fetchdata:81 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 15:41:44,130 - INFO - 1-get_arpege:108 - Found 9 matching files on FTP server:
2025-08-20 15:41:44,130 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,130 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,131 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,132 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,132 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-20 15:41:44,132 - INFO - 1-get_arpege:124 - Attempting to download 9 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:41:44,132 - INFO - fetchdata:171 - Starting FTP file fetching process for 9 files.
2025-08-20 15:41:44,133 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:41:44,340 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:41:44,341 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:44,341 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,943 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:44,943 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:44,943 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:45,483 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:45,483 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:45,483 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:45,946 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:45,946 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:45,946 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:46,372 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:46,372 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:46,372 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:46,950 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:46,950 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:46,950 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:47,541 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:47,541 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:47,542 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,087 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,087 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:48,087 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,544 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,544 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:41:48,544 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,761 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:41:48,761 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:41:48,761 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:41:48,761 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-20 15:41:48,761 - INFO - 1-get_arpege:150 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 15:41:48,761 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-20 15:41:48,761 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:49,498 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:41:49,499 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:49,499 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:49,499 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:49,499 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:49,499 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:41:49,499 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:41:49,499 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:41:49,499 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:41:49,499 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:41:49,499 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:41:49,499 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:49,881 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:49,882 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:41:49,882 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:50,284 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:50,284 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:41:50,284 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:50,682 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:50,682 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:41:50,682 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:51,075 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:41:51,075 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:51,075 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:51,087 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:41:51,087 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:51,087 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:41:51,088 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:41:51,088 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:41:51,089 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:41:51,090 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:41:51,090 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:41:51,090 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:41:51,090 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:51,090 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:41:51,090 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:41:51,974 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:41:51,974 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:41:51,975 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:51,977 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:41:51,987 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:41:51,996 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:41:52,232 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:41:52,232 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:41:52,232 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:41:52,232 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:41:56,862 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:41:56,862 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:41:56,862 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:41:56,862 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:42:01,502 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:42:01,503 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:42:01,549 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:42:01,549 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:42:01,549 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:42:01,550 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:42:01,550 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:42:01,550 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:42:01,550 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:42:01,550 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:42:01,551 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:42:01,551 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:42:01,552 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:42:01,558 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:42:01,560 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:42:01,560 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:42:01,560 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:42:01,560 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:42:02,440 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:42:02,440 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:42:02,440 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:42:02,440 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:42:02,440 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:42:02,441 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:42:02,441 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:42:02,441 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:42:02,441 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:42:02,441 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:42:02,590 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:42:02,591 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:42:02,691 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:42:02,691 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:42:02,691 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:42:02,695 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:42:02,697 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:42:02,699 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:42:02,699 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:42:02,699 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:42:03,209 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:42:03,210 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:42:03,212 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:42:03,221 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:42:03,222 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:42:03,226 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:42:03,232 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:42:03,232 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:42:03,233 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:42:03,238 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:42:03,243 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:42:03,259 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:42:03,259 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:42:03,274 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:42:03,282 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:42:03,288 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,297 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:42:03,297 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,297 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:42:03,297 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:42:03,867 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:42:03,867 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:42:03,867 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:42:03,867 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:42:03,867 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:42:03,867 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:42:03,867 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:42:03,868 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:42:03,868 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:42:03,952 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:42:03,952 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:42:03,952 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,952 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:42:03,952 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:42:03,952 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,959 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:42:03,959 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,972 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:42:03,982 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:42:03,982 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:42:03,985 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:42:03,985 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:42:03,985 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:42:03,985 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:42:04,022 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:42:04,061 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:42:04,071 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:42:04,071 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:42:04,071 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:42:04,137 - INFO - 8-send_MSG:73 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:42:04,137 - INFO - 8-send_MSG:74 - Starting daily antiacridienne bulletin sending script.
2025-08-20 15:42:04,137 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:42:04,137 - INFO - 8-send_MSG:93 - File found and added for attachment: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:42:04,137 - INFO - 8-send_MSG:107 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 20/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-20 15:42:04,137 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 20/08/2025'
2025-08-20 15:42:04,353 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-20 15:42:04,355 - INFO - 8-send_MSG:123 - Email process completed successfully.
2025-08-20 15:42:04,355 - INFO - 8-send_MSG:128 - Script execution finished.
2025-08-20 15:42:04,370 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,370 - INFO - 7-create_word:288 - Successfully executed 8-send_MSG.py.
2025-08-20 15:42:04,370 - INFO - 7-create_word:296 - --- Script '7-create_word.py' finished. ---
2025-08-20 15:42:04,476 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,476 - INFO - 6-create_tables:224 - Successfully executed 7-create_word.py.
2025-08-20 15:42:04,476 - INFO - 6-create_tables:233 - --- Script '6-create_tables.py' finished. ---
2025-08-20 15:42:04,553 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,553 - INFO - 5-traitement_obs_min_max:193 - Successfully executed 6-create_tables.py.
2025-08-20 15:42:04,553 - INFO - 5-traitement_obs_min_max:202 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-20 15:42:04,678 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,679 - INFO - 3-create_forecast_table:253 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-20 15:42:04,679 - INFO - 3-create_forecast_table:261 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-20 15:42:04,815 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,816 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-20 15:42:04,816 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-20 15:42:04,939 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:42:04,939 - INFO - 1-get_arpege:160 - Successfully executed 2-conv.py.
2025-08-20 15:42:04,940 - INFO - 1-get_arpege:169 - --- Script '1-get_arpege.py' finished. ---
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:18,525 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:44:18,526 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-20 15:44:18,526 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:44:18,526 - INFO - 1-get_arpege:77 - Fetching files for date: 20250820 with pattern: *SP1*20250820000*
2025-08-20 15:44:18,526 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-20 15:44:18,526 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250820000*)...
2025-08-20 15:44:18,526 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:44:18,768 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:44:18,781 - INFO - fetchdata:81 - Found 9 files matching pattern '*SP1*20250820000*'.
2025-08-20 15:44:18,782 - INFO - 1-get_arpege:108 - Found 9 matching files on FTP server:
2025-08-20 15:44:18,782 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,782 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,782 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,782 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,783 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,783 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,783 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,783 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,783 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:18,784 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-20 15:44:18,784 - INFO - 1-get_arpege:124 - Attempting to download 9 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:44:18,784 - INFO - fetchdata:171 - Starting FTP file fetching process for 9 files.
2025-08-20 15:44:18,784 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-20 15:44:19,007 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-20 15:44:19,007 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:19,008 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:19,434 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:19,434 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:19,434 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:19,856 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:19,856 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:19,857 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:20,275 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:20,276 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:20,276 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:20,713 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:20,713 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:20,714 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:21,140 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:21,140 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:21,140 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:21,603 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:21,603 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:21,603 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,047 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+73H84H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,048 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:22,048 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,471 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+85H96H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,471 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 is missing. Downloading.
2025-08-20 15:44:22,471 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,710 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+97H102H_C_LFPW_202508200000--.grib2
2025-08-20 15:44:22,710 - INFO - fetchdata:257 - FTP client closed.
2025-08-20 15:44:22,710 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-20 15:44:22,710 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-20 15:44:22,711 - INFO - 1-get_arpege:150 - Successfully verified 9 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-20 15:44:22,711 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-20 15:44:22,711 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:23,436 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-20 15:44:23,436 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:44:23,437 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:23,437 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:23,437 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:23,437 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-20 15:44:23,437 - INFO - 2-conv:56 - Processing for date: 20250820
2025-08-20 15:44:23,437 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-20 15:44:23,437 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2. Processing this branch.
2025-08-20 15:44:23,437 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-20 15:44:23,437 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2' to 't2m00-12.grib'.
2025-08-20 15:44:23,438 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:23,797 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:44:23,797 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2' to 't2m12-24.grib'.
2025-08-20 15:44:23,797 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:24,145 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:44:24,145 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2' to 't2m24-36.grib'.
2025-08-20 15:44:24,145 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:24,495 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:44:24,495 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2' to 't2m36-48.grib'.
2025-08-20 15:44:24,495 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508200000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:24,848 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-20 15:44:24,848 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:44:24,848 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:44:24,860 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib'.
2025-08-20 15:44:24,860 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:44:24,860 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-20 15:44:24,861 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-20 15:44:24,862 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-20 15:44:24,862 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-20 15:44:24,863 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-20 15:44:24,863 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-20 15:44:24,863 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-20 15:44:24,863 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:44:24,863 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-20 15:44:24,863 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:25,675 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-20 15:44:25,676 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:44:25,676 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:25,676 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:25,676 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:25,676 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:25,676 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:44:25,677 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:44:25,679 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-20 15:44:25,689 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-20 15:44:25,697 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250820.grib
2025-08-20 15:44:25,915 - INFO - grib_processor:113 - GRIB file '2t_20250820.grib' opened successfully.
2025-08-20 15:44:25,916 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-20 15:44:25,916 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-20 15:44:25,916 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:44:30,532 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:44:30,532 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-20 15:44:30,533 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-20 15:44:30,533 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-20 15:44:35,014 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-20 15:44:35,015 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-20 15:44:35,059 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-20 15:44:35,059 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-20 15:44:35,060 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:44:35,060 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:44:35,060 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-20 15:44:35,060 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-20 15:44:35,060 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-20 15:44:35,060 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-20 15:44:35,061 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-20 15:44:35,061 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-20 15:44:35,062 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-20 15:44:35,068 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:44:35,070 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:44:35,070 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:44:35,070 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-20 15:44:35,070 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:35,881 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-20 15:44:35,881 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:35,882 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:35,882 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:44:35,882 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-20 15:44:35,883 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-20 15:44:35,883 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508200600.bufr
2025-08-20 15:44:35,883 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/19/Synop_202508191800.bufr
2025-08-20 15:44:35,883 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-20 15:44:35,883 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508200600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:44:36,023 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 88
2025-08-20 15:44:36,023 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/19/Synop_202508191800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-20 15:44:36,115 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 84
2025-08-20 15:44:36,116 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-20 15:44:36,116 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-20 15:44:36,119 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-20 15:44:36,121 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-20 15:44:36,123 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:44:36,123 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-20 15:44:36,123 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:36,617 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:44:36,618 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-20 15:44:36,620 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250820.csv
2025-08-20 15:44:36,628 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:44:36,630 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:44:36,634 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-20 15:44:36,639 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-20 15:44:36,640 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-20 15:44:36,641 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250820.csv
2025-08-20 15:44:36,645 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-20 15:44:36,650 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-20 15:44:36,665 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-20 15:44:36,665 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-20 15:44:36,679 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-20 15:44:36,686 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-20 15:44:36,692 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:36,701 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-20 15:44:36,701 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:36,701 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-20 15:44:36,701 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:37,232 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-20 15:44:37,232 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:44:37,233 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:37,233 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:37,233 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-20 15:44:37,233 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-20 15:44:37,233 - INFO - 7-create_word:76 - Processed dates - Today: 20-08-2025, Tomorrow: 21-08-2025, Yesterday: 19-08-2025
2025-08-20 15:44:37,233 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-20 15:44:37,233 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-20 15:44:37,313 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 10 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-20 15:44:37,313 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-20 15:44:37,313 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:37,313 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:44:37,313 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:44:37,313 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:37,320 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-20 15:44:37,320 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:37,333 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-20 15:44:37,342 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-20 15:44:37,342 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:44:37,345 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 19-08-2025 et prévues pour le 20-08-2025 et 21-08-2025 : '
2025-08-20 15:44:37,345 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-20 15:44:37,345 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-20 15:44:37,345 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-20 15:44:37,380 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-20 15:44:37,417 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-20 15:44:37,427 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:44:37,427 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-20 15:44:37,427 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-20 15:44:37,488 - INFO - 8-send_MSG:74 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-20 15:44:37,488 - INFO - 8-send_MSG:75 - Starting daily antiacridienne bulletin sending script.
2025-08-20 15:44:37,489 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-20, Yesterday: 2025-08-19
2025-08-20 15:44:37,489 - INFO - 8-send_MSG:95 - File found and added for attachment: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_20-08-2025.docx
2025-08-20 15:44:37,489 - INFO - 8-send_MSG:109 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 20/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-20 15:44:37,489 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 20/08/2025'
2025-08-20 15:44:37,694 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-20 15:44:37,696 - INFO - 8-send_MSG:125 - Email process completed successfully.
2025-08-20 15:44:37,696 - INFO - 8-send_MSG:132 - Attempting to clean up temporary directory: /home/aoumeur/bqrm/BMSLA/../tmp
2025-08-20 15:44:37,697 - WARNING - file_operations:280 - Directory not found: /home/aoumeur/bqrm/tmp. Skipping cleanup.
2025-08-20 15:44:37,697 - INFO - 8-send_MSG:143 - No files found to clean in /home/aoumeur/bqrm/BMSLA/../tmp or all files were already gone.
2025-08-20 15:44:37,697 - INFO - 8-send_MSG:148 - Script execution finished.
2025-08-20 15:44:37,724 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:37,724 - INFO - 7-create_word:288 - Successfully executed 8-send_MSG.py.
2025-08-20 15:44:37,724 - INFO - 7-create_word:296 - --- Script '7-create_word.py' finished. ---
2025-08-20 15:44:37,811 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:37,811 - INFO - 6-create_tables:224 - Successfully executed 7-create_word.py.
2025-08-20 15:44:37,811 - INFO - 6-create_tables:233 - --- Script '6-create_tables.py' finished. ---
2025-08-20 15:44:37,884 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:37,884 - INFO - 5-traitement_obs_min_max:193 - Successfully executed 6-create_tables.py.
2025-08-20 15:44:37,884 - INFO - 5-traitement_obs_min_max:202 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-20 15:44:38,010 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:38,010 - INFO - 3-create_forecast_table:253 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-20 15:44:38,010 - INFO - 3-create_forecast_table:261 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-20 15:44:38,135 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:38,135 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-20 15:44:38,135 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-20 15:44:38,242 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-20 15:44:38,242 - INFO - 1-get_arpege:160 - Successfully executed 2-conv.py.
2025-08-20 15:44:38,242 - INFO - 1-get_arpege:169 - --- Script '1-get_arpege.py' finished. ---
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:77 - Fetching files for date: 20250821 with pattern: *SP1*20250821000*
2025-08-21 09:15:02,118 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-21 09:15:02,118 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250821000*)...
2025-08-21 09:15:02,118 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 09:15:02,368 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 09:15:02,381 - INFO - fetchdata:81 - Found 6 files matching pattern '*SP1*20250821000*'.
2025-08-21 09:15:02,382 - INFO - 1-get_arpege:108 - Found 6 matching files on FTP server:
2025-08-21 09:15:02,382 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,382 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,382 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,383 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,383 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,383 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:02,383 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-21 09:15:02,383 - INFO - 1-get_arpege:124 - Attempting to download 6 files to /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-21 09:15:02,384 - INFO - fetchdata:171 - Starting FTP file fetching process for 6 files.
2025-08-21 09:15:02,384 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 09:15:02,603 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 09:15:02,604 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:02,604 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:03,074 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:03,074 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:03,074 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:03,545 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:03,545 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:03,545 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,005 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,005 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:04,006 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,492 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,493 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:04,493 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,963 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:04,963 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 09:15:04,963 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 to /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:05,446 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 09:15:05,447 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 09:15:05,447 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 09:15:05,447 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-21 09:15:05,447 - INFO - 1-get_arpege:150 - Successfully verified 6 files downloaded to '/home/aoumeur/bqrm/BMSLA/tmp'.
2025-08-21 09:15:05,447 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-21 09:15:05,447 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:06,200 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 09:15:06,200 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-21 09:15:06,200 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:06,200 - INFO - 2-conv:44 - Script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:06,200 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:06,200 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/bqrm/BMSLA/tmp
2025-08-21 09:15:06,200 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 09:15:06,200 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 09:15:06,200 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 09:15:06,200 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 09:15:06,200 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 09:15:06,200 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:06,363 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 09:15:06,363 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 09:15:06,363 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:06,533 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 09:15:06,534 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 09:15:06,534 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:06,700 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 09:15:06,700 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 09:15:06,700 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/bqrm/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:06,864 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 09:15:06,864 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 09:15:06,864 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 09:15:06,876 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 09:15:06,876 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib
2025-08-21 09:15:06,876 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 09:15:06,877 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m00-12.grib
2025-08-21 09:15:06,878 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m12-24.grib
2025-08-21 09:15:06,879 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m24-36.grib
2025-08-21 09:15:06,879 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/bqrm/BMSLA/tmp/t2m36-48.grib
2025-08-21 09:15:06,879 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 09:15:06,879 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 09:15:06,879 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib
2025-08-21 09:15:06,879 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 09:15:06,880 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:07,720 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:07,720 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 09:15:07,721 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-21 09:15:07,724 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/template/station_onm_officielle.csv
2025-08-21 09:15:07,734 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 09:15:07,743 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/bqrm/BMSLA/tmp/2t_20250821.grib
2025-08-21 09:15:07,984 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 09:15:07,984 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 09:15:07,985 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 09:15:07,985 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 09:15:12,717 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 09:15:12,717 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 09:15:12,717 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 09:15:12,717 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 09:15:17,295 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 09:15:17,295 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 09:15:17,341 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 09:15:17,341 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 09:15:17,341 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 09:15:17,341 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 09:15:17,341 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 09:15:17,342 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 09:15:17,342 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 09:15:17,342 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 09:15:17,342 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 09:15:17,342 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 09:15:17,343 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 09:15:17,350 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 09:15:17,362 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 09:15:17,362 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 09:15:17,362 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 09:15:17,362 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:18,189 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 09:15:18,189 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:18,189 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:18,189 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 09:15:18,189 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 09:15:18,190 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 09:15:18,190 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 09:15:18,190 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/bqrm/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 09:15:18,190 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-21 09:15:18,190 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/21/Synop_202508210600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-21 09:15:18,340 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-21 09:15:18,340 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/bqrm/bufr_data/observations/2025/08/20/Synop_202508201800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-21 09:15:18,447 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-21 09:15:18,447 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-21 09:15:18,447 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-21 09:15:18,450 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-21 09:15:18,452 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/bqrm/BMSLA/outputs/observations
2025-08-21 09:15:18,454 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 09:15:18,454 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-21 09:15:18,454 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:18,989 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 09:15:18,990 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/bqrm/BMSLA/outputs
2025-08-21 09:15:18,992 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/bqrm/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 09:15:19,001 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 09:15:19,002 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 09:15:19,006 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-21 09:15:19,012 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-21 09:15:19,012 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250821.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-21 09:15:19,013 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/bqrm/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 09:15:19,017 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-21 09:15:19,023 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-21 09:15:19,038 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-21 09:15:19,039 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-21 09:15:19,054 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-21 09:15:19,061 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-21 09:15:19,067 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,076 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-21 09:15:19,076 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,076 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-21 09:15:19,076 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:19,675 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-21 09:15:19,675 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-21 09:15:19,675 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:19,675 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:19,675 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/bqrm/BMSLA/scr
2025-08-21 09:15:19,675 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/bqrm/BMSLA
2025-08-21 09:15:19,675 - INFO - 7-create_word:76 - Processed dates - Today: 21-08-2025, Tomorrow: 22-08-2025, Yesterday: 20-08-2025
2025-08-21 09:15:19,675 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/bqrm/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-21 09:15:19,676 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/bqrm/BMSLA/tmp (Pattern: All files)
2025-08-21 09:15:19,730 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/bqrm/BMSLA/tmp.
2025-08-21 09:15:19,730 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-21 09:15:19,731 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,731 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-21 09:15:19,731 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 09:15:19,731 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,738 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-21 09:15:19,738 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,751 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/bqrm/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 09:15:19,760 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/bqrm/BMSLA/template/Bulletin_sud.docx
2025-08-21 09:15:19,760 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 20-08-2025 et prévues pour le 21-08-2025 et 22-08-2025 : '
2025-08-21 09:15:19,763 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 20-08-2025 et prévues pour le 21-08-2025 et 22-08-2025 : '
2025-08-21 09:15:19,763 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-21 09:15:19,763 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-21 09:15:19,764 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-21 09:15:19,799 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-21 09:15:19,838 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-21 09:15:19,848 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 09:15:19,848 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-21 09:15:19,848 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/bqrm/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/bqrm/BMSLA/scr'
2025-08-21 09:15:19,911 - INFO - 8-send_MSG:74 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/bqrm/BMSLA/scr/logs/BMSLA.log
2025-08-21 09:15:19,911 - INFO - 8-send_MSG:75 - Starting daily antiacridienne bulletin sending script.
2025-08-21 09:15:19,911 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 09:15:19,911 - INFO - 8-send_MSG:95 - File found and added for attachment: /home/aoumeur/bqrm/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 09:15:19,911 - INFO - 8-send_MSG:109 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 21/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-21 09:15:19,911 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 21/08/2025'
2025-08-21 09:15:20,126 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-21 09:15:20,128 - INFO - 8-send_MSG:125 - Email process completed successfully.
2025-08-21 09:15:20,129 - INFO - 8-send_MSG:132 - Attempting to clean up temporary directory: /home/aoumeur/bqrm/BMSLA/../tmp
2025-08-21 09:15:20,129 - WARNING - file_operations:280 - Directory not found: /home/aoumeur/bqrm/tmp. Skipping cleanup.
2025-08-21 09:15:20,129 - INFO - 8-send_MSG:143 - No files found to clean in /home/aoumeur/bqrm/BMSLA/../tmp or all files were already gone.
2025-08-21 09:15:20,130 - INFO - 8-send_MSG:148 - Script execution finished.
2025-08-21 09:15:20,158 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,159 - INFO - 7-create_word:288 - Successfully executed 8-send_MSG.py.
2025-08-21 09:15:20,159 - INFO - 7-create_word:296 - --- Script '7-create_word.py' finished. ---
2025-08-21 09:15:20,274 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,274 - INFO - 6-create_tables:224 - Successfully executed 7-create_word.py.
2025-08-21 09:15:20,274 - INFO - 6-create_tables:233 - --- Script '6-create_tables.py' finished. ---
2025-08-21 09:15:20,358 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,358 - INFO - 5-traitement_obs_min_max:193 - Successfully executed 6-create_tables.py.
2025-08-21 09:15:20,358 - INFO - 5-traitement_obs_min_max:202 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-21 09:15:20,496 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,496 - INFO - 3-create_forecast_table:253 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-21 09:15:20,496 - INFO - 3-create_forecast_table:261 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-21 09:15:20,626 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,626 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-21 09:15:20,626 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-21 09:15:20,740 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 09:15:20,740 - INFO - 1-get_arpege:160 - Successfully executed 2-conv.py.
2025-08-21 09:15:20,740 - INFO - 1-get_arpege:169 - --- Script '1-get_arpege.py' finished. ---
2025-08-21 11:35:04,210 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:77 - Fetching files for date: 20250821 with pattern: *SP1*20250821000*
2025-08-21 11:35:04,211 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-21 11:35:04,211 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250821000*)...
2025-08-21 11:35:04,211 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:35:04,451 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:35:04,465 - INFO - fetchdata:81 - Found 6 files matching pattern '*SP1*20250821000*'.
2025-08-21 11:35:04,466 - INFO - 1-get_arpege:108 - Found 6 matching files on FTP server:
2025-08-21 11:35:04,466 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,466 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,466 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,466 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,467 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,467 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:04,467 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-21 11:35:04,467 - INFO - 1-get_arpege:124 - Attempting to download 6 files to /home/aoumeur/BQRM_V01/BMSLA/tmp.
2025-08-21 11:35:04,468 - INFO - fetchdata:171 - Starting FTP file fetching process for 6 files.
2025-08-21 11:35:04,468 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:35:04,687 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:35:04,688 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:04,688 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:05,114 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:05,114 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:05,114 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:05,565 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:05,565 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:05,565 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:06,138 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:06,138 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:06,139 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:06,759 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:06,760 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:06,760 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:07,343 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:07,344 - INFO - fetchdata:227 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 is missing. Downloading.
2025-08-21 11:35:07,344 - INFO - fetchdata:230 - Downloading /share/meteofrance/Arpege_Orig/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 to /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:07,813 - INFO - fetchdata:239 - Successfully downloaded W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 11:35:07,814 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 11:35:07,814 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 11:35:07,814 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-21 11:35:07,814 - INFO - 1-get_arpege:150 - Successfully verified 6 files downloaded to '/home/aoumeur/BQRM_V01/BMSLA/tmp'.
2025-08-21 11:35:07,814 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-21 11:35:07,814 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:08,590 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 11:35:08,591 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:08,591 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:08,591 - INFO - 2-conv:44 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:08,591 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:08,591 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:35:08,591 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 11:35:08,591 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 11:35:08,591 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 11:35:08,591 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 11:35:08,591 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 11:35:08,591 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:08,960 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:08,960 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 11:35:08,960 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:09,319 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:09,319 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 11:35:09,319 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:09,674 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:09,675 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 11:35:09,675 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:10,034 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:10,034 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,034 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,047 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,047 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:10,047 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 11:35:10,048 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib
2025-08-21 11:35:10,049 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib
2025-08-21 11:35:10,049 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib
2025-08-21 11:35:10,050 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib
2025-08-21 11:35:10,050 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 11:35:10,050 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 11:35:10,050 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:10,050 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 11:35:10,050 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:10,877 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:10,879 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,881 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,891 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:35:10,899 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:11,137 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:35:11,138 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:15,940 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:35:15,940 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:20,899 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:20,899 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:35:20,955 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,955 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:35:20,956 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,956 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:35:20,965 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:35:20,967 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:21,879 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:35:22,044 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,044 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:21,879 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:35:22,044 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,044 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:35:22,179 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,179 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:10,877 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:10,879 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,881 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,891 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:35:10,899 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:11,137 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:35:11,138 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:15,940 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:35:15,940 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:20,899 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:20,899 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:35:20,955 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,955 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:35:20,956 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,956 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:35:20,965 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:35:20,967 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:22,044 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,044 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:21,879 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:35:22,044 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,044 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:35:22,179 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,179 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:35:22,316 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,316 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:08,590 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 11:35:08,591 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:08,591 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:08,591 - INFO - 2-conv:44 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:08,591 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:08,591 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:35:08,591 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 11:35:08,591 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 11:35:08,591 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 11:35:08,591 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 11:35:08,591 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 11:35:08,591 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:08,960 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:08,960 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 11:35:08,960 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:09,319 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:09,319 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 11:35:09,319 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:09,674 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:09,675 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 11:35:09,675 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:10,034 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:35:10,034 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,034 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,047 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:35:10,047 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:10,047 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 11:35:10,048 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib
2025-08-21 11:35:10,049 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib
2025-08-21 11:35:10,049 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib
2025-08-21 11:35:10,050 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib
2025-08-21 11:35:10,050 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 11:35:10,050 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 11:35:10,050 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:10,050 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 11:35:10,050 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:22,179 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,179 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:10,877 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:10,878 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:10,878 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:10,879 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,881 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:35:10,891 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:35:10,899 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:35:11,137 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:35:11,138 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:35:11,138 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:15,940 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:35:15,940 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:35:15,940 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:35:20,899 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:35:20,899 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:35:20,955 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:35:20,955 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,955 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:35:20,956 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:35:20,956 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:35:20,956 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:35:20,957 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:35:20,965 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:35:20,967 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:35:20,967 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:35:22,044 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:35:22,044 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:35:21,879 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:35:21,879 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:35:21,880 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:35:21,880 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:35:22,044 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,044 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:35:22,179 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,179 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:35:22,317 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:35:22,317 - ERROR - 1-get_arpege:162 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/1-get_arpege.py", line 156, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:36:34,144 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-21 11:36:34,145 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:36:34,145 - INFO - 1-get_arpege:77 - Fetching files for date: 20250821 with pattern: *SP1*20250821000*
2025-08-21 11:36:34,145 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-21 11:36:34,145 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250821000*)...
2025-08-21 11:36:34,145 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:36:34,407 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:36:34,426 - INFO - fetchdata:81 - Found 6 files matching pattern '*SP1*20250821000*'.
2025-08-21 11:36:34,428 - INFO - 1-get_arpege:108 - Found 6 matching files on FTP server:
2025-08-21 11:36:34,428 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,428 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,429 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,429 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,429 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,429 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 11:36:34,429 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-21 11:36:34,430 - INFO - 1-get_arpege:124 - Attempting to download 6 files to /home/aoumeur/BQRM_V01/BMSLA/tmp.
2025-08-21 11:36:34,430 - INFO - fetchdata:171 - Starting FTP file fetching process for 6 files.
2025-08-21 11:36:34,430 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:36:34,656 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:36:34,666 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,676 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,687 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,696 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,707 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,716 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:36:34,719 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 11:36:34,719 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 11:36:34,719 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-21 11:36:34,720 - INFO - 1-get_arpege:150 - Successfully verified 6 files downloaded to '/home/aoumeur/BQRM_V01/BMSLA/tmp'.
2025-08-21 11:36:34,720 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-21 11:36:34,720 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:35,648 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 11:36:35,648 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:35,648 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:35,649 - INFO - 2-conv:44 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:35,649 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:35,649 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:36:35,649 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 11:36:35,649 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 11:36:35,649 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 11:36:35,649 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 11:36:35,649 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 11:36:35,649 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,021 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,022 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 11:36:36,022 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,435 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,435 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 11:36:36,435 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,841 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,841 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 11:36:36,842 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:37,250 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:37,250 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,250 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,311 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,311 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:37,311 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 11:36:37,313 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib
2025-08-21 11:36:37,315 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib
2025-08-21 11:36:37,317 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib
2025-08-21 11:36:37,319 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib
2025-08-21 11:36:37,319 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 11:36:37,319 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 11:36:37,320 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:37,320 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 11:36:37,320 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:38,270 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,273 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,284 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:36:38,295 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:38,559 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:36:38,559 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:36:38,560 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:36:38,560 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:43,533 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:36:43,533 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:48,287 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:48,287 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:36:48,337 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,337 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:36:48,338 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,338 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:36:48,347 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:36:48,349 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:49,269 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:36:49,443 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,443 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:49,269 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:36:49,444 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,444 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:49,608 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,608 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:38,270 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,273 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,284 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:36:38,295 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:38,559 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:36:38,559 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:36:38,560 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:36:38,560 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:43,533 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:36:43,533 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:48,287 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:48,287 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:36:48,337 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,337 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:36:48,338 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,338 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:36:48,347 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:36:48,349 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:49,443 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,443 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:49,269 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:36:49,444 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,444 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:49,608 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,608 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:49,731 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,732 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:35,648 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 11:36:35,648 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:35,648 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:35,649 - INFO - 2-conv:44 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:35,649 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:35,649 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:36:35,649 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 11:36:35,649 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 11:36:35,649 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 11:36:35,649 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 11:36:35,649 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 11:36:35,649 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,021 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,022 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 11:36:36,022 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,435 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,435 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 11:36:36,435 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:36,841 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:36,841 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 11:36:36,842 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:37,250 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:36:37,250 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,250 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,311 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:36:37,311 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:37,311 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 11:36:37,313 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib
2025-08-21 11:36:37,315 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib
2025-08-21 11:36:37,317 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib
2025-08-21 11:36:37,319 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib
2025-08-21 11:36:37,319 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 11:36:37,319 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 11:36:37,320 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:37,320 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 11:36:37,320 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:49,608 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,608 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:38,268 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:38,268 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:38,270 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,273 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:36:38,284 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:36:38,295 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:36:38,559 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:36:38,559 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:36:38,560 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:36:38,560 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:43,533 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:36:43,533 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:36:43,533 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:36:48,287 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:36:48,287 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:36:48,337 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:36:48,337 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,337 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:36:48,338 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:36:48,338 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:36:48,338 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:36:48,339 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:36:48,347 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:36:48,349 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:36:48,349 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:36:49,443 - ERROR - system_utils:57 - Command '/usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log' failed with exit code 1.
2025-08-21 11:36:49,443 - ERROR - system_utils:58 - STDOUT: 2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:36:49,269 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:36:49,269 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:36:49,270 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - WARNING - file_operations:245 - File not found: /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr. Skipping this operation.
2025-08-21 11:36:49,270 - ERROR - 5-traitement_obs_min_max:107 - Neither BUFR file found. Both /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr and /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr are missing. Aborting processing.
2025-08-21 11:36:49,444 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,444 - ERROR - 3-create_forecast_table:255 - An error occurred while running 5-traitement_obs_min_max.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py", line 249, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:49,608 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,608 - ERROR - 2-conv:137 - An error occurred while running 3-create_forecast_table.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py", line 131, in main
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:36:49,732 - ERROR - system_utils:59 - STDERR: 
2025-08-21 11:36:49,732 - ERROR - 1-get_arpege:162 - An error occurred while running 2-conv.py: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
Traceback (most recent call last):
  File "/home/aoumeur/BQRM_V01/BMSLA/scr/1-get_arpege.py", line 156, in <module>
    execute_command(
  File "/home/aoumeur/Téléchargements/PyTAP-main/src/pytaps/system_utils.py", line 39, in execute_command
    result = subprocess.run(
  File "/usr/lib/python3.10/subprocess.py", line 526, in run
    raise CalledProcessError(retcode, process.args,
subprocess.CalledProcessError: Command '['/usr/bin/python3', '/home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py', '--shared-log-file', '/home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log']' returned non-zero exit status 1.
2025-08-21 11:43:10,590 - INFO - 1-get_arpege:56 - --- Script '1-get_arpege.py' started ---
2025-08-21 11:43:10,590 - INFO - 1-get_arpege:57 - Logger configured. All logs for this workflow will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:43:10,590 - INFO - 1-get_arpege:58 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:10,590 - INFO - 1-get_arpege:59 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:10,590 - INFO - 1-get_arpege:60 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:10,591 - INFO - 1-get_arpege:61 - Temporary directory for FTP download: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:43:10,591 - INFO - 1-get_arpege:62 - Remote FTP directory: /share/meteofrance/Arpege_Orig
2025-08-21 11:43:10,591 - INFO - 1-get_arpege:65 - Ensured temporary directory exists: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:43:10,591 - INFO - 1-get_arpege:77 - Fetching files for date: 20250821 with pattern: *SP1*20250821000*
2025-08-21 11:43:10,591 - INFO - 1-get_arpege:80 - Checking if files exist on FTP server...
2025-08-21 11:43:10,591 - INFO - fetchdata:68 - Listing files in remote directory: /share/meteofrance/Arpege_Orig on ftp1.meteo.dz (pattern: *SP1*20250821000*)...
2025-08-21 11:43:10,591 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:43:10,839 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:43:10,851 - INFO - fetchdata:81 - Found 6 files matching pattern '*SP1*20250821000*'.
2025-08-21 11:43:10,852 - INFO - 1-get_arpege:108 - Found 6 matching files on FTP server:
2025-08-21 11:43:10,852 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,853 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,853 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,853 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,853 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,853 - INFO - 1-get_arpege:110 -   - W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2
2025-08-21 11:43:10,854 - INFO - 1-get_arpege:123 - Proceeding with FTP download using fetch_remote_files.
2025-08-21 11:43:10,854 - INFO - 1-get_arpege:124 - Attempting to download 6 files to /home/aoumeur/BQRM_V01/BMSLA/tmp.
2025-08-21 11:43:10,854 - INFO - fetchdata:171 - Starting FTP file fetching process for 6 files.
2025-08-21 11:43:10,854 - INFO - fetchdata:17 - Attempting to connect to FTP server ftp1.meteo.dz:21...
2025-08-21 11:43:11,055 - INFO - fetchdata:20 - Successfully connected and logged in to ftp1.meteo.dz.
2025-08-21 11:43:11,057 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,059 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,060 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,062 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,063 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+49H60H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,065 - INFO - fetchdata:220 - Local file W_fr-meteofrance,MODEL,ARPEGE+01+SP1+61H72H_C_LFPW_202508210000--.grib2 already exists and sizes match (FTP size check). Skipping download.
2025-08-21 11:43:11,065 - INFO - fetchdata:257 - FTP client closed.
2025-08-21 11:43:11,065 - INFO - fetchdata:261 - FTP file fetching process completed.
2025-08-21 11:43:11,065 - INFO - 1-get_arpege:135 - FTP transfer process initiated by fetch_remote_files completed.
2025-08-21 11:43:11,066 - INFO - 1-get_arpege:150 - Successfully verified 6 files downloaded to '/home/aoumeur/BQRM_V01/BMSLA/tmp'.
2025-08-21 11:43:11,066 - INFO - 1-get_arpege:153 - Attempting to run next program: 2-conv.py
2025-08-21 11:43:11,066 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/2-conv.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:11,810 - INFO - 2-conv:41 - --- Script '2-conv.py' started ---
2025-08-21 11:43:11,810 - INFO - 2-conv:42 - Using shared log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:43:11,810 - INFO - 2-conv:43 - Current working directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:11,810 - INFO - 2-conv:44 - Script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:11,810 - INFO - 2-conv:45 - Parent directory dynamically set to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:11,810 - INFO - 2-conv:46 - Temporary directory for GRIB files: /home/aoumeur/BQRM_V01/BMSLA/tmp
2025-08-21 11:43:11,810 - INFO - 2-conv:56 - Processing for date: 20250821
2025-08-21 11:43:11,810 - INFO - 2-conv:57 - Starting extraction of temperature from ARPEGE files.
2025-08-21 11:43:11,811 - INFO - 2-conv:66 - Found primary ARPEGE file: /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2. Processing this branch.
2025-08-21 11:43:11,811 - INFO - grib_processor:41 - Starting GRIB parameter extraction and merging for filter: 'shortName=2t'
2025-08-21 11:43:11,811 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2' to 't2m00-12.grib'.
2025-08-21 11:43:11,811 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+00H12H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:12,173 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:43:12,173 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2' to 't2m12-24.grib'.
2025-08-21 11:43:12,173 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+13H24H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:12,528 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:43:12,528 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2' to 't2m24-36.grib'.
2025-08-21 11:43:12,528 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+25H36H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:12,888 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:43:12,888 - INFO - grib_processor:54 - Extracting 'shortName=2t' from 'W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2' to 't2m36-48.grib'.
2025-08-21 11:43:12,888 - INFO - system_utils:36 - Executing command: grib_copy -w shortName=2t /home/aoumeur/BQRM_V01/BMSLA/tmp/W_fr-meteofrance,MODEL,ARPEGE+01+SP1+37H48H_C_LFPW_202508210000--.grib2 /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:13,246 - INFO - system_utils:47 - Command 'grib_copy' completed successfully.
2025-08-21 11:43:13,246 - INFO - grib_processor:69 - Merging 4 extracted GRIB files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:43:13,246 - INFO - file_operations:129 - Starting merge of 4 files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:43:13,321 - INFO - file_operations:141 - Successfully merged files into '/home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib'.
2025-08-21 11:43:13,322 - INFO - grib_processor:72 - Successfully merged all extracted files to: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:43:13,322 - INFO - grib_processor:79 - Deleting temporary extracted GRIB files.
2025-08-21 11:43:13,323 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m00-12.grib
2025-08-21 11:43:13,325 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m12-24.grib
2025-08-21 11:43:13,326 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m24-36.grib
2025-08-21 11:43:13,328 - INFO - file_operations:431 - Successfully deleted file: /home/aoumeur/BQRM_V01/BMSLA/tmp/t2m36-48.grib
2025-08-21 11:43:13,328 - INFO - grib_processor:81 - Temporary GRIB files deleted.
2025-08-21 11:43:13,328 - INFO - grib_processor:85 - GRIB processing completed successfully.
2025-08-21 11:43:13,328 - INFO - 2-conv:91 - ARPEGE GRIB processing completed successfully. Final file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:43:13,328 - INFO - 2-conv:128 - Attempting to run next program: 3-create_forecast_table.py
2025-08-21 11:43:13,329 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/3-create_forecast_table.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:14,156 - INFO - 3-create_forecast_table:52 - --- Script '3-create_forecast_table.py' execution started. ---
2025-08-21 11:43:14,156 - INFO - 3-create_forecast_table:53 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:43:14,156 - INFO - 3-create_forecast_table:54 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:14,156 - INFO - 3-create_forecast_table:55 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:14,157 - INFO - 3-create_forecast_table:56 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:14,157 - INFO - 3-create_forecast_table:61 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:14,157 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:43:14,158 - INFO - 3-create_forecast_table:84 - Attempting to load station data from: /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:43:14,160 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/template/station_onm_officielle.csv
2025-08-21 11:43:14,170 - INFO - 3-create_forecast_table:90 - Successfully loaded 75 stations.
2025-08-21 11:43:14,179 - INFO - 3-create_forecast_table:103 - Attempting to open GRIB file: /home/aoumeur/BQRM_V01/BMSLA/tmp/2t_20250821.grib
2025-08-21 11:43:14,418 - INFO - grib_processor:113 - GRIB file '2t_20250821.grib' opened successfully.
2025-08-21 11:43:14,418 - INFO - 3-create_forecast_table:106 - GRIB file resource successfully opened.
2025-08-21 11:43:14,418 - INFO - 3-create_forecast_table:124 - Starting GRIB data extraction for 2m temperature (0-24h period).
2025-08-21 11:43:14,418 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:43:19,115 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:43:19,115 - INFO - 3-create_forecast_table:138 - Finished extraction of 2m temperature data for 0-24h period.
2025-08-21 11:43:19,116 - INFO - 3-create_forecast_table:146 - Starting GRIB data extraction for 2m temperature (24-48h period).
2025-08-21 11:43:19,116 - INFO - grib_processor:159 - Starting extraction of field '2t' for 75 stations across 25 time steps using old script's explicit loop logic.
2025-08-21 11:43:23,652 - INFO - grib_processor:205 - Finished GRIB data extraction for all specified time steps and stations.
2025-08-21 11:43:23,652 - INFO - 3-create_forecast_table:160 - Finished extraction of 2m temperature data for 24-48h period.
2025-08-21 11:43:23,697 - INFO - 3-create_forecast_table:171 - GRIB file resource closed successfully.
2025-08-21 11:43:23,697 - INFO - 3-create_forecast_table:177 - Calculating min and max temperatures across 0-24h time steps for each station.
2025-08-21 11:43:23,697 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:43:23,698 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:43:23,698 - INFO - 3-create_forecast_table:185 - Min/Max temperatures (0-24h) calculated successfully.
2025-08-21 11:43:23,698 - INFO - 3-create_forecast_table:191 - Calculating max temperature across 24-48h time steps for each station.
2025-08-21 11:43:23,698 - INFO - numpy_utils:26 - Starting calculation of min/max values across time steps for each entity.
2025-08-21 11:43:23,698 - INFO - numpy_utils:49 - Min/Max temperatures calculated successfully.
2025-08-21 11:43:23,699 - INFO - 3-create_forecast_table:197 - Max temperature (24-48h) calculated successfully.
2025-08-21 11:43:23,699 - INFO - 3-create_forecast_table:204 - Creating final DataFrame with specific columns as per Version 1.
2025-08-21 11:43:23,700 - INFO - 3-create_forecast_table:217 - DataFrame created successfully with Version 1 column structure.
2025-08-21 11:43:23,706 - INFO - 3-create_forecast_table:234 - Attempting to save final table to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:43:23,708 - INFO - data_utils:145 - DataFrame successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:43:23,708 - INFO - 3-create_forecast_table:239 - Final table successfully saved to: /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:43:23,708 - INFO - 3-create_forecast_table:246 - Attempting to run next program: 5-traitement_obs_min_max.py
2025-08-21 11:43:23,708 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/5-traitement_obs_min_max.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:61 - --- Script Start ---
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:62 - Project Root: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:63 - Script's Own Directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:24,536 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:86 - Defined 27 stations.
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:91 - Initial stations DataFrame created.
2025-08-21 11:43:24,536 - INFO - 5-traitement_obs_min_max:99 - Expected BUFR file for Tmin (today's 0600Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/21/Synop_202508210600.bufr
2025-08-21 11:43:24,537 - INFO - 5-traitement_obs_min_max:100 - Expected BUFR file for Tmax (yesterday's 1800Z): /home/aoumeur/BQRM_V01/BMSLA/../bufr_data/observations/2025/08/20/Synop_202508201800.bufr
2025-08-21 11:43:24,537 - INFO - 5-traitement_obs_min_max:110 - Proceeding with available BUFR files.
2025-08-21 11:43:24,537 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/21/Synop_202508210600.bufr for key 'minimumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-21 11:43:24,683 - INFO - 5-traitement_obs_min_max:122 - Successfully merged Tmin data. Stations with Tmin: 89
2025-08-21 11:43:24,683 - INFO - grib_processor:235 - Processing BUFR file: /home/aoumeur/BQRM_V01/bufr_data/observations/2025/08/20/Synop_202508201800.bufr for key 'maximumTemperatureAtHeightAndOverPeriodSpecified'
2025-08-21 11:43:24,790 - INFO - 5-traitement_obs_min_max:137 - Successfully merged Tmax data. Stations with Tmax: 89
2025-08-21 11:43:24,790 - INFO - 5-traitement_obs_min_max:144 - Starting DataFrame cleaning and filtering.
2025-08-21 11:43:24,790 - INFO - data_utils:49 - Selecting columns: ['stationOrSiteName', 'tmin', 'tmax']
2025-08-21 11:43:24,793 - INFO - 5-traitement_obs_min_max:160 - Final cleaned DataFrame has 27 rows.
2025-08-21 11:43:24,796 - INFO - 5-traitement_obs_min_max:168 - Output directory ensured: /home/aoumeur/BQRM_V01/BMSLA/outputs/observations
2025-08-21 11:43:24,797 - INFO - 5-traitement_obs_min_max:178 - Data successfully saved to /home/aoumeur/BQRM_V01/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 11:43:24,797 - INFO - 5-traitement_obs_min_max:185 - Attempting to run next program: 6-create_tables.py
2025-08-21 11:43:24,797 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/6-create_tables.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:25,309 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:43:25,309 - INFO - 6-create_tables:75 - Attempting to load data from outputs directory: /home/aoumeur/BQRM_V01/BMSLA/outputs
2025-08-21 11:43:25,312 - INFO - data_utils:71 - Successfully loaded 75 rows from /home/aoumeur/BQRM_V01/BMSLA/outputs/arpege/station_arpege_20250821.csv
2025-08-21 11:43:25,320 - INFO - 6-create_tables:93 - Attempting to load tmin_max data (first instance) from: /home/aoumeur/BQRM_V01/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 11:43:25,322 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/BQRM_V01/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 11:43:25,326 - INFO - 6-create_tables:102 - Processing arpege data: renaming columns and rounding.
2025-08-21 11:43:25,332 - INFO - 6-create_tables:126 - Defined 10 station mappings for observations.
2025-08-21 11:43:25,332 - WARNING - 6-create_tables:132 - Re-attempting to load observations min/max data from: /home/aoumeur/BQRM_V01/BMSLA/outputs/observations/tmin_tmax_20250821.csv. This might be redundant as it was loaded earlier as 'tmin_max'.
2025-08-21 11:43:25,333 - INFO - data_utils:71 - Successfully loaded 27 rows from /home/aoumeur/BQRM_V01/BMSLA/outputs/observations/tmin_tmax_20250821.csv
2025-08-21 11:43:25,337 - INFO - 6-create_tables:140 - Applying station mapping to 'stationOrSiteName' column in observations data.
2025-08-21 11:43:25,342 - INFO - 6-create_tables:153 - Merging arpege and observations data (first merge).
2025-08-21 11:43:25,358 - INFO - 6-create_tables:170 - Defined 27 stations for the final table filtering and ordering.
2025-08-21 11:43:25,358 - WARNING - 6-create_tables:173 - Duplicate merge operation detected. This block is identical to a previous merge and might be redundant.
2025-08-21 11:43:25,373 - INFO - 6-create_tables:184 - Reindexing and filling missing stations based on the predefined list.
2025-08-21 11:43:25,380 - INFO - 6-create_tables:189 - Sorting final table by the specified station list order.
2025-08-21 11:43:25,386 - INFO - 6-create_tables:196 - Attempting to save final table to Excel: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:25,395 - INFO - data_utils:230 - DataFrame successfully saved to Excel file: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx (Sheet: All Stations)
2025-08-21 11:43:25,395 - INFO - 6-create_tables:208 - Excel file successfully created at: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:25,396 - INFO - 6-create_tables:216 - Attempting to run next program: 7-create_word.py
2025-08-21 11:43:25,396 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/7-create_word.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:25,949 - INFO - 7-create_word:51 - --- Script '7-create_word.py' execution started. ---
2025-08-21 11:43:25,949 - INFO - 7-create_word:52 - Logger configured. Logs will be saved to: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:43:25,949 - INFO - 7-create_word:53 - Current script directory: /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:25,949 - INFO - 7-create_word:54 - Determined project root directory: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:25,950 - INFO - 7-create_word:55 - Current working directory (before change): /home/aoumeur/BQRM_V01/BMSLA/scr
2025-08-21 11:43:25,950 - INFO - 7-create_word:59 - Changed current working directory to: /home/aoumeur/BQRM_V01/BMSLA
2025-08-21 11:43:25,950 - INFO - 7-create_word:76 - Processed dates - Today: 21-08-2025, Tomorrow: 22-08-2025, Yesterday: 20-08-2025
2025-08-21 11:43:25,950 - INFO - 7-create_word:87 - Attempting to clean up temporary files in: /home/aoumeur/BQRM_V01/BMSLA/tmp using pytaps.file_operations.clean_directory.
2025-08-21 11:43:25,950 - INFO - file_operations:286 - Starting cleanup of directory: /home/aoumeur/BQRM_V01/BMSLA/tmp (Pattern: All files)
2025-08-21 11:43:25,996 - INFO - file_operations:303 - Finished cleanup. Successfully deleted 7 files from /home/aoumeur/BQRM_V01/BMSLA/tmp.
2025-08-21 11:43:25,996 - INFO - 7-create_word:90 - Temporary files cleanup complete.
2025-08-21 11:43:25,996 - INFO - 7-create_word:143 - Excel file path: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:25,996 - INFO - 7-create_word:144 - Word template path: /home/aoumeur/BQRM_V01/BMSLA/template/Bulletin_sud.docx
2025-08-21 11:43:25,996 - INFO - 7-create_word:145 - Output Word document path: /home/aoumeur/BQRM_V01/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 11:43:25,996 - INFO - data_utils:281 - Attempting to load Excel workbook: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:26,003 - INFO - data_utils:284 - Successfully loaded Excel workbook: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx, active sheet: 'All Stations'
2025-08-21 11:43:26,003 - INFO - 7-create_word:153 - Successfully loaded Excel workbook using pytaps: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:26,016 - INFO - 7-create_word:165 - Successfully loaded data into Pandas DataFrame from: /home/aoumeur/BQRM_V01/BMSLA/outputs/tab_reg/all_stations.xlsx
2025-08-21 11:43:26,025 - INFO - 7-create_word:176 - Successfully loaded Word template: /home/aoumeur/BQRM_V01/BMSLA/template/Bulletin_sud.docx
2025-08-21 11:43:26,026 - INFO - 7-create_word:101 - Attempting to modify paragraph: search_text='Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :', new_text='Tableau de Températures observées pour le 20-08-2025 et prévues pour le 21-08-2025 et 22-08-2025 : '
2025-08-21 11:43:26,028 - INFO - 7-create_word:127 - Paragraph successfully modified: 'Tableau de Températures observées pour le YESTERDAY et prévues pour le TODAY et DEMAIN :' replaced with 'Tableau de Températures observées pour le 20-08-2025 et prévues pour le 21-08-2025 et 22-08-2025 : '
2025-08-21 11:43:26,028 - INFO - 7-create_word:197 - Starting to update the Word document table.
2025-08-21 11:43:26,029 - INFO - 7-create_word:204 - Found table for update (index 1). Table has 29 rows and 6 columns initially.
2025-08-21 11:43:26,029 - INFO - 7-create_word:215 - Table now has 29 rows, sufficient for 27 data entries.
2025-08-21 11:43:26,065 - INFO - 7-create_word:235 - Applying consistent formatting to table cells.
2025-08-21 11:43:26,103 - INFO - 7-create_word:257 - Table update and formatting complete.
2025-08-21 11:43:26,113 - INFO - 7-create_word:274 - Word document successfully saved as: /home/aoumeur/BQRM_V01/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 11:43:26,114 - INFO - 7-create_word:280 - Attempting to run next program: 8-send_MSG.py
2025-08-21 11:43:26,114 - INFO - system_utils:36 - Executing command: /usr/bin/python3 /home/aoumeur/BQRM_V01/BMSLA/scr/8-send_MSG.py --shared-log-file /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log in directory: '/home/aoumeur/BQRM_V01/BMSLA/scr'
2025-08-21 11:43:26,177 - INFO - 8-send_MSG:74 - Logger initialized for 8-send_MSG. Log file: /home/aoumeur/BQRM_V01/BMSLA/scr/logs/BMSLA.log
2025-08-21 11:43:26,177 - INFO - 8-send_MSG:75 - Starting daily antiacridienne bulletin sending script.
2025-08-21 11:43:26,177 - INFO - date_time_utils:56 - Processed dates - Today: 2025-08-21, Yesterday: 2025-08-20
2025-08-21 11:43:26,177 - INFO - 8-send_MSG:95 - File found and added for attachment: /home/aoumeur/BQRM_V01/BMSLA/bulletins/Bulletin_antiacridienne_21-08-2025.docx
2025-08-21 11:43:26,177 - INFO - 8-send_MSG:109 - Attempting to send email with subject: 'Tableau de Températures antiacridienne du 21/08/2025' to aoumeurmohamed2404@gmail.com
2025-08-21 11:43:26,177 - INFO - email_utils:30 - Attempting to send email from 'pnt@meteo.dz' to ['aoumeurmohamed2404@gmail.com'] with subject: 'Tableau de Températures antiacridienne du 21/08/2025'
2025-08-21 11:43:26,369 - INFO - email_utils:71 - Email successfully sent to 'aoumeurmohamed2404@gmail.com'.
2025-08-21 11:43:26,371 - INFO - 8-send_MSG:125 - Email process completed successfully.
2025-08-21 11:43:26,372 - INFO - 8-send_MSG:132 - Attempting to clean up temporary directory: /home/aoumeur/BQRM_V01/BMSLA/../tmp
2025-08-21 11:43:26,372 - WARNING - file_operations:280 - Directory not found: /home/aoumeur/BQRM_V01/tmp. Skipping cleanup.
2025-08-21 11:43:26,372 - INFO - 8-send_MSG:143 - No files found to clean in /home/aoumeur/BQRM_V01/BMSLA/../tmp or all files were already gone.
2025-08-21 11:43:26,372 - INFO - 8-send_MSG:148 - Script execution finished.
2025-08-21 11:43:26,398 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,398 - INFO - 7-create_word:288 - Successfully executed 8-send_MSG.py.
2025-08-21 11:43:26,398 - INFO - 7-create_word:296 - --- Script '7-create_word.py' finished. ---
2025-08-21 11:43:26,491 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,492 - INFO - 6-create_tables:224 - Successfully executed 7-create_word.py.
2025-08-21 11:43:26,492 - INFO - 6-create_tables:233 - --- Script '6-create_tables.py' finished. ---
2025-08-21 11:43:26,567 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,567 - INFO - 5-traitement_obs_min_max:193 - Successfully executed 6-create_tables.py.
2025-08-21 11:43:26,567 - INFO - 5-traitement_obs_min_max:202 - --- Script '5-traitement_obs_min_max.py' finished. ---
2025-08-21 11:43:26,692 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,693 - INFO - 3-create_forecast_table:253 - Successfully executed 5-traitement_obs_min_max.py.
2025-08-21 11:43:26,693 - INFO - 3-create_forecast_table:261 - --- Script '3-create_forecast_table.py' finished. ---
2025-08-21 11:43:26,822 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,822 - INFO - 2-conv:135 - Successfully executed 3-create_forecast_table.py.
2025-08-21 11:43:26,822 - INFO - 2-conv:140 - --- Script '2-conv.py' finished. ---
2025-08-21 11:43:26,930 - INFO - system_utils:47 - Command '/usr/bin/python3' completed successfully.
2025-08-21 11:43:26,930 - INFO - 1-get_arpege:160 - Successfully executed 2-conv.py.
2025-08-21 11:43:26,930 - INFO - 1-get_arpege:169 - --- Script '1-get_arpege.py' finished. ---
